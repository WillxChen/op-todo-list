(()=>{"use strict";const t=(t,e=crypto.randomUUID().slice(0,8))=>{const a=[],s=(t=>{const e=e=>t.findIndex((t=>t.id===e));return{getTaskById:e=>t.find((t=>t.id===e)),createTask:e=>(t.push({id:crypto.randomUUID().slice(0,8),title:e}),t[t.length-1]),updateTask:(a,s)=>{const r=e(a);t[r]={...t[r],...s}},removeTask:a=>{const s=e(a);t.splice(s,1)}}})(a);return{getTitle:()=>t,getId:()=>e,getTasks:()=>a,createTask:t=>s.createTask(t),getTaskById:t=>s.getTaskById(t),updateTask:(t,e)=>s.updateTask(t,e),removeTask:t=>s.removeTask(t)}},{appendCustomElement:e,createCustomElement:a}=(()=>{function t(t){const{tagName:e,classList:a,textContent:s,attributes:r}=t,n=document.createElement(e);if("string"==typeof a?n.classList.add(a):Array.isArray(a)&&n.classList.add(...a),s&&(n.textContent=s),Array.isArray(r)){const[t,e]=r;n.setAttribute(t,e)}return n}return{appendCustomElement:function(e){const{target:a}=e,s=document.querySelector(a),r=t(e);s.appendChild(r)},createCustomElement:t}})(),{handleCreateListInput:s,handleCreateTaskInput:r,editTask:n,toggleDetails:i}=(()=>{function t(){this.style.height="auto",this.style.height=this.scrollHeight+"px"}return{handleCreateListInput:(t,e)=>{if("Enter"===t.key){t.preventDefault();const a=t.target.value,s=e.createList(a);g([s]),t.target.value=""}},handleCreateTaskInput:(t,e,a)=>{if("Enter"===t.key){t.preventDefault();const s=t.target.value,r=a.createTask(s),n=o([r],a);d(e.querySelector(".task-container"),n),t.target.value=""}},editTask:(e,a,s)=>{const r=e.target;if(!r.classList.contains("task-title"))return;const n=r.cloneNode(!0),i=document.createElement("textarea"),c=s.getTaskById(a);i.classList.add("temp-input"),i.value=c.title,i.style.wordBreak="break-word",r.replaceWith(i),i.style.height="auto",i.style.height=i.scrollHeight+"px",i.addEventListener("keydown",(t=>{"Enter"===t.key&&i.blur()})),i.addEventListener("blur",(()=>{s.updateTask(a,{title:i.value}),n.textContent=i.value,i.replaceWith(n)}),{once:!0}),i.addEventListener("input",t,!1),i.focus()},toggleDetails:(t,e)=>{if("IMG"===t.target.tagName||"P"===t.target.tagName||"TEXTAREA"===t.target.tagName)return;const a=t.target.closest(".task"),s=a.querySelector(".expanded-details");a.classList.toggle("expanded"),s?s.remove():l(a,e)}}})(),c=(t,e)=>{const s=((t,e)=>({setEditMode:t=>{t.target.closest(".expanded-details")},setPriority:a=>{t.getTaskById(e.id).priority?(t.updateTask(e.id,{priority:!1}),a.target.closest("img").src="../src/imgs/noun-star-4485746.svg"):(t.updateTask(e.id,{priority:!0}),a.target.closest("img").src="../src/imgs/noun-star-4485827.svg"),a.target.closest(".task").classList.toggle("isPriority"),a.target.closest("img").classList.toggle("filter-gray"),a.target.closest("img").classList.toggle("filter-yellow")},deleteTask:a=>{t.removeTask(e.id),a.target.closest(".task").remove()}}))(t,e),r=[{name:"Edit",imgSrc:"../src/imgs/noun-quill-4626718.svg",className:"filter-gray"},{name:"Set Priority",imgSrc:"../src/imgs/noun-star-4485746.svg",className:"filter-gray",onClick:t=>s.setPriority(t)},{name:"Delete",imgSrc:"../src/imgs/noun-skull-4485674.svg",className:"filter-red",onClick:t=>s.deleteTask(t)}];return{createToolbar:()=>{const t=a({tagName:"div",classList:"toolbar"});return t.append((t=>{const e=document.createDocumentFragment();return t.forEach((t=>{const{name:s,imgSrc:r,className:n,onClick:i}=t,c=a({tagName:"button",attribute:["aria-label",`${s}`]}),o=a({tagName:"img",attributes:["src",`${r}`],classList:n});c.onclick=i,c.append(o),e.append(c)})),e})(r)),t}}},{createTaskElements:o,renderTaskElements:d,renderExpandedTask:l}={createTaskElements:(t,e)=>t.map((t=>{const s=document.createElement("div");s.className="task",s.dataset.id=t.id;const r=a({tagName:"p",classList:"task-title",textContent:t.title});s.append(r);const o=c(e,t);return s.append(o.createToolbar(e,s)),s.addEventListener("dblclick",(a=>{n(a,t.id,e)})),s.addEventListener("click",(e=>{i(e,t)})),s})),renderTaskElements:(t,e)=>{t.prepend(...e)},renderExpandedTask:(t,e)=>{const s=(t=>{const{description:e,dueDate:s,difficulty:r}=t,n=document.createDocumentFragment(),i=document.createElement("div");return i.classList.add("expanded-details"),n.append(i),i.append(a({tagName:"p",classList:"description",textContent:"description"})),i.append(a({tagName:"p",classList:"due-date",textContent:"dueDate"})),i.append(a({tagName:"p",classList:"difficulty",textContent:"difficulty"})),n})(e);return t.append(s),s}},{renderListElements:g}={renderListElements:t=>{t.forEach((t=>{const s=t.getId();(t=>{e({target:".list-container",tagName:"div",classList:["list"],attributes:["data-id",t]})})(s),((t,s)=>{const n=document.querySelector(`[data-id="${s}"]`);e({target:`[data-id="${s}"]`,tagName:"h2",textContent:t.getTitle()}),n.appendChild(((t,e)=>{const s=document.createElement("form");s.className="task-form";const n=a({tagName:"input",classList:"task-input",attributes:["placeholder","Add a task"]});return s.appendChild(n),n.addEventListener("keydown",(a=>{r(a,t,e)})),s})(n,t))})(t,s),(t=>{e({target:`[data-id="${t}"]`,tagName:"div",classList:"task-container"})})(s),((t,e)=>{const a=document.querySelector(`[data-id="${e}"]`).querySelector(".task-container"),s=o(t.getTasks(),t);d(a,s)})(t,s)}))}},{checkForLists:u}={checkForLists:t=>{const e=t.getLists();e.length?g(e):((t=>{t.createList("Habits").createTask("Create your first habit!")})(t),g(t.getLists()))}},m=((e=crypto.randomUUID().slice(0,8))=>{const a=[];return{getId:()=>e,getLists:()=>a,createList:e=>(a.push(t(e)),a[a.length-1]),findList:t=>{const e=a.findIndex((e=>e.id===t));return a[e]}}})();sessionStorage.setItem("currentProject",JSON.stringify(m)),console.log(JSON.parse(sessionStorage.currentProject)),(()=>{const t=document.querySelector("#list-input");return{init:()=>{u(m),t.addEventListener("keydown",(t=>{s(t,m)}))}}})().init()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LFNBQVNVLGNBQWMsZUFVckMsTUFBTyxDQUFFcUcsS0FSSSxLQUNYYixFQUFjM0UsR0FFZGdCLEVBQU1JLGlCQUFpQixXQUFZckIsSUFDakNULEVBQXNCUyxFQUFHQyxFQUFlLEdBQ3hDLEVBSUwsRUFacUIsR0VIbkJ3RixNIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb3AtdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvVGFza01hbmFnZXIuanMiLCJ3ZWJwYWNrOi8vb3AtdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvTGlzdC5qcyIsIndlYnBhY2s6Ly9vcC10b2RvLWxpc3QvLi9zcmMvbW9kdWxlcy9jdXN0b21FbGVtZW50SGVscGVyLmpzIiwid2VicGFjazovL29wLXRvZG8tbGlzdC8uL3NyYy9tb2R1bGVzL0V2ZW50SGFuZGxlci5qcyIsIndlYnBhY2s6Ly9vcC10b2RvLWxpc3QvLi9zcmMvbW9kdWxlcy9Ub29sYmFyLmpzIiwid2VicGFjazovL29wLXRvZG8tbGlzdC8uL3NyYy9tb2R1bGVzL1Rvb2xiYXJFdmVudEhhbmRsZXIuanMiLCJ3ZWJwYWNrOi8vb3AtdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvVGFza1JlbmRlcmVyLmpzIiwid2VicGFjazovL29wLXRvZG8tbGlzdC8uL3NyYy9tb2R1bGVzL0xpc3RSZW5kZXJlci5qcyIsIndlYnBhY2s6Ly9vcC10b2RvLWxpc3QvLi9zcmMvbW9kdWxlcy9MaXN0SGFuZGxlci5qcyIsIndlYnBhY2s6Ly9vcC10b2RvLWxpc3QvLi9zcmMvbW9kdWxlcy9Vc2VySW50ZXJmYWNlLmpzIiwid2VicGFjazovL29wLXRvZG8tbGlzdC8uL3NyYy9tb2R1bGVzL1Byb2plY3QuanMiLCJ3ZWJwYWNrOi8vb3AtdG9kby1saXN0Ly4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFRhc2tNYW5hZ2VyID0gKHRhc2tMaXN0KSA9PiB7XHJcbiAgY29uc3QgZ2V0VGFza0J5SWQgPSAodGFza0lkKSA9PiB7XHJcbiAgICByZXR1cm4gdGFza0xpc3QuZmluZCgodGFzaykgPT4gdGFzay5pZCA9PT0gdGFza0lkKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBnZXRUYXNrQnlJbmRleCA9ICh0YXNrSWQpID0+IHtcclxuICAgIHJldHVybiB0YXNrTGlzdC5maW5kSW5kZXgoKHRhc2spID0+IHRhc2suaWQgPT09IHRhc2tJZCk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgY3JlYXRlVGFzayA9ICh0aXRsZSkgPT4ge1xyXG4gICAgdGFza0xpc3QucHVzaCh7XHJcbiAgICAgIGlkOiBjcnlwdG8ucmFuZG9tVVVJRCgpLnNsaWNlKDAsIDgpLFxyXG4gICAgICB0aXRsZSxcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRhc2tMaXN0W3Rhc2tMaXN0Lmxlbmd0aCAtIDFdO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IHVwZGF0ZVRhc2sgPSAodGFza0lkLCB1cGRhdGVkRW50cnkpID0+IHtcclxuICAgIGNvbnN0IHRhc2tJbmRleCA9IGdldFRhc2tCeUluZGV4KHRhc2tJZCk7XHJcbiAgICB0YXNrTGlzdFt0YXNrSW5kZXhdID0geyAuLi50YXNrTGlzdFt0YXNrSW5kZXhdLCAuLi51cGRhdGVkRW50cnkgfTtcclxuICB9O1xyXG5cclxuICBjb25zdCByZW1vdmVUYXNrID0gKHRhc2tJZCkgPT4ge1xyXG4gICAgY29uc3QgdGFza0luZGV4ID0gZ2V0VGFza0J5SW5kZXgodGFza0lkKTtcclxuICAgIHRhc2tMaXN0LnNwbGljZSh0YXNrSW5kZXgsIDEpO1xyXG4gIH07XHJcblxyXG4gIHJldHVybiB7IGdldFRhc2tCeUlkLCBjcmVhdGVUYXNrLCB1cGRhdGVUYXNrLCByZW1vdmVUYXNrIH07XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBUYXNrTWFuYWdlcjtcclxuIiwiaW1wb3J0IFRhc2tNYW5hZ2VyIGZyb20gXCIuL1Rhc2tNYW5hZ2VyXCI7XHJcblxyXG5jb25zdCBMaXN0ID0gKHRpdGxlLCBpZCA9IGNyeXB0by5yYW5kb21VVUlEKCkuc2xpY2UoMCwgOCkpID0+IHtcclxuICBjb25zdCB0YXNrcyA9IFtdO1xyXG4gIGNvbnN0IHRhc2tNYW5hZ2VyID0gVGFza01hbmFnZXIodGFza3MpO1xyXG5cclxuICBjb25zdCBnZXRUaXRsZSA9ICgpID0+IHRpdGxlO1xyXG4gIGNvbnN0IGdldElkID0gKCkgPT4gaWQ7XHJcbiAgY29uc3QgZ2V0VGFza3MgPSAoKSA9PiB0YXNrcztcclxuXHJcbiAgY29uc3QgY3JlYXRlVGFzayA9ICh0aXRsZSkgPT4ge1xyXG4gICAgcmV0dXJuIHRhc2tNYW5hZ2VyLmNyZWF0ZVRhc2sodGl0bGUpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGdldFRhc2tCeUlkID0gKHRhc2tJZCkgPT4ge1xyXG4gICAgcmV0dXJuIHRhc2tNYW5hZ2VyLmdldFRhc2tCeUlkKHRhc2tJZCk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgdXBkYXRlVGFzayA9ICh0YXNrSWQsIHVwZGF0ZWRFbnRyeSkgPT4ge1xyXG4gICAgcmV0dXJuIHRhc2tNYW5hZ2VyLnVwZGF0ZVRhc2sodGFza0lkLCB1cGRhdGVkRW50cnkpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IHJlbW92ZVRhc2sgPSAodGFza0lkKSA9PiB7XHJcbiAgICByZXR1cm4gdGFza01hbmFnZXIucmVtb3ZlVGFzayh0YXNrSWQpO1xyXG4gIH07XHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBnZXRUaXRsZSxcclxuICAgIGdldElkLFxyXG4gICAgZ2V0VGFza3MsXHJcbiAgICBjcmVhdGVUYXNrLFxyXG4gICAgZ2V0VGFza0J5SWQsXHJcbiAgICB1cGRhdGVUYXNrLFxyXG4gICAgcmVtb3ZlVGFzayxcclxuICB9O1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgTGlzdDtcclxuIiwiY29uc3QgY3VzdG9tRWxlbWVudEhlbHBlciA9ICgpID0+IHtcclxuICAvLyBQYXNzIGluIGEgb2JqZWN0IG9mIHsgW3RhcmdldF0uLCB0YWdOYW1lLCBjbGFzc0xpc3QsIHRleHRDb250ZW50LCBhdHRyaWJ1dGVzIH1cclxuICBmdW5jdGlvbiBhcHBlbmRDdXN0b21FbGVtZW50KG9wdGlvbnMpIHtcclxuICAgIGNvbnN0IHsgdGFyZ2V0IH0gPSBvcHRpb25zO1xyXG4gICAgY29uc3QgdGFyZ2V0RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGFyZ2V0KTtcclxuXHJcbiAgICBjb25zdCBlbGVtZW50ID0gY3JlYXRlQ3VzdG9tRWxlbWVudChvcHRpb25zKTtcclxuICAgIHRhcmdldEVsZW1lbnQuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBjcmVhdGVDdXN0b21FbGVtZW50KG9wdGlvbnMpIHtcclxuICAgIGNvbnN0IHsgdGFnTmFtZSwgY2xhc3NMaXN0LCB0ZXh0Q29udGVudCwgYXR0cmlidXRlcyB9ID0gb3B0aW9ucztcclxuICAgIGNvbnN0IGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRhZ05hbWUpO1xyXG5cclxuICAgIGlmICh0eXBlb2YgY2xhc3NMaXN0ID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZChjbGFzc0xpc3QpO1xyXG4gICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGNsYXNzTGlzdCkpIHtcclxuICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKC4uLmNsYXNzTGlzdCk7XHJcbiAgICB9XHJcbiAgICBpZiAodGV4dENvbnRlbnQpIHtcclxuICAgICAgZWxlbWVudC50ZXh0Q29udGVudCA9IHRleHRDb250ZW50O1xyXG4gICAgfVxyXG4gICAgaWYgKEFycmF5LmlzQXJyYXkoYXR0cmlidXRlcykpIHtcclxuICAgICAgY29uc3QgW2F0dHIsIHZhbHVlXSA9IGF0dHJpYnV0ZXM7XHJcbiAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKGF0dHIsIHZhbHVlKTtcclxuICAgIH1cclxuICAgIHJldHVybiBlbGVtZW50O1xyXG4gIH1cclxuICByZXR1cm4geyBhcHBlbmRDdXN0b21FbGVtZW50LCBjcmVhdGVDdXN0b21FbGVtZW50IH07XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgeyBhcHBlbmRDdXN0b21FbGVtZW50LCBjcmVhdGVDdXN0b21FbGVtZW50IH0gPVxyXG4gIGN1c3RvbUVsZW1lbnRIZWxwZXIoKTtcclxuIiwiaW1wb3J0IExpc3QgZnJvbSBcIi4vTGlzdC5qc1wiO1xyXG5pbXBvcnQgeyByZW5kZXJMaXN0RWxlbWVudHMgfSBmcm9tIFwiLi9MaXN0UmVuZGVyZXIuanNcIjtcclxuaW1wb3J0IHtcclxuICBjcmVhdGVUYXNrRWxlbWVudHMsXHJcbiAgcmVuZGVyVGFza0VsZW1lbnRzLFxyXG4gIHJlbmRlckV4cGFuZGVkVGFzayxcclxufSBmcm9tIFwiLi9UYXNrUmVuZGVyZXIuanNcIjtcclxuXHJcbmNvbnN0IEV2ZW50SGFuZGxlciA9ICgpID0+IHtcclxuICBjb25zdCBoYW5kbGVDcmVhdGVMaXN0SW5wdXQgPSAoZSwgY3VycmVudFByb2plY3QpID0+IHtcclxuICAgIGlmIChlLmtleSA9PT0gXCJFbnRlclwiKSB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgY29uc3QgdGl0bGUgPSBlLnRhcmdldC52YWx1ZTtcclxuXHJcbiAgICAgIGNvbnN0IG5ld0xpc3QgPSBjdXJyZW50UHJvamVjdC5jcmVhdGVMaXN0KHRpdGxlKTtcclxuICAgICAgcmVuZGVyTGlzdEVsZW1lbnRzKFtuZXdMaXN0XSk7XHJcblxyXG4gICAgICBlLnRhcmdldC52YWx1ZSA9IFwiXCI7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgaGFuZGxlQ3JlYXRlVGFza0lucHV0ID0gKGUsIHRhcmdldCwgbGlzdCkgPT4ge1xyXG4gICAgaWYgKGUua2V5ID09PSBcIkVudGVyXCIpIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBjb25zdCB0aXRsZSA9IGUudGFyZ2V0LnZhbHVlO1xyXG4gICAgICAvLyBDcmVhdGUgYSBuZXcgdGFzayBlbnRyeSBpbiBsaXN0IGFycmF5XHJcbiAgICAgIGNvbnN0IG5ld1Rhc2sgPSBsaXN0LmNyZWF0ZVRhc2sodGl0bGUpO1xyXG4gICAgICAvLyBDcmVhdGUgYW5kIHJlbmRlciB0YXNrIGVsZW1lbnRzXHJcbiAgICAgIGNvbnN0IHRhc2tFbGVtZW50ID0gY3JlYXRlVGFza0VsZW1lbnRzKFtuZXdUYXNrXSwgbGlzdCk7XHJcbiAgICAgIHJlbmRlclRhc2tFbGVtZW50cyh0YXJnZXQucXVlcnlTZWxlY3RvcihcIi50YXNrLWNvbnRhaW5lclwiKSwgdGFza0VsZW1lbnQpO1xyXG5cclxuICAgICAgZS50YXJnZXQudmFsdWUgPSBcIlwiO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIC8vIFJlZmFjdG9yIHRoaXMgbWVzcyBsYXRlclxyXG4gIGZ1bmN0aW9uIGF1dG9SZXNpemUoKSB7XHJcbiAgICB0aGlzLnN0eWxlLmhlaWdodCA9IFwiYXV0b1wiO1xyXG4gICAgdGhpcy5zdHlsZS5oZWlnaHQgPSB0aGlzLnNjcm9sbEhlaWdodCArIFwicHhcIjtcclxuICB9XHJcblxyXG4gIGNvbnN0IGVkaXRUYXNrID0gKGUsIHRhc2tJZCwgY3VycmVudExpc3QpID0+IHtcclxuICAgIGNvbnN0IGVsID0gZS50YXJnZXQ7XHJcbiAgICBpZiAoIWVsLmNsYXNzTGlzdC5jb250YWlucyhcInRhc2stdGl0bGVcIikpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgcHJldmlvdXMgPSBlbC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0ZXh0YXJlYVwiKTtcclxuICAgIGNvbnN0IGN1cnJlbnRUYXNrID0gY3VycmVudExpc3QuZ2V0VGFza0J5SWQodGFza0lkKTtcclxuXHJcbiAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKFwidGVtcC1pbnB1dFwiKTtcclxuICAgIGlucHV0LnZhbHVlID0gY3VycmVudFRhc2sudGl0bGU7XHJcbiAgICAvLyBpbnB1dC5zdHlsZS53cmFwID0gXCJzb2Z0XCI7XHJcbiAgICBpbnB1dC5zdHlsZS53b3JkQnJlYWsgPSBcImJyZWFrLXdvcmRcIjtcclxuXHJcbiAgICBlbC5yZXBsYWNlV2l0aChpbnB1dCk7XHJcbiAgICBpbnB1dC5zdHlsZS5oZWlnaHQgPSBcImF1dG9cIjtcclxuICAgIGlucHV0LnN0eWxlLmhlaWdodCA9IGlucHV0LnNjcm9sbEhlaWdodCArIFwicHhcIjtcclxuXHJcbiAgICBjb25zdCBzYXZlID0gKCkgPT4ge1xyXG4gICAgICAvLyBTYXZlIHRoZSBpbnB1dCB2YWx1ZSBpbnRvIHRoZSBzZWxlY3RlZCB0YXNrXHJcbiAgICAgIGN1cnJlbnRMaXN0LnVwZGF0ZVRhc2sodGFza0lkLCB7IHRpdGxlOiBpbnB1dC52YWx1ZSB9KTtcclxuICAgICAgcHJldmlvdXMudGV4dENvbnRlbnQgPSBpbnB1dC52YWx1ZTtcclxuICAgICAgaW5wdXQucmVwbGFjZVdpdGgocHJldmlvdXMpO1xyXG4gICAgfTtcclxuXHJcbiAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZSkgPT4ge1xyXG4gICAgICBpZiAoZS5rZXkgPT09IFwiRW50ZXJcIikge1xyXG4gICAgICAgIGlucHV0LmJsdXIoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImJsdXJcIiwgc2F2ZSwge1xyXG4gICAgICBvbmNlOiB0cnVlLFxyXG4gICAgfSk7XHJcblxyXG4gICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGF1dG9SZXNpemUsIGZhbHNlKTtcclxuICAgIGlucHV0LmZvY3VzKCk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgdG9nZ2xlRGV0YWlscyA9IChlLCB0YXNrKSA9PiB7XHJcbiAgICBpZiAoXHJcbiAgICAgIGUudGFyZ2V0LnRhZ05hbWUgPT09IFwiSU1HXCIgfHxcclxuICAgICAgZS50YXJnZXQudGFnTmFtZSA9PT0gXCJQXCIgfHxcclxuICAgICAgZS50YXJnZXQudGFnTmFtZSA9PT0gXCJURVhUQVJFQVwiXHJcbiAgICApIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgdGFza0NvbnRhaW5lciA9IGUudGFyZ2V0LmNsb3Nlc3QoXCIudGFza1wiKTtcclxuICAgIGNvbnN0IGV4cGFuZGVkRGV0YWlscyA9IHRhc2tDb250YWluZXIucXVlcnlTZWxlY3RvcihcIi5leHBhbmRlZC1kZXRhaWxzXCIpO1xyXG4gICAgdGFza0NvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiZXhwYW5kZWRcIik7XHJcbiAgICBpZiAoIWV4cGFuZGVkRGV0YWlscykge1xyXG4gICAgICByZW5kZXJFeHBhbmRlZFRhc2sodGFza0NvbnRhaW5lciwgdGFzayk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBleHBhbmRlZERldGFpbHMucmVtb3ZlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIGhhbmRsZUNyZWF0ZUxpc3RJbnB1dCxcclxuICAgIGhhbmRsZUNyZWF0ZVRhc2tJbnB1dCxcclxuICAgIGVkaXRUYXNrLFxyXG4gICAgdG9nZ2xlRGV0YWlscyxcclxuICB9O1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHtcclxuICBoYW5kbGVDcmVhdGVMaXN0SW5wdXQsXHJcbiAgaGFuZGxlQ3JlYXRlVGFza0lucHV0LFxyXG4gIGVkaXRUYXNrLFxyXG4gIHRvZ2dsZURldGFpbHMsXHJcbn0gPSBFdmVudEhhbmRsZXIoKTtcclxuIiwiaW1wb3J0IHsgY3JlYXRlQ3VzdG9tRWxlbWVudCB9IGZyb20gXCIuL2N1c3RvbUVsZW1lbnRIZWxwZXIuanNcIjtcclxuaW1wb3J0IFRvb2xiYXJFdmVudEhhbmRsZXIgZnJvbSBcIi4vVG9vbGJhckV2ZW50SGFuZGxlci5qc1wiO1xyXG5cclxuLy8gQ3JlYXRlIHRvb2xiYXIgd2lsbCByZXR1cm4gYSBmcmFnbWVudCBjb250YWluZXIgb2YgdGhyZWUgYnV0dG9uc1xyXG4vL1xyXG5cclxuY29uc3QgVG9vbGJhciA9IChjdXJyZW50TGlzdCwgdGFzaykgPT4ge1xyXG4gIGNvbnN0IGV2ZW50SGFuZGxlciA9IFRvb2xiYXJFdmVudEhhbmRsZXIoY3VycmVudExpc3QsIHRhc2spO1xyXG5cclxuICBjb25zdCB0b29scyA9IFtcclxuICAgIHtcclxuICAgICAgbmFtZTogXCJFZGl0XCIsXHJcbiAgICAgIGltZ1NyYzogXCIuLi9zcmMvaW1ncy9ub3VuLXF1aWxsLTQ2MjY3MTguc3ZnXCIsXHJcbiAgICAgIGNsYXNzTmFtZTogXCJmaWx0ZXItZ3JheVwiLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgbmFtZTogXCJTZXQgUHJpb3JpdHlcIixcclxuICAgICAgaW1nU3JjOiBcIi4uL3NyYy9pbWdzL25vdW4tc3Rhci00NDg1NzQ2LnN2Z1wiLFxyXG4gICAgICBjbGFzc05hbWU6IFwiZmlsdGVyLWdyYXlcIixcclxuICAgICAgb25DbGljazogKGUpID0+IGV2ZW50SGFuZGxlci5zZXRQcmlvcml0eShlKSxcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIG5hbWU6IFwiRGVsZXRlXCIsXHJcbiAgICAgIGltZ1NyYzogXCIuLi9zcmMvaW1ncy9ub3VuLXNrdWxsLTQ0ODU2NzQuc3ZnXCIsXHJcbiAgICAgIGNsYXNzTmFtZTogXCJmaWx0ZXItcmVkXCIsXHJcbiAgICAgIG9uQ2xpY2s6IChlKSA9PiBldmVudEhhbmRsZXIuZGVsZXRlVGFzayhlKSxcclxuICAgIH0sXHJcbiAgXTtcclxuXHJcbiAgY29uc3QgY3JlYXRlVG9vbGJhciA9ICgpID0+IHtcclxuICAgIGNvbnN0IHRvb2xiYXJDb250YWluZXIgPSBjcmVhdGVDdXN0b21FbGVtZW50KHtcclxuICAgICAgdGFnTmFtZTogXCJkaXZcIixcclxuICAgICAgY2xhc3NMaXN0OiBcInRvb2xiYXJcIixcclxuICAgIH0pO1xyXG4gICAgdG9vbGJhckNvbnRhaW5lci5hcHBlbmQoX19jcmVhdGVCdG5zKHRvb2xzKSk7XHJcbiAgICByZXR1cm4gdG9vbGJhckNvbnRhaW5lcjtcclxuICB9O1xyXG4gIGNvbnN0IF9fY3JlYXRlQnRucyA9ICh0b29scykgPT4ge1xyXG4gICAgY29uc3QgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XHJcbiAgICB0b29scy5mb3JFYWNoKCh0b29sKSA9PiB7XHJcbiAgICAgIGNvbnN0IHsgbmFtZSwgaW1nU3JjLCBjbGFzc05hbWUsIG9uQ2xpY2sgfSA9IHRvb2w7XHJcbiAgICAgIC8vIFRvb2xiYXIgd2lsbCBjb25zaXN0IG9mOlxyXG4gICAgICAvLyBFZGl0XHJcbiAgICAgIC8vIFNldCBQcmlvcml0eSAtIGlzUHJpb3JpdHlcclxuICAgICAgLy8gRGVsZXRlXHJcbiAgICAgIGNvbnN0IGJ0biA9IGNyZWF0ZUN1c3RvbUVsZW1lbnQoe1xyXG4gICAgICAgIHRhZ05hbWU6IFwiYnV0dG9uXCIsXHJcbiAgICAgICAgYXR0cmlidXRlOiBbXCJhcmlhLWxhYmVsXCIsIGAke25hbWV9YF0sXHJcbiAgICAgIH0pO1xyXG4gICAgICBjb25zdCBpbWcgPSBjcmVhdGVDdXN0b21FbGVtZW50KHtcclxuICAgICAgICB0YWdOYW1lOiBcImltZ1wiLFxyXG4gICAgICAgIGF0dHJpYnV0ZXM6IFtcInNyY1wiLCBgJHtpbWdTcmN9YF0sXHJcbiAgICAgICAgY2xhc3NMaXN0OiBjbGFzc05hbWUsXHJcbiAgICAgIH0pO1xyXG4gICAgICBidG4ub25jbGljayA9IG9uQ2xpY2s7XHJcbiAgICAgIGJ0bi5hcHBlbmQoaW1nKTtcclxuICAgICAgZnJhZ21lbnQuYXBwZW5kKGJ0bik7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBmcmFnbWVudDtcclxuICB9O1xyXG5cclxuICByZXR1cm4geyBjcmVhdGVUb29sYmFyIH07XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBUb29sYmFyO1xyXG4iLCJjb25zdCBUb29sYmFyRXZlbnRIYW5kbGVyID0gKGN1cnJlbnRMaXN0LCB0YXNrKSA9PiB7XHJcbiAgY29uc3Qgc2V0RWRpdE1vZGUgPSAoZSkgPT4ge1xyXG4gICAgZS50YXJnZXQuY2xvc2VzdChcIi5leHBhbmRlZC1kZXRhaWxzXCIpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IHNldFByaW9yaXR5ID0gKGUpID0+IHtcclxuICAgIGNvbnN0IGN1cnJlbnRUYXNrID0gY3VycmVudExpc3QuZ2V0VGFza0J5SWQodGFzay5pZCk7XHJcbiAgICBpZiAoY3VycmVudFRhc2sucHJpb3JpdHkpIHtcclxuICAgICAgY3VycmVudExpc3QudXBkYXRlVGFzayh0YXNrLmlkLCB7IHByaW9yaXR5OiBmYWxzZSB9KTtcclxuICAgICAgZS50YXJnZXQuY2xvc2VzdChcImltZ1wiKS5zcmMgPSBcIi4uL3NyYy9pbWdzL25vdW4tc3Rhci00NDg1NzQ2LnN2Z1wiO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY3VycmVudExpc3QudXBkYXRlVGFzayh0YXNrLmlkLCB7IHByaW9yaXR5OiB0cnVlIH0pO1xyXG4gICAgICBlLnRhcmdldC5jbG9zZXN0KFwiaW1nXCIpLnNyYyA9IFwiLi4vc3JjL2ltZ3Mvbm91bi1zdGFyLTQ0ODU4Mjcuc3ZnXCI7XHJcbiAgICB9XHJcbiAgICBlLnRhcmdldC5jbG9zZXN0KFwiLnRhc2tcIikuY2xhc3NMaXN0LnRvZ2dsZShcImlzUHJpb3JpdHlcIik7XHJcbiAgICBlLnRhcmdldC5jbG9zZXN0KFwiaW1nXCIpLmNsYXNzTGlzdC50b2dnbGUoXCJmaWx0ZXItZ3JheVwiKTtcclxuICAgIGUudGFyZ2V0LmNsb3Nlc3QoXCJpbWdcIikuY2xhc3NMaXN0LnRvZ2dsZShcImZpbHRlci15ZWxsb3dcIik7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgZGVsZXRlVGFzayA9IChlKSA9PiB7XHJcbiAgICBjdXJyZW50TGlzdC5yZW1vdmVUYXNrKHRhc2suaWQpO1xyXG4gICAgZS50YXJnZXQuY2xvc2VzdChcIi50YXNrXCIpLnJlbW92ZSgpO1xyXG4gIH07XHJcblxyXG4gIHJldHVybiB7IHNldEVkaXRNb2RlLCBzZXRQcmlvcml0eSwgZGVsZXRlVGFzayB9O1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgVG9vbGJhckV2ZW50SGFuZGxlcjtcclxuIiwiaW1wb3J0IHsgZWRpdFRhc2ssIHRvZ2dsZURldGFpbHMgfSBmcm9tIFwiLi9FdmVudEhhbmRsZXIuanNcIjtcclxuaW1wb3J0IHtcclxuICBjcmVhdGVDdXN0b21FbGVtZW50LFxyXG4gIGFwcGVuZEN1c3RvbUVsZW1lbnQsXHJcbn0gZnJvbSBcIi4vY3VzdG9tRWxlbWVudEhlbHBlci5qc1wiO1xyXG5pbXBvcnQgVG9vbGJhciBmcm9tIFwiLi9Ub29sYmFyLmpzXCI7XHJcblxyXG5jb25zdCBUYXNrUmVuZGVyZXIgPSAoKSA9PiB7XHJcbiAgY29uc3QgcmVuZGVyVGFza0VsZW1lbnRzID0gKHRhcmdldCwgdGFza3MpID0+IHtcclxuICAgIHRhcmdldC5wcmVwZW5kKC4uLnRhc2tzKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBjcmVhdGVUYXNrRWxlbWVudHMgPSAodGFza3MsIGN1cnJlbnRMaXN0KSA9PiB7XHJcbiAgICByZXR1cm4gdGFza3MubWFwKCh0YXNrKSA9PiB7XHJcbiAgICAgIC8vIERpdiBjb250YWluZXJcclxuICAgICAgY29uc3QgdGFza0NvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgICAgIHRhc2tDb250YWluZXIuY2xhc3NOYW1lID0gXCJ0YXNrXCI7XHJcbiAgICAgIHRhc2tDb250YWluZXIuZGF0YXNldC5pZCA9IHRhc2suaWQ7XHJcblxyXG4gICAgICAvLyBQYXJhZ3JhcGggZWxlbWVudFxyXG4gICAgICBjb25zdCB0aXRsZSA9IGNyZWF0ZUN1c3RvbUVsZW1lbnQoe1xyXG4gICAgICAgIHRhZ05hbWU6IFwicFwiLFxyXG4gICAgICAgIGNsYXNzTGlzdDogXCJ0YXNrLXRpdGxlXCIsXHJcbiAgICAgICAgdGV4dENvbnRlbnQ6IHRhc2sudGl0bGUsXHJcbiAgICAgIH0pO1xyXG4gICAgICB0YXNrQ29udGFpbmVyLmFwcGVuZCh0aXRsZSk7XHJcblxyXG4gICAgICBjb25zdCB0b29sYmFyID0gVG9vbGJhcihjdXJyZW50TGlzdCwgdGFzayk7XHJcbiAgICAgIHRhc2tDb250YWluZXIuYXBwZW5kKHRvb2xiYXIuY3JlYXRlVG9vbGJhcihjdXJyZW50TGlzdCwgdGFza0NvbnRhaW5lcikpO1xyXG5cclxuICAgICAgLy8gQWRkIG9uY2xpY2sgdG8gY2hhbmdlIGVsZW1lbnQgdG8gaW5wdXQgb24gY2xpY2tcclxuICAgICAgdGFza0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwiZGJsY2xpY2tcIiwgKGUpID0+IHtcclxuICAgICAgICBlZGl0VGFzayhlLCB0YXNrLmlkLCBjdXJyZW50TGlzdCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgdGFza0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgICAgICB0b2dnbGVEZXRhaWxzKGUsIHRhc2spO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJldHVybiB0YXNrQ29udGFpbmVyO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgcmVuZGVyRXhwYW5kZWRUYXNrID0gKHRhcmdldCwgdGFzaykgPT4ge1xyXG4gICAgY29uc3QgZXhwYW5kZWRUYXNrID0gX19jcmVhdGVFeHBhbmRlZFRhc2sodGFzayk7XHJcbiAgICB0YXJnZXQuYXBwZW5kKGV4cGFuZGVkVGFzayk7XHJcbiAgICByZXR1cm4gZXhwYW5kZWRUYXNrO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IF9fY3JlYXRlRXhwYW5kZWRUYXNrID0gKHRhc2spID0+IHtcclxuICAgIGNvbnN0IHsgZGVzY3JpcHRpb24sIGR1ZURhdGUsIGRpZmZpY3VsdHkgfSA9IHRhc2s7XHJcblxyXG4gICAgY29uc3QgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XHJcbiAgICAvLyBBcHBlbmQgY2hpbGRyZW4gdG8gZnJhZ21lbnRcclxuICAgIGNvbnN0IGV4cGFuZGVkRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgIC8vIFNldCB0b2dnbGUgYXR0cmlidXRlIHRvIHdvcmsgd2l0aCB0b2dnbGUgZXZlbnQgbGlzdGVuZXJcclxuICAgIGV4cGFuZGVkRGl2LmNsYXNzTGlzdC5hZGQoXCJleHBhbmRlZC1kZXRhaWxzXCIpO1xyXG4gICAgZnJhZ21lbnQuYXBwZW5kKGV4cGFuZGVkRGl2KTtcclxuXHJcbiAgICAvLyBkZXNjcmlwdGlvbiAmJlxyXG4gICAgZXhwYW5kZWREaXYuYXBwZW5kKFxyXG4gICAgICBjcmVhdGVDdXN0b21FbGVtZW50KHtcclxuICAgICAgICB0YWdOYW1lOiBcInBcIixcclxuICAgICAgICBjbGFzc0xpc3Q6IFwiZGVzY3JpcHRpb25cIixcclxuICAgICAgICB0ZXh0Q29udGVudDogXCJkZXNjcmlwdGlvblwiLFxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBkdWVEYXRlICYmXHJcbiAgICBleHBhbmRlZERpdi5hcHBlbmQoXHJcbiAgICAgIGNyZWF0ZUN1c3RvbUVsZW1lbnQoe1xyXG4gICAgICAgIHRhZ05hbWU6IFwicFwiLFxyXG4gICAgICAgIGNsYXNzTGlzdDogXCJkdWUtZGF0ZVwiLFxyXG4gICAgICAgIHRleHRDb250ZW50OiBcImR1ZURhdGVcIixcclxuICAgICAgfSlcclxuICAgICk7XHJcblxyXG4gICAgLy8gZGlmZmljdWx0eSAmJlxyXG4gICAgZXhwYW5kZWREaXYuYXBwZW5kKFxyXG4gICAgICBjcmVhdGVDdXN0b21FbGVtZW50KHtcclxuICAgICAgICB0YWdOYW1lOiBcInBcIixcclxuICAgICAgICBjbGFzc0xpc3Q6IFwiZGlmZmljdWx0eVwiLFxyXG4gICAgICAgIHRleHRDb250ZW50OiBcImRpZmZpY3VsdHlcIixcclxuICAgICAgfSlcclxuICAgICk7XHJcblxyXG4gICAgcmV0dXJuIGZyYWdtZW50O1xyXG4gIH07XHJcblxyXG4gIHJldHVybiB7IGNyZWF0ZVRhc2tFbGVtZW50cywgcmVuZGVyVGFza0VsZW1lbnRzLCByZW5kZXJFeHBhbmRlZFRhc2sgfTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCB7IGNyZWF0ZVRhc2tFbGVtZW50cywgcmVuZGVyVGFza0VsZW1lbnRzLCByZW5kZXJFeHBhbmRlZFRhc2sgfSA9XHJcbiAgVGFza1JlbmRlcmVyKCk7XHJcbiIsImltcG9ydCB7XHJcbiAgYXBwZW5kQ3VzdG9tRWxlbWVudCxcclxuICBjcmVhdGVDdXN0b21FbGVtZW50LFxyXG59IGZyb20gXCIuL2N1c3RvbUVsZW1lbnRIZWxwZXIuanNcIjtcclxuaW1wb3J0IHsgY3JlYXRlVGFza0VsZW1lbnRzLCByZW5kZXJUYXNrRWxlbWVudHMgfSBmcm9tIFwiLi9UYXNrUmVuZGVyZXIuanNcIjtcclxuaW1wb3J0IHsgaGFuZGxlQ3JlYXRlVGFza0lucHV0IH0gZnJvbSBcIi4vRXZlbnRIYW5kbGVyLmpzXCI7XHJcblxyXG5jb25zdCBMaXN0UmVuZGVyZXIgPSAoKSA9PiB7XHJcbiAgY29uc3QgY3JlYXRlVGFza0Zvcm0gPSAodGFyZ2V0LCBsaXN0KSA9PiB7XHJcbiAgICAvLyBDcmVhdGUgZm9ybSBhbmQgYXBwZW5kIGlucHV0IHRvIExpc3RcclxuICAgIGNvbnN0IHRhc2tGb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImZvcm1cIik7XHJcbiAgICB0YXNrRm9ybS5jbGFzc05hbWUgPSBcInRhc2stZm9ybVwiO1xyXG4gICAgY29uc3QgdGFza0lucHV0ID0gY3JlYXRlQ3VzdG9tRWxlbWVudCh7XHJcbiAgICAgIHRhZ05hbWU6IFwiaW5wdXRcIixcclxuICAgICAgY2xhc3NMaXN0OiBcInRhc2staW5wdXRcIixcclxuICAgICAgYXR0cmlidXRlczogW1wicGxhY2Vob2xkZXJcIiwgXCJBZGQgYSB0YXNrXCJdLFxyXG4gICAgfSk7XHJcbiAgICB0YXNrRm9ybS5hcHBlbmRDaGlsZCh0YXNrSW5wdXQpO1xyXG5cclxuICAgIC8vIEJpbmQgaW5wdXQgbGlzdGVuZXIgdG8gbW9uaXRvciBuZXcgdGFzayBlbnRyaWVzXHJcbiAgICB0YXNrSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgKGUpID0+IHtcclxuICAgICAgaGFuZGxlQ3JlYXRlVGFza0lucHV0KGUsIHRhcmdldCwgbGlzdCk7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiB0YXNrRm9ybTtcclxuICB9O1xyXG5cclxuICBjb25zdCBhcHBlbmRMaXN0Q29udGFpbmVyID0gKGxpc3RJZCkgPT4ge1xyXG4gICAgYXBwZW5kQ3VzdG9tRWxlbWVudCh7XHJcbiAgICAgIHRhcmdldDogXCIubGlzdC1jb250YWluZXJcIixcclxuICAgICAgdGFnTmFtZTogXCJkaXZcIixcclxuICAgICAgY2xhc3NMaXN0OiBbXCJsaXN0XCJdLFxyXG4gICAgICBhdHRyaWJ1dGVzOiBbXCJkYXRhLWlkXCIsIGxpc3RJZF0sXHJcbiAgICB9KTtcclxuICB9O1xyXG5cclxuICBjb25zdCBhcHBlbmRMaXN0QW5kVGl0bGVFbGVtZW50cyA9IChsaXN0LCBsaXN0SWQpID0+IHtcclxuICAgIGNvbnN0IGxpc3RFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2RhdGEtaWQ9XCIke2xpc3RJZH1cIl1gKTtcclxuICAgIGFwcGVuZEN1c3RvbUVsZW1lbnQoe1xyXG4gICAgICB0YXJnZXQ6IGBbZGF0YS1pZD1cIiR7bGlzdElkfVwiXWAsXHJcbiAgICAgIHRhZ05hbWU6IFwiaDJcIixcclxuICAgICAgdGV4dENvbnRlbnQ6IGxpc3QuZ2V0VGl0bGUoKSxcclxuICAgIH0pO1xyXG5cclxuICAgIGxpc3RFbGVtZW50LmFwcGVuZENoaWxkKGNyZWF0ZVRhc2tGb3JtKGxpc3RFbGVtZW50LCBsaXN0LCBsaXN0SWQpKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBhcHBlbmRUYXNrQ29udGFpbmVyID0gKGxpc3RJZCkgPT4ge1xyXG4gICAgYXBwZW5kQ3VzdG9tRWxlbWVudCh7XHJcbiAgICAgIHRhcmdldDogYFtkYXRhLWlkPVwiJHtsaXN0SWR9XCJdYCxcclxuICAgICAgdGFnTmFtZTogXCJkaXZcIixcclxuICAgICAgY2xhc3NMaXN0OiBcInRhc2stY29udGFpbmVyXCIsXHJcbiAgICB9KTtcclxuICB9O1xyXG5cclxuICBjb25zdCBhcHBlbmRUYXNrRWxlbWVudHMgPSAobGlzdCwgbGlzdElkKSA9PiB7XHJcbiAgICBjb25zdCBsaXN0RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLWlkPVwiJHtsaXN0SWR9XCJdYCk7XHJcbiAgICBjb25zdCB0YXNrQ29udGFpbmVyID0gbGlzdEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi50YXNrLWNvbnRhaW5lclwiKTtcclxuICAgIGNvbnN0IHRhc2tFbGVtZW50cyA9IGNyZWF0ZVRhc2tFbGVtZW50cyhsaXN0LmdldFRhc2tzKCksIGxpc3QpO1xyXG4gICAgcmVuZGVyVGFza0VsZW1lbnRzKHRhc2tDb250YWluZXIsIHRhc2tFbGVtZW50cyk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgcmVuZGVyTGlzdEVsZW1lbnRzID0gKGxpc3RzKSA9PiB7XHJcbiAgICBsaXN0cy5mb3JFYWNoKChsaXN0KSA9PiB7XHJcbiAgICAgIGNvbnN0IGxpc3RJZCA9IGxpc3QuZ2V0SWQoKTtcclxuXHJcbiAgICAgIGFwcGVuZExpc3RDb250YWluZXIobGlzdElkKTtcclxuICAgICAgYXBwZW5kTGlzdEFuZFRpdGxlRWxlbWVudHMobGlzdCwgbGlzdElkKTtcclxuICAgICAgYXBwZW5kVGFza0NvbnRhaW5lcihsaXN0SWQpO1xyXG4gICAgICBhcHBlbmRUYXNrRWxlbWVudHMobGlzdCwgbGlzdElkKTtcclxuXHJcbiAgICAgIC8vIE5vdyByZW5kZXIgYW5kIGFwcGVuZCB0aGUgdGFzayBlbGVtZW50c1xyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgcmV0dXJuIHsgcmVuZGVyTGlzdEVsZW1lbnRzIH07XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgeyByZW5kZXJMaXN0RWxlbWVudHMgfSA9IExpc3RSZW5kZXJlcigpO1xyXG4iLCJpbXBvcnQgeyByZW5kZXJMaXN0RWxlbWVudHMgfSBmcm9tIFwiLi9MaXN0UmVuZGVyZXJcIjtcclxuXHJcbmNvbnN0IExpc3RIYW5kbGVyID0gKCkgPT4ge1xyXG4gIGNvbnN0IGNyZWF0ZURlZmF1bHRMaXN0ID0gKGN1cnJlbnRQcm9qZWN0KSA9PiB7XHJcbiAgICBjb25zdCBoYWJpdExpc3QgPSBjdXJyZW50UHJvamVjdC5jcmVhdGVMaXN0KFwiSGFiaXRzXCIpO1xyXG4gICAgaGFiaXRMaXN0LmNyZWF0ZVRhc2soXCJDcmVhdGUgeW91ciBmaXJzdCBoYWJpdCFcIik7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgY2hlY2tGb3JMaXN0cyA9IChjdXJyZW50UHJvamVjdCkgPT4ge1xyXG4gICAgY29uc3QgY3VycmVudExpc3RzID0gY3VycmVudFByb2plY3QuZ2V0TGlzdHMoKTtcclxuICAgIGlmIChjdXJyZW50TGlzdHMubGVuZ3RoKSB7XHJcbiAgICAgIHJlbmRlckxpc3RFbGVtZW50cyhjdXJyZW50TGlzdHMpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY3JlYXRlRGVmYXVsdExpc3QoY3VycmVudFByb2plY3QpO1xyXG4gICAgICByZW5kZXJMaXN0RWxlbWVudHMoY3VycmVudFByb2plY3QuZ2V0TGlzdHMoKSk7XHJcbiAgICB9XHJcbiAgfTtcclxuICByZXR1cm4geyBjaGVja0Zvckxpc3RzIH07XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgeyBjaGVja0Zvckxpc3RzIH0gPSBMaXN0SGFuZGxlcigpO1xyXG4iLCJpbXBvcnQgUHJvamVjdCBmcm9tIFwiLi9Qcm9qZWN0LmpzXCI7XHJcbmltcG9ydCB7IGNoZWNrRm9yTGlzdHMgfSBmcm9tIFwiLi9MaXN0SGFuZGxlci5qc1wiO1xyXG5pbXBvcnQgeyBoYW5kbGVDcmVhdGVMaXN0SW5wdXQgfSBmcm9tIFwiLi9FdmVudEhhbmRsZXIuanNcIjtcclxuXHJcbmNvbnN0IGN1cnJlbnRQcm9qZWN0ID0gUHJvamVjdCgpO1xyXG5zZXNzaW9uU3RvcmFnZS5zZXRJdGVtKFwiY3VycmVudFByb2plY3RcIiwgSlNPTi5zdHJpbmdpZnkoY3VycmVudFByb2plY3QpKTtcclxuY29uc29sZS5sb2coSlNPTi5wYXJzZShzZXNzaW9uU3RvcmFnZS5jdXJyZW50UHJvamVjdCkpO1xyXG5cclxuY29uc3QgVXNlckludGVyZmFjZSA9ICgoKSA9PiB7XHJcbiAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2xpc3QtaW5wdXRcIik7XHJcblxyXG4gIGNvbnN0IGluaXQgPSAoKSA9PiB7XHJcbiAgICBjaGVja0Zvckxpc3RzKGN1cnJlbnRQcm9qZWN0KTtcclxuXHJcbiAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoZSkgPT4ge1xyXG4gICAgICBoYW5kbGVDcmVhdGVMaXN0SW5wdXQoZSwgY3VycmVudFByb2plY3QpO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgcmV0dXJuIHsgaW5pdCB9O1xyXG59KSgpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgVXNlckludGVyZmFjZTtcclxuIiwiaW1wb3J0IExpc3QgZnJvbSBcIi4vTGlzdFwiO1xyXG5cclxuY29uc3QgUHJvamVjdCA9IChpZCA9IGNyeXB0by5yYW5kb21VVUlEKCkuc2xpY2UoMCwgOCkpID0+IHtcclxuICBjb25zdCBsaXN0cyA9IFtdO1xyXG5cclxuICBjb25zdCBnZXRJZCA9ICgpID0+IGlkO1xyXG5cclxuICBjb25zdCBnZXRMaXN0cyA9ICgpID0+IGxpc3RzO1xyXG5cclxuICBjb25zdCBjcmVhdGVMaXN0ID0gKHRpdGxlKSA9PiB7XHJcbiAgICBsaXN0cy5wdXNoKExpc3QodGl0bGUpKTtcclxuICAgIHJldHVybiBsaXN0c1tsaXN0cy5sZW5ndGggLSAxXTtcclxuICB9O1xyXG5cclxuICBjb25zdCBmaW5kTGlzdCA9IChsaXN0SWQpID0+IHtcclxuICAgIGNvbnN0IGxpc3RJbmRleCA9IGxpc3RzLmZpbmRJbmRleCgobGlzdCkgPT4gbGlzdC5pZCA9PT0gbGlzdElkKTtcclxuICAgIHJldHVybiBsaXN0c1tsaXN0SW5kZXhdO1xyXG4gIH07XHJcblxyXG4gIHJldHVybiB7IGdldElkLCBnZXRMaXN0cywgY3JlYXRlTGlzdCwgZmluZExpc3QgfTtcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IFByb2plY3Q7XHJcbiIsImltcG9ydCBUYXNrTWFuYWdlciBmcm9tIFwiLi9tb2R1bGVzL1Rhc2tNYW5hZ2VyLmpzXCI7XHJcbmltcG9ydCBVc2VySW50ZXJmYWNlIGZyb20gXCIuL21vZHVsZXMvVXNlckludGVyZmFjZS5qc1wiO1xyXG5pbXBvcnQgUHJvamVjdCBmcm9tIFwiLi9tb2R1bGVzL1Byb2plY3QuanNcIjtcclxuXHJcbmNvbnN0IFVJID0gVXNlckludGVyZmFjZTtcclxuVUkuaW5pdCgpO1xyXG5cclxuLy8gICAvLyBDcmVhdGUgbGlzdFxyXG5cclxuLy8gICAvLyBQYXNzIGluIGFycmF5IG9mIGVsZW1lbnRzIHRvIGJlIHJlbmRlcmVkIGluIHRoZSBsaXN0IGNvbnRhaW5lclxyXG5cclxuLyogTm93IEkgd2FudCB0byBsaW5rIGl0IHRvIHRoZSBVSVxyXG4gIEZvcm0gSW5wdXQgdG8gY3JlYXRlIGEgbmV3IExpc3RcclxuICBuZXcgTGlzdCB3aWxsIGNvbnRhaW4gYW4gaW5wdXQgdG8gY3JlYXRlIGEgbmV3IFRhc2tcclxuKi9cclxuXHJcbi8qIFVwZGF0aW5nIFRhc2tcclxuICBGb3JtIGlucHV0IGluIExpc3RcclxuICBTdWJtaXQgYSBuZXcgVGFzayB0byBsaXN0U3RvcmFnZVt4XS5jcmVhdGVUYXNrKHRhc2tEZXRhaWxzKTtcclxuXHJcbiovXHJcbiJdLCJuYW1lcyI6WyJ0aXRsZSIsImlkIiwiY3J5cHRvIiwicmFuZG9tVVVJRCIsInNsaWNlIiwidGFza3MiLCJ0YXNrTWFuYWdlciIsInRhc2tMaXN0IiwiZ2V0VGFza0J5SW5kZXgiLCJ0YXNrSWQiLCJmaW5kSW5kZXgiLCJ0YXNrIiwiZ2V0VGFza0J5SWQiLCJmaW5kIiwiY3JlYXRlVGFzayIsInB1c2giLCJsZW5ndGgiLCJ1cGRhdGVUYXNrIiwidXBkYXRlZEVudHJ5IiwidGFza0luZGV4IiwicmVtb3ZlVGFzayIsInNwbGljZSIsImdldFRpdGxlIiwiZ2V0SWQiLCJnZXRUYXNrcyIsImFwcGVuZEN1c3RvbUVsZW1lbnQiLCJjcmVhdGVDdXN0b21FbGVtZW50Iiwib3B0aW9ucyIsInRhZ05hbWUiLCJjbGFzc0xpc3QiLCJ0ZXh0Q29udGVudCIsImF0dHJpYnV0ZXMiLCJlbGVtZW50IiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiYWRkIiwiQXJyYXkiLCJpc0FycmF5IiwiYXR0ciIsInZhbHVlIiwic2V0QXR0cmlidXRlIiwidGFyZ2V0IiwidGFyZ2V0RWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJhcHBlbmRDaGlsZCIsImN1c3RvbUVsZW1lbnRIZWxwZXIiLCJoYW5kbGVDcmVhdGVMaXN0SW5wdXQiLCJoYW5kbGVDcmVhdGVUYXNrSW5wdXQiLCJlZGl0VGFzayIsInRvZ2dsZURldGFpbHMiLCJhdXRvUmVzaXplIiwidGhpcyIsInN0eWxlIiwiaGVpZ2h0Iiwic2Nyb2xsSGVpZ2h0IiwiZSIsImN1cnJlbnRQcm9qZWN0Iiwia2V5IiwicHJldmVudERlZmF1bHQiLCJuZXdMaXN0IiwiY3JlYXRlTGlzdCIsInJlbmRlckxpc3RFbGVtZW50cyIsImxpc3QiLCJuZXdUYXNrIiwidGFza0VsZW1lbnQiLCJjcmVhdGVUYXNrRWxlbWVudHMiLCJyZW5kZXJUYXNrRWxlbWVudHMiLCJjdXJyZW50TGlzdCIsImVsIiwiY29udGFpbnMiLCJwcmV2aW91cyIsImNsb25lTm9kZSIsImlucHV0IiwiY3VycmVudFRhc2siLCJ3b3JkQnJlYWsiLCJyZXBsYWNlV2l0aCIsImFkZEV2ZW50TGlzdGVuZXIiLCJibHVyIiwib25jZSIsImZvY3VzIiwidGFza0NvbnRhaW5lciIsImNsb3Nlc3QiLCJleHBhbmRlZERldGFpbHMiLCJ0b2dnbGUiLCJyZW1vdmUiLCJyZW5kZXJFeHBhbmRlZFRhc2siLCJFdmVudEhhbmRsZXIiLCJldmVudEhhbmRsZXIiLCJzZXRFZGl0TW9kZSIsInNldFByaW9yaXR5IiwicHJpb3JpdHkiLCJzcmMiLCJkZWxldGVUYXNrIiwidG9vbHMiLCJuYW1lIiwiaW1nU3JjIiwiY2xhc3NOYW1lIiwib25DbGljayIsImNyZWF0ZVRvb2xiYXIiLCJ0b29sYmFyQ29udGFpbmVyIiwiYXBwZW5kIiwiZnJhZ21lbnQiLCJjcmVhdGVEb2N1bWVudEZyYWdtZW50IiwiZm9yRWFjaCIsInRvb2wiLCJidG4iLCJhdHRyaWJ1dGUiLCJpbWciLCJvbmNsaWNrIiwiX19jcmVhdGVCdG5zIiwibWFwIiwiZGF0YXNldCIsInRvb2xiYXIiLCJwcmVwZW5kIiwiZXhwYW5kZWRUYXNrIiwiZGVzY3JpcHRpb24iLCJkdWVEYXRlIiwiZGlmZmljdWx0eSIsImV4cGFuZGVkRGl2IiwiX19jcmVhdGVFeHBhbmRlZFRhc2siLCJsaXN0cyIsImxpc3RJZCIsImFwcGVuZExpc3RDb250YWluZXIiLCJsaXN0RWxlbWVudCIsInRhc2tGb3JtIiwidGFza0lucHV0IiwiY3JlYXRlVGFza0Zvcm0iLCJhcHBlbmRMaXN0QW5kVGl0bGVFbGVtZW50cyIsImFwcGVuZFRhc2tDb250YWluZXIiLCJ0YXNrRWxlbWVudHMiLCJhcHBlbmRUYXNrRWxlbWVudHMiLCJjaGVja0Zvckxpc3RzIiwiY3VycmVudExpc3RzIiwiZ2V0TGlzdHMiLCJjcmVhdGVEZWZhdWx0TGlzdCIsImZpbmRMaXN0IiwibGlzdEluZGV4Iiwic2Vzc2lvblN0b3JhZ2UiLCJzZXRJdGVtIiwiSlNPTiIsInN0cmluZ2lmeSIsImNvbnNvbGUiLCJsb2ciLCJwYXJzZSIsImluaXQiXSwic291cmNlUm9vdCI6IiJ9