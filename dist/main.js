(()=>{"use strict";const t=(t,e=crypto.randomUUID().slice(0,8))=>{const s=[],a=(t=>{const e=e=>t.findIndex((t=>t.id===e));return{getTaskById:e=>t.find((t=>t.id===e)),createTask:e=>(t.push({id:crypto.randomUUID().slice(0,8),title:e}),t[t.length-1]),updateTask:(s,a)=>{const n=e(s);return t[n]={...t[n],...a},t[n]},removeTask:s=>{const a=e(s);t.splice(a,1)}}})(s);return{getTitle:()=>t,getId:()=>e,getTasks:()=>s,createTask:t=>a.createTask(t),getTaskById:t=>a.getTaskById(t),updateTask:(t,e)=>a.updateTask(t,e),removeTask:t=>a.removeTask(t)}},{appendCustomElement:e,createCustomElement:s}=(()=>{function t(t){const{tagName:e,classList:s,textContent:a,attributes:n}=t,i=document.createElement(e);if("string"==typeof s?i.classList.add(s):Array.isArray(s)&&i.classList.add(...s),a&&(i.textContent=a),Array.isArray(n)){const[t,e]=n;i.setAttribute(t,e)}return i}return{appendCustomElement:function(e){const{target:s}=e,a=document.querySelector(s),n=t(e);a.appendChild(n)},createCustomElement:t}})(),a=t=>{if(!t)return"";const e=new Date(t);return e.setHours(24,0,0,0),e.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"})},n=(t,e)=>{const a=t=>{const e=document.createDocumentFragment(),a=s({tagName:"textarea",classList:"edit-title"});a.value=t.title,a.name="title";const i=s({tagName:"textarea",classList:"edit-description",attributes:["placeholder","Add a description"]});i.value=t.description||"",i.name="description";const r=s({tagName:"input",attributes:["type","date"],classList:"edit-date"}),c=new Date;t.dueDate?r.value=t.dueDate:r.valueAsDate=new Date(c.getFullYear(),c.getMonth(),c.getDate(),12),r.name="dueDate";const o=s({tagName:"select",classList:"edit-difficulty"});o.value=t.difficulty,o.name="difficulty";const d=["","Easy","Medium","Hard"].map((t=>s({tagName:"option",textContent:t,attributes:["value",`${t}`]})));o.append(...d);const l=n(t);return e.append(a,i,r,o,l),e},n=()=>{const a=s({tagName:"div",classList:"form-controls"}),n=s({tagName:"button",classList:"submit-btn",textContent:"Submit"}),i=s({tagName:"button",classList:"cancel-btn",textContent:"Cancel"});return i.onclick=s=>((t,e)=>{t.preventDefault();const s=t.target.closest("form"),a=s.parentNode,n=a.querySelector(".main-details");s.remove(),a.classList.remove("isEditable");const i=l(e);n.append(i)})(s,t.getTaskById(e)),a.append(i,n),a};return{appendEditTaskForm:s=>{const n=(()=>{const s=document.createElement("form"),n=t.getTaskById(e);return s.id="edit-task",s.append(a(n)),s.addEventListener("submit",(e=>{((t,e,s)=>{t.preventDefault();const a=t.target,n=a.parentNode,i=n.querySelector(".main-details"),r=n.querySelector(".bottom-panel"),c=new FormData(a),o={};for(const[t,e]of c)o[t]=e;const d=e.updateTask(s.id,o);a.remove();const u=l(d);i.append(u),r.replaceChildren();const p=m(d);r.append(p),n.classList.remove("isEditable")})(e,t,n)})),s})();return s.append(n),n}}},i=(t,e)=>{const a=((t,e)=>({setEditMode:s=>{const a=s.target.closest(".task");if(a.classList.contains("isEditable"))return;const i=a.querySelector(".main-details");a.classList.add("isEditable"),i.replaceChildren(),a.classList.contains("expanded")&&(a.querySelector(".expanded-details").remove(),a.classList.remove("expanded"));const r=n(t,e.id).appendEditTaskForm(a);[...r.getElementsByTagName("textarea")].forEach((t=>{t.addEventListener("keydown",(t=>{if("Enter"===t.key&&!t.shiftKey){t.preventDefault();const e=new Event("submit",{bubbles:!0,cancelable:!0});r.dispatchEvent(e)}}))}))},setPriority:s=>{t.getTaskById(e.id).priority?(t.updateTask(e.id,{priority:!1}),s.target.closest("img").src="../src/imgs/noun-star-4485746.svg"):(t.updateTask(e.id,{priority:!0}),s.target.closest("img").src="../src/imgs/noun-star-4485827.svg"),s.target.closest(".task").classList.toggle("isPriority"),s.target.closest("img").classList.toggle("filter-gray"),s.target.closest("img").classList.toggle("filter-yellow")},deleteTask:s=>{t.removeTask(e.id),s.target.closest(".task").remove()}}))(t,e),i=[{name:"Edit",imgSrc:"../src/imgs/noun-quill-4626718.svg",className:"filter-gray",onClick:t=>a.setEditMode(t)},{name:"Set Priority",imgSrc:"../src/imgs/noun-star-4485746.svg",className:"filter-gray",onClick:t=>a.setPriority(t)},{name:"Delete",imgSrc:"../src/imgs/noun-skull-4485674.svg",className:"filter-red",onClick:t=>a.deleteTask(t)}];return{createToolbar:()=>{const t=s({tagName:"div",classList:"toolbar"});return t.append((t=>{const e=document.createDocumentFragment();return t.forEach((t=>{const{name:a,imgSrc:n,className:i,onClick:r}=t,c=s({tagName:"button",attributes:["aria-label",`${a}`]}),o=s({tagName:"img",attributes:["src",`${n}`],classList:i});c.onclick=r,c.append(o),e.append(c)})),e})(i)),t}}},r=(()=>{const t={};return{getEvents:()=>t,subscribe:(e,s)=>{let a;return console.log("subbing"),t.hasOwnProperty(e)||(t[e]=[]),a=t[e].push(s)-1,{unsubscribe(){t[e].splice(a,1)}}},publish:(e,s={})=>(console.log("pubbing"),t.hasOwnProperty(e)?t[e].map((t=>t(s))):[])}})();r.subscribe("taskCreated",(function(t){const{list:e,task:s}=t;c(e,s)}));const c=(t,e)=>{const s=document.querySelector(`[data-id="${t.getId()}"]`).querySelector(".tasks-container"),a=o(t,e);s.prepend(a)},o=(t,e)=>{const s=document.createElement("div");s.className="task",s.dataset.id=e.id;const a=i(t,e).createToolbar(t,s),n=d(e),r=u(t,e.id);return s.append(a),s.append(n),s.append(r),s.addEventListener("dblclick",(s=>{g(s,e.id,t)})),s.addEventListener("click",(s=>{y(s,t,e.id)})),s.addEventListener("mouseover",(()=>{a.style.opacity="1",a.style.visibility="visible"})),s.addEventListener("mouseout",(()=>{a.style.opacity="0",a.style.visibility="hidden"})),s},d=t=>{const e=document.createElement("div");return e.classList.add("main-details"),e.appendChild(l(t)),e},l=t=>{const e=document.createDocumentFragment(),a=s({tagName:"p",classList:"task-title",textContent:t.title}),n=t.description?s({tagName:"p",classList:"task-description",textContent:t.description}):" ";return e.append(a,n),e},u=(t,e)=>{const a=t.getTaskById(e),n=s({tagName:"div",classList:"bottom-panel"});return n.append(m(a)),n},m=t=>{const e=document.createDocumentFragment(),n=s({tagName:"p",textContent:(t=>{switch(t){case"Easy":return"⚔️";case"Medium":return"⚔️⚔️";case"Hard":return"⚔️⚔️⚔️";default:return""}})(t.difficulty)}),i=s({tagName:"p",textContent:a(t.dueDate)||""});return e.append(i,n),e};function p(){this.style.height="auto",this.style.height=this.scrollHeight+"px"}const g=(t,e,s)=>{const a=t.target;if(!a.classList.contains("task-title"))return;const n=a.cloneNode(!0),i=document.createElement("textarea"),r=s.getTaskById(e);i.classList.add("temp-input"),i.value=r.title,i.style.wordBreak="break-word",a.replaceWith(i),i.style.height="auto",i.style.height=i.scrollHeight+"px",i.addEventListener("keydown",(t=>{"Enter"===t.key&&i.blur()})),i.addEventListener("blur",(()=>{s.updateTask(e,{title:i.value}),n.textContent=i.value,i.replaceWith(n)}),{once:!0}),i.addEventListener("input",p,!1),i.focus()},y=(t,e,n)=>{if(t.target.classList.contains("isEditable")||!t.target.classList.contains("task"))return;const i=t.target,r=i.querySelector(".main-details"),c=i.querySelector(".expanded-details");i.classList.contains("isEditable")||(c?(c.remove(),i.classList.remove("expanded")):(((t,e)=>{const n=(t=>{const{dueDate:e,difficulty:n}=t,i=document.createDocumentFragment(),r=document.createElement("div");return r.classList.add("expanded-details"),i.append(r),r.append(s({tagName:"p",classList:"due-date",textContent:a(e)})),console.log(e),r.append(s({tagName:"p",classList:"difficulty",textContent:n})),i})(e);t.after(n)})(r,e.getTaskById(n)),i.classList.add("expanded")))};function k(t){v(t),b(t),f(t)}r.subscribe("listCreated",k);const v=t=>{e({target:".lists-container",tagName:"div",classList:["list"],attributes:["data-id",t.getId()]})},b=t=>{const s=document.querySelector(`[data-id="${t.getId()}"]`);e({target:`[data-id="${t.getId()}"]`,tagName:"h2",textContent:t.getTitle()}),s.appendChild(L(t))},L=t=>{const e=document.createElement("form");e.className="task-form";const a=s({tagName:"input",classList:"task-input",attributes:["placeholder","Add a task"]});return e.appendChild(a),a.addEventListener("keydown",(e=>{((t,e)=>{if("Enter"===t.key){t.preventDefault();const s=t.target.value,a=e.createTask(s);t.target.value="",r.publish("taskCreated",{list:e,task:a})}})(e,t)})),e},f=t=>{e({target:`[data-id="${t.getId()}"]`,tagName:"div",classList:"tasks-container"})},h=k,{checkForLists:E}={checkForLists:t=>{const e=t.getLists();e.length?e.forEach((t=>h(t))):(t=>{const e=t.createList("Habits"),s=e.createTask("Create your first habit!");r.publish("listCreated",e),r.publish("taskCreated",{list:e,task:s})})(t)}},T=(()=>{const t=[];return{getProjects:()=>t,addProject:e=>t.push(e)}})();T.addProject(((e,s=crypto.randomUUID().slice(0,8))=>{const a=[];return{getTitle:()=>e,getId:()=>s,getLists:()=>a,createList:e=>(a.push(t(e)),a[a.length-1]),getListById:t=>{const e=a.findIndex((e=>e.getId()===t));return a[e]}}})("Default"));const C=T.getProjects()[0],N=(()=>{const t=document.querySelector("#list-input");return{init:()=>{E(C),t.addEventListener("keydown",(t=>{((t,e)=>{if("Enter"===t.key){t.preventDefault();const s=t.target.value,a=e.createList(s);t.target.value="",r.publish("listCreated",a)}})(t,C)}))}}})();N.init()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0hVLEVBQUN2TSxFQUFPQyxFQUFLQyxPQUFPQyxhQUFhQyxNQUFNLEVBQUcsTUFDeEQsTUFBTTJMLEVBQVEsR0FpQmQsTUFBTyxDQUFFekssU0FmUSxJQUFNdEIsRUFlSnVCLE1BZEwsSUFBTXRCLEVBY00rTCxTQWJULElBQU1ELEVBYWFHLFdBWGhCbE0sSUFDbEIrTCxFQUFNaEwsS0FBSyxFQUFLZixJQUNUK0wsRUFBTUEsRUFBTS9LLE9BQVMsSUFTa0J5TCxZQU4zQkMsSUFDbkIsTUFBTUMsRUFBWVosRUFBTXJMLFdBQVdnRixHQUFTQSxFQUFLbkUsVUFBWW1MLElBRTdELE9BQU9YLEVBQU1ZLEVBQVUsRUFHb0MsRURmOUMsQ0FBUSxZQUN6QixNQUFNYixFQUFpQixFQUFNUSxjQUFjLEdBRXJDTSxFQUFnQixNQUNwQixNQUFNdEMsRUFBUXJJLFNBQVNVLGNBQWMsZUFVckMsTUFBTyxDQUFFa0ssS0FSSSxLQUNYaEIsRUFBY0MsR0FFZHhCLEVBQU03RSxpQkFBaUIsV0FBWWIsSUpYcEIsRUFBQ0EsRUFBR2tILEtBQ3JCLEdBQWMsVUFBVmxILEVBQUVnQyxJQUFpQixDQUNyQmhDLEVBQUVDLGlCQUNGLE1BQU03RSxFQUFRNEUsRUFBRW5DLE9BQU9GLE1BQ2pCdUssRUFBVWhCLEVBQWVJLFdBQVdsTSxHQUMxQzRFLEVBQUVuQyxPQUFPRixNQUFRLEdBRWpCcUosRUFBT2hELFFBQVEsY0FBZWtFLEVBQ2hDLEdJSUlaLENBQVd0SCxFQUFHa0gsRUFBZSxHQUM3QixFQUlMLEVBWnFCLEdBY3RCLEVFakJHZSxNIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb3AtdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvTGlzdC90YXNrL1Rhc2tNYW5hZ2VyLmpzIiwid2VicGFjazovL29wLXRvZG8tbGlzdC8uL3NyYy9tb2R1bGVzL0xpc3QvTGlzdC5qcyIsIndlYnBhY2s6Ly9vcC10b2RvLWxpc3QvLi9zcmMvbW9kdWxlcy9IZWxwZXJzL2N1c3RvbUVsZW1lbnRIZWxwZXIuanMiLCJ3ZWJwYWNrOi8vb3AtdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvSGVscGVycy9mb3JtYXREYXRlSGVscGVyLmpzIiwid2VicGFjazovL29wLXRvZG8tbGlzdC8uL3NyYy9tb2R1bGVzL0Zvcm0vRm9ybVJlbmRlcmVyLmpzIiwid2VicGFjazovL29wLXRvZG8tbGlzdC8uL3NyYy9tb2R1bGVzL0Zvcm0vRm9ybUV2ZW50SGFuZGxlcnMuanMiLCJ3ZWJwYWNrOi8vb3AtdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvVG9vbGJhci9Ub29sYmFyLmpzIiwid2VicGFjazovL29wLXRvZG8tbGlzdC8uL3NyYy9tb2R1bGVzL1Rvb2xiYXIvVG9vbGJhckV2ZW50SGFuZGxlci5qcyIsIndlYnBhY2s6Ly9vcC10b2RvLWxpc3QvLi9zcmMvbW9kdWxlcy9wdWJzdWIuanMiLCJ3ZWJwYWNrOi8vb3AtdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvTGlzdC90YXNrL3Rhc2tSZW5kZXJpbmcuanMiLCJ3ZWJwYWNrOi8vb3AtdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvRXZlbnRIYW5kbGVyLmpzIiwid2VicGFjazovL29wLXRvZG8tbGlzdC8uL3NyYy9tb2R1bGVzL0xpc3QvTGlzdFJlbmRlcmVyLmpzIiwid2VicGFjazovL29wLXRvZG8tbGlzdC8uL3NyYy9tb2R1bGVzL0xpc3QvTGlzdEhhbmRsZXIuanMiLCJ3ZWJwYWNrOi8vb3AtdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvc3RvcmUuanMiLCJ3ZWJwYWNrOi8vb3AtdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvVXNlckludGVyZmFjZS5qcyIsIndlYnBhY2s6Ly9vcC10b2RvLWxpc3QvLi9zcmMvbW9kdWxlcy9Qcm9qZWN0LmpzIiwid2VicGFjazovL29wLXRvZG8tbGlzdC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBUYXNrTWFuYWdlciA9ICh0YXNrTGlzdCkgPT4ge1xyXG4gIGNvbnN0IGdldFRhc2tCeUlkID0gKHRhc2tJZCkgPT4ge1xyXG4gICAgcmV0dXJuIHRhc2tMaXN0LmZpbmQoKHRhc2spID0+IHRhc2suaWQgPT09IHRhc2tJZCk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgZ2V0VGFza0J5SW5kZXggPSAodGFza0lkKSA9PiB7XHJcbiAgICByZXR1cm4gdGFza0xpc3QuZmluZEluZGV4KCh0YXNrKSA9PiB0YXNrLmlkID09PSB0YXNrSWQpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGNyZWF0ZVRhc2sgPSAodGl0bGUpID0+IHtcclxuICAgIHRhc2tMaXN0LnB1c2goe1xyXG4gICAgICBpZDogY3J5cHRvLnJhbmRvbVVVSUQoKS5zbGljZSgwLCA4KSxcclxuICAgICAgdGl0bGUsXHJcbiAgICB9KTtcclxuICAgIHJldHVybiB0YXNrTGlzdFt0YXNrTGlzdC5sZW5ndGggLSAxXTtcclxuICB9O1xyXG5cclxuICBjb25zdCB1cGRhdGVUYXNrID0gKHRhc2tJZCwgdXBkYXRlZEVudHJ5KSA9PiB7XHJcbiAgICBjb25zdCB0YXNrSW5kZXggPSBnZXRUYXNrQnlJbmRleCh0YXNrSWQpO1xyXG4gICAgdGFza0xpc3RbdGFza0luZGV4XSA9IHsgLi4udGFza0xpc3RbdGFza0luZGV4XSwgLi4udXBkYXRlZEVudHJ5IH07XHJcbiAgICByZXR1cm4gdGFza0xpc3RbdGFza0luZGV4XTtcclxuICB9O1xyXG5cclxuICBjb25zdCByZW1vdmVUYXNrID0gKHRhc2tJZCkgPT4ge1xyXG4gICAgY29uc3QgdGFza0luZGV4ID0gZ2V0VGFza0J5SW5kZXgodGFza0lkKTtcclxuICAgIHRhc2tMaXN0LnNwbGljZSh0YXNrSW5kZXgsIDEpO1xyXG4gIH07XHJcblxyXG4gIHJldHVybiB7IGdldFRhc2tCeUlkLCBjcmVhdGVUYXNrLCB1cGRhdGVUYXNrLCByZW1vdmVUYXNrIH07XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBUYXNrTWFuYWdlcjtcclxuIiwiaW1wb3J0IFRhc2tNYW5hZ2VyIGZyb20gXCIuL3Rhc2svVGFza01hbmFnZXJcIjtcclxuXHJcbmNvbnN0IExpc3QgPSAodGl0bGUsIGlkID0gY3J5cHRvLnJhbmRvbVVVSUQoKS5zbGljZSgwLCA4KSkgPT4ge1xyXG4gIGNvbnN0IHRhc2tzID0gW107XHJcbiAgY29uc3QgdGFza01hbmFnZXIgPSBUYXNrTWFuYWdlcih0YXNrcyk7XHJcblxyXG4gIGNvbnN0IGdldFRpdGxlID0gKCkgPT4gdGl0bGU7XHJcbiAgY29uc3QgZ2V0SWQgPSAoKSA9PiBpZDtcclxuICBjb25zdCBnZXRUYXNrcyA9ICgpID0+IHRhc2tzO1xyXG5cclxuICBjb25zdCBjcmVhdGVUYXNrID0gKHRpdGxlKSA9PiB7XHJcbiAgICByZXR1cm4gdGFza01hbmFnZXIuY3JlYXRlVGFzayh0aXRsZSk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgZ2V0VGFza0J5SWQgPSAodGFza0lkKSA9PiB7XHJcbiAgICByZXR1cm4gdGFza01hbmFnZXIuZ2V0VGFza0J5SWQodGFza0lkKTtcclxuICB9O1xyXG5cclxuICBjb25zdCB1cGRhdGVUYXNrID0gKHRhc2tJZCwgdXBkYXRlZEVudHJ5KSA9PiB7XHJcbiAgICByZXR1cm4gdGFza01hbmFnZXIudXBkYXRlVGFzayh0YXNrSWQsIHVwZGF0ZWRFbnRyeSk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgcmVtb3ZlVGFzayA9ICh0YXNrSWQpID0+IHtcclxuICAgIHJldHVybiB0YXNrTWFuYWdlci5yZW1vdmVUYXNrKHRhc2tJZCk7XHJcbiAgfTtcclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIGdldFRpdGxlLFxyXG4gICAgZ2V0SWQsXHJcbiAgICBnZXRUYXNrcyxcclxuICAgIGNyZWF0ZVRhc2ssXHJcbiAgICBnZXRUYXNrQnlJZCxcclxuICAgIHVwZGF0ZVRhc2ssXHJcbiAgICByZW1vdmVUYXNrLFxyXG4gIH07XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBMaXN0O1xyXG4iLCJjb25zdCBjdXN0b21FbGVtZW50SGVscGVyID0gKCkgPT4ge1xyXG4gIC8vIFBhc3MgaW4gYSBvYmplY3Qgb2YgeyBbdGFyZ2V0XS4sIHRhZ05hbWUsIGNsYXNzTGlzdCwgdGV4dENvbnRlbnQsIGF0dHJpYnV0ZXMgfVxyXG4gIGZ1bmN0aW9uIGFwcGVuZEN1c3RvbUVsZW1lbnQob3B0aW9ucykge1xyXG4gICAgY29uc3QgeyB0YXJnZXQgfSA9IG9wdGlvbnM7XHJcbiAgICBjb25zdCB0YXJnZXRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0YXJnZXQpO1xyXG5cclxuICAgIGNvbnN0IGVsZW1lbnQgPSBjcmVhdGVDdXN0b21FbGVtZW50KG9wdGlvbnMpO1xyXG4gICAgdGFyZ2V0RWxlbWVudC5hcHBlbmRDaGlsZChlbGVtZW50KTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGNyZWF0ZUN1c3RvbUVsZW1lbnQob3B0aW9ucykge1xyXG4gICAgY29uc3QgeyB0YWdOYW1lLCBjbGFzc0xpc3QsIHRleHRDb250ZW50LCBhdHRyaWJ1dGVzIH0gPSBvcHRpb25zO1xyXG4gICAgY29uc3QgZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGFnTmFtZSk7XHJcblxyXG4gICAgaWYgKHR5cGVvZiBjbGFzc0xpc3QgPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKGNsYXNzTGlzdCk7XHJcbiAgICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkoY2xhc3NMaXN0KSkge1xyXG4gICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoLi4uY2xhc3NMaXN0KTtcclxuICAgIH1cclxuICAgIGlmICh0ZXh0Q29udGVudCkge1xyXG4gICAgICBlbGVtZW50LnRleHRDb250ZW50ID0gdGV4dENvbnRlbnQ7XHJcbiAgICB9XHJcbiAgICBpZiAoQXJyYXkuaXNBcnJheShhdHRyaWJ1dGVzKSkge1xyXG4gICAgICBjb25zdCBbYXR0ciwgdmFsdWVdID0gYXR0cmlidXRlcztcclxuICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoYXR0ciwgdmFsdWUpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGVsZW1lbnQ7XHJcbiAgfVxyXG4gIHJldHVybiB7IGFwcGVuZEN1c3RvbUVsZW1lbnQsIGNyZWF0ZUN1c3RvbUVsZW1lbnQgfTtcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCB7IGFwcGVuZEN1c3RvbUVsZW1lbnQsIGNyZWF0ZUN1c3RvbUVsZW1lbnQgfSA9XHJcbiAgY3VzdG9tRWxlbWVudEhlbHBlcigpO1xyXG4iLCJjb25zdCBmb3JtYXREYXRlID0gKGRhdGVTdHJpbmcpID0+IHtcclxuICBpZiAoIWRhdGVTdHJpbmcpIHtcclxuICAgIHJldHVybiBcIlwiO1xyXG4gIH1cclxuICBjb25zdCBkYXRlID0gbmV3IERhdGUoZGF0ZVN0cmluZyk7XHJcbiAgZGF0ZS5zZXRIb3VycygyNCwgMCwgMCwgMCk7XHJcblxyXG4gIGNvbnN0IGZvcm1hdHRlZERhdGUgPSBkYXRlLnRvTG9jYWxlRGF0ZVN0cmluZyhcImVuLVVTXCIsIHtcclxuICAgIG1vbnRoOiBcIjItZGlnaXRcIixcclxuICAgIGRheTogXCIyLWRpZ2l0XCIsXHJcbiAgICB5ZWFyOiBcIjItZGlnaXRcIixcclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIGZvcm1hdHRlZERhdGU7XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBmb3JtYXREYXRlO1xyXG4iLCJpbXBvcnQgeyBjcmVhdGVDdXN0b21FbGVtZW50IH0gZnJvbSBcIi4uL0hlbHBlcnMvY3VzdG9tRWxlbWVudEhlbHBlci5qc1wiO1xyXG5pbXBvcnQgeyBzdWJtaXRGb3JtLCBjYW5jZWxGb3JtIH0gZnJvbSBcIi4vRm9ybUV2ZW50SGFuZGxlcnMuanNcIjtcclxuXHJcbmNvbnN0IEZvcm1SZW5kZXJlciA9IChjdXJyZW50TGlzdCwgdGFza0lkKSA9PiB7XHJcbiAgY29uc3QgYXBwZW5kRWRpdFRhc2tGb3JtID0gKHRhcmdldCkgPT4ge1xyXG4gICAgY29uc3QgZWRpdEZvcm0gPSBfX2NyZWF0ZUVkaXRUYXNrRm9ybSgpO1xyXG4gICAgdGFyZ2V0LmFwcGVuZChlZGl0Rm9ybSk7XHJcbiAgICByZXR1cm4gZWRpdEZvcm07XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgX19jcmVhdGVFZGl0VGFza0Zvcm0gPSAoKSA9PiB7XHJcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImZvcm1cIik7XHJcbiAgICBjb25zdCB0YXNrID0gY3VycmVudExpc3QuZ2V0VGFza0J5SWQodGFza0lkKTtcclxuICAgIGZvcm0uaWQgPSBcImVkaXQtdGFza1wiO1xyXG4gICAgZm9ybS5hcHBlbmQoX19jcmVhdGVGb3JtRWxlbWVudHModGFzaykpO1xyXG5cclxuICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICBzdWJtaXRGb3JtKGUsIGN1cnJlbnRMaXN0LCB0YXNrKTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGZvcm07XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgX19jcmVhdGVGb3JtRWxlbWVudHMgPSAodGFzaykgPT4ge1xyXG4gICAgLy8gVGl0bGVcclxuICAgIGNvbnN0IGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xyXG5cclxuICAgIGNvbnN0IHRpdGxlID0gY3JlYXRlQ3VzdG9tRWxlbWVudCh7XHJcbiAgICAgIHRhZ05hbWU6IFwidGV4dGFyZWFcIixcclxuICAgICAgY2xhc3NMaXN0OiBcImVkaXQtdGl0bGVcIixcclxuICAgIH0pO1xyXG4gICAgdGl0bGUudmFsdWUgPSB0YXNrLnRpdGxlO1xyXG4gICAgdGl0bGUubmFtZSA9IFwidGl0bGVcIjtcclxuXHJcbiAgICAvL0Rlc2NyaXB0aW9uXHJcbiAgICBjb25zdCBkZXNjcmlwdGlvbiA9IGNyZWF0ZUN1c3RvbUVsZW1lbnQoe1xyXG4gICAgICB0YWdOYW1lOiBcInRleHRhcmVhXCIsXHJcbiAgICAgIGNsYXNzTGlzdDogXCJlZGl0LWRlc2NyaXB0aW9uXCIsXHJcbiAgICAgIGF0dHJpYnV0ZXM6IFtcInBsYWNlaG9sZGVyXCIsIFwiQWRkIGEgZGVzY3JpcHRpb25cIl0sXHJcbiAgICB9KTtcclxuICAgIGRlc2NyaXB0aW9uLnZhbHVlID0gdGFzay5kZXNjcmlwdGlvbiB8fCBcIlwiO1xyXG4gICAgZGVzY3JpcHRpb24ubmFtZSA9IFwiZGVzY3JpcHRpb25cIjtcclxuXHJcbiAgICAvLyBEdWUgRGF0ZVxyXG4gICAgY29uc3QgZHVlRGF0ZSA9IGNyZWF0ZUN1c3RvbUVsZW1lbnQoe1xyXG4gICAgICB0YWdOYW1lOiBcImlucHV0XCIsXHJcbiAgICAgIGF0dHJpYnV0ZXM6IFtcInR5cGVcIiwgXCJkYXRlXCJdLFxyXG4gICAgICBjbGFzc0xpc3Q6IFwiZWRpdC1kYXRlXCIsXHJcbiAgICB9KTtcclxuICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgdGFzay5kdWVEYXRlXHJcbiAgICAgID8gKGR1ZURhdGUudmFsdWUgPSB0YXNrLmR1ZURhdGUpXHJcbiAgICAgIDogKGR1ZURhdGUudmFsdWVBc0RhdGUgPSBuZXcgRGF0ZShcclxuICAgICAgICAgIGRhdGUuZ2V0RnVsbFllYXIoKSxcclxuICAgICAgICAgIGRhdGUuZ2V0TW9udGgoKSxcclxuICAgICAgICAgIGRhdGUuZ2V0RGF0ZSgpLFxyXG4gICAgICAgICAgMTJcclxuICAgICAgICApKTtcclxuICAgIGR1ZURhdGUubmFtZSA9IFwiZHVlRGF0ZVwiO1xyXG5cclxuICAgIC8vIERpZmZpY3VsdHlcclxuICAgIGNvbnN0IGRpZmZpY3VsdHkgPSBjcmVhdGVDdXN0b21FbGVtZW50KHtcclxuICAgICAgdGFnTmFtZTogXCJzZWxlY3RcIixcclxuICAgICAgY2xhc3NMaXN0OiBcImVkaXQtZGlmZmljdWx0eVwiLFxyXG4gICAgfSk7XHJcbiAgICBkaWZmaWN1bHR5LnZhbHVlID0gdGFzay5kaWZmaWN1bHR5O1xyXG4gICAgZGlmZmljdWx0eS5uYW1lID0gXCJkaWZmaWN1bHR5XCI7XHJcbiAgICBjb25zdCBkaWZmaWN1bHR5T3B0aW9ucyA9IFtcIlwiLCBcIkVhc3lcIiwgXCJNZWRpdW1cIiwgXCJIYXJkXCJdO1xyXG5cclxuICAgIC8vIERpZmZpY3VsdHkgT3B0aW9uc1xyXG4gICAgY29uc3Qgb3B0aW9uRWxlbWVudHMgPSBkaWZmaWN1bHR5T3B0aW9ucy5tYXAoKG9wdGlvbikgPT4ge1xyXG4gICAgICByZXR1cm4gY3JlYXRlQ3VzdG9tRWxlbWVudCh7XHJcbiAgICAgICAgdGFnTmFtZTogXCJvcHRpb25cIixcclxuICAgICAgICB0ZXh0Q29udGVudDogb3B0aW9uLFxyXG4gICAgICAgIGF0dHJpYnV0ZXM6IFtcInZhbHVlXCIsIGAke29wdGlvbn1gXSxcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIGRpZmZpY3VsdHkuYXBwZW5kKC4uLm9wdGlvbkVsZW1lbnRzKTtcclxuXHJcbiAgICAvLyBGb3JtIEJ1dHRvbnNcclxuICAgIGNvbnN0IGZvcm1CdXR0b25zID0gX19jcmVhdGVGb3JtQnV0dG9ucyh0YXNrKTtcclxuICAgIGZyYWdtZW50LmFwcGVuZCh0aXRsZSwgZGVzY3JpcHRpb24sIGR1ZURhdGUsIGRpZmZpY3VsdHksIGZvcm1CdXR0b25zKTtcclxuXHJcbiAgICByZXR1cm4gZnJhZ21lbnQ7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgX19jcmVhdGVGb3JtQnV0dG9ucyA9ICgpID0+IHtcclxuICAgIGNvbnN0IGRpdiA9IGNyZWF0ZUN1c3RvbUVsZW1lbnQoe1xyXG4gICAgICB0YWdOYW1lOiBcImRpdlwiLFxyXG4gICAgICBjbGFzc0xpc3Q6IFwiZm9ybS1jb250cm9sc1wiLFxyXG4gICAgfSk7XHJcbiAgICBjb25zdCBzdWJtaXRCdG4gPSBjcmVhdGVDdXN0b21FbGVtZW50KHtcclxuICAgICAgdGFnTmFtZTogXCJidXR0b25cIixcclxuICAgICAgY2xhc3NMaXN0OiBcInN1Ym1pdC1idG5cIixcclxuICAgICAgdGV4dENvbnRlbnQ6IFwiU3VibWl0XCIsXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBjYW5jZWxCdG4gPSBjcmVhdGVDdXN0b21FbGVtZW50KHtcclxuICAgICAgdGFnTmFtZTogXCJidXR0b25cIixcclxuICAgICAgY2xhc3NMaXN0OiBcImNhbmNlbC1idG5cIixcclxuICAgICAgdGV4dENvbnRlbnQ6IFwiQ2FuY2VsXCIsXHJcbiAgICB9KTtcclxuICAgIGNhbmNlbEJ0bi5vbmNsaWNrID0gKGUpID0+IGNhbmNlbEZvcm0oZSwgY3VycmVudExpc3QuZ2V0VGFza0J5SWQodGFza0lkKSk7XHJcblxyXG4gICAgZGl2LmFwcGVuZChjYW5jZWxCdG4sIHN1Ym1pdEJ0bik7XHJcbiAgICByZXR1cm4gZGl2O1xyXG4gIH07XHJcblxyXG4gIHJldHVybiB7IGFwcGVuZEVkaXRUYXNrRm9ybSB9O1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVJlbmRlcmVyO1xyXG4iLCJpbXBvcnQge1xyXG4gIGNyZWF0ZU1haW5EZXRhaWxzRWxlbWVudHMsXHJcbiAgY3JlYXRlQm90dG9tUGFuZWxFbGVtZW50cyxcclxufSBmcm9tIFwiLi4vTGlzdC90YXNrL3Rhc2tSZW5kZXJpbmdcIjtcclxuXHJcbmNvbnN0IHN1Ym1pdEZvcm0gPSAoZSwgbGlzdCwgdGFzaykgPT4ge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgY29uc3QgZm9ybSA9IGUudGFyZ2V0O1xyXG4gIGNvbnN0IHRhc2tDb250YWluZXIgPSBmb3JtLnBhcmVudE5vZGU7XHJcbiAgY29uc3QgbWFpbkRldGFpbHMgPSB0YXNrQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1kZXRhaWxzXCIpO1xyXG4gIGNvbnN0IGJvdHRvbVBhbmVsID0gdGFza0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLmJvdHRvbS1wYW5lbFwiKTtcclxuXHJcbiAgY29uc3QgZGF0YSA9IG5ldyBGb3JtRGF0YShmb3JtKTtcclxuICBjb25zdCBvYmogPSB7fTtcclxuICBmb3IgKGNvbnN0IFtuYW1lLCB2YWx1ZV0gb2YgZGF0YSkge1xyXG4gICAgb2JqW25hbWVdID0gdmFsdWU7XHJcbiAgfVxyXG4gIGNvbnN0IHVwZGF0ZWRUYXNrID0gbGlzdC51cGRhdGVUYXNrKHRhc2suaWQsIG9iaik7XHJcblxyXG4gIGZvcm0ucmVtb3ZlKCk7XHJcbiAgY29uc3QgbWFpbkRldGFpbHNFbGVtZW50cyA9IGNyZWF0ZU1haW5EZXRhaWxzRWxlbWVudHModXBkYXRlZFRhc2spO1xyXG4gIG1haW5EZXRhaWxzLmFwcGVuZChtYWluRGV0YWlsc0VsZW1lbnRzKTtcclxuXHJcbiAgYm90dG9tUGFuZWwucmVwbGFjZUNoaWxkcmVuKCk7XHJcbiAgY29uc3QgYm90dG9tUGFuZWxFbGVtZW50cyA9IGNyZWF0ZUJvdHRvbVBhbmVsRWxlbWVudHModXBkYXRlZFRhc2spO1xyXG4gIGJvdHRvbVBhbmVsLmFwcGVuZChib3R0b21QYW5lbEVsZW1lbnRzKTtcclxuXHJcbiAgdGFza0NvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwiaXNFZGl0YWJsZVwiKTtcclxufTtcclxuXHJcbmNvbnN0IGNhbmNlbEZvcm0gPSAoZSwgdGFzaykgPT4ge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgY29uc3QgZm9ybSA9IGUudGFyZ2V0LmNsb3Nlc3QoXCJmb3JtXCIpO1xyXG4gIGNvbnN0IHRhc2tDb250YWluZXIgPSBmb3JtLnBhcmVudE5vZGU7XHJcbiAgY29uc3QgbWFpbkRldGFpbHMgPSB0YXNrQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1kZXRhaWxzXCIpO1xyXG5cclxuICBmb3JtLnJlbW92ZSgpO1xyXG4gIHRhc2tDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcImlzRWRpdGFibGVcIik7XHJcblxyXG4gIGNvbnN0IG1haW5EZXRhaWxzRWxlbWVudHMgPSBjcmVhdGVNYWluRGV0YWlsc0VsZW1lbnRzKHRhc2spO1xyXG4gIG1haW5EZXRhaWxzLmFwcGVuZChtYWluRGV0YWlsc0VsZW1lbnRzKTtcclxufTtcclxuXHJcbmV4cG9ydCB7IHN1Ym1pdEZvcm0sIGNhbmNlbEZvcm0gfTtcclxuIiwiaW1wb3J0IHsgY3JlYXRlQ3VzdG9tRWxlbWVudCB9IGZyb20gXCIuLi9IZWxwZXJzL2N1c3RvbUVsZW1lbnRIZWxwZXIuanNcIjtcclxuaW1wb3J0IFRvb2xiYXJFdmVudEhhbmRsZXIgZnJvbSBcIi4vVG9vbGJhckV2ZW50SGFuZGxlci5qc1wiO1xyXG5cclxuLy8gQ3JlYXRlIHRvb2xiYXIgd2lsbCByZXR1cm4gYSBmcmFnbWVudCBjb250YWluZXIgb2YgdGhyZWUgYnV0dG9uc1xyXG4vL1xyXG5cclxuY29uc3QgVG9vbGJhciA9IChjdXJyZW50TGlzdCwgdGFzaykgPT4ge1xyXG4gIGNvbnN0IGV2ZW50SGFuZGxlciA9IFRvb2xiYXJFdmVudEhhbmRsZXIoY3VycmVudExpc3QsIHRhc2spO1xyXG5cclxuICBjb25zdCB0b29scyA9IFtcclxuICAgIHtcclxuICAgICAgbmFtZTogXCJFZGl0XCIsXHJcbiAgICAgIGltZ1NyYzogXCIuLi9zcmMvaW1ncy9ub3VuLXF1aWxsLTQ2MjY3MTguc3ZnXCIsXHJcbiAgICAgIGNsYXNzTmFtZTogXCJmaWx0ZXItZ3JheVwiLFxyXG4gICAgICBvbkNsaWNrOiAoZSkgPT4gZXZlbnRIYW5kbGVyLnNldEVkaXRNb2RlKGUpLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgbmFtZTogXCJTZXQgUHJpb3JpdHlcIixcclxuICAgICAgaW1nU3JjOiBcIi4uL3NyYy9pbWdzL25vdW4tc3Rhci00NDg1NzQ2LnN2Z1wiLFxyXG4gICAgICBjbGFzc05hbWU6IFwiZmlsdGVyLWdyYXlcIixcclxuICAgICAgb25DbGljazogKGUpID0+IGV2ZW50SGFuZGxlci5zZXRQcmlvcml0eShlKSxcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIG5hbWU6IFwiRGVsZXRlXCIsXHJcbiAgICAgIGltZ1NyYzogXCIuLi9zcmMvaW1ncy9ub3VuLXNrdWxsLTQ0ODU2NzQuc3ZnXCIsXHJcbiAgICAgIGNsYXNzTmFtZTogXCJmaWx0ZXItcmVkXCIsXHJcbiAgICAgIG9uQ2xpY2s6IChlKSA9PiBldmVudEhhbmRsZXIuZGVsZXRlVGFzayhlKSxcclxuICAgIH0sXHJcbiAgXTtcclxuXHJcbiAgY29uc3QgY3JlYXRlVG9vbGJhciA9ICgpID0+IHtcclxuICAgIGNvbnN0IHRvb2xiYXJDb250YWluZXIgPSBjcmVhdGVDdXN0b21FbGVtZW50KHtcclxuICAgICAgdGFnTmFtZTogXCJkaXZcIixcclxuICAgICAgY2xhc3NMaXN0OiBcInRvb2xiYXJcIixcclxuICAgIH0pO1xyXG4gICAgdG9vbGJhckNvbnRhaW5lci5hcHBlbmQoX19jcmVhdGVCdG5zKHRvb2xzKSk7XHJcbiAgICByZXR1cm4gdG9vbGJhckNvbnRhaW5lcjtcclxuICB9O1xyXG4gIGNvbnN0IF9fY3JlYXRlQnRucyA9ICh0b29scykgPT4ge1xyXG4gICAgY29uc3QgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XHJcbiAgICB0b29scy5mb3JFYWNoKCh0b29sKSA9PiB7XHJcbiAgICAgIGNvbnN0IHsgbmFtZSwgaW1nU3JjLCBjbGFzc05hbWUsIG9uQ2xpY2sgfSA9IHRvb2w7XHJcbiAgICAgIC8vIFRvb2xiYXIgd2lsbCBjb25zaXN0IG9mOlxyXG4gICAgICAvLyBFZGl0XHJcbiAgICAgIC8vIFNldCBQcmlvcml0eSAtIGlzUHJpb3JpdHlcclxuICAgICAgLy8gRGVsZXRlXHJcbiAgICAgIGNvbnN0IGJ0biA9IGNyZWF0ZUN1c3RvbUVsZW1lbnQoe1xyXG4gICAgICAgIHRhZ05hbWU6IFwiYnV0dG9uXCIsXHJcbiAgICAgICAgYXR0cmlidXRlczogW1wiYXJpYS1sYWJlbFwiLCBgJHtuYW1lfWBdLFxyXG4gICAgICB9KTtcclxuICAgICAgY29uc3QgaW1nID0gY3JlYXRlQ3VzdG9tRWxlbWVudCh7XHJcbiAgICAgICAgdGFnTmFtZTogXCJpbWdcIixcclxuICAgICAgICBhdHRyaWJ1dGVzOiBbXCJzcmNcIiwgYCR7aW1nU3JjfWBdLFxyXG4gICAgICAgIGNsYXNzTGlzdDogY2xhc3NOYW1lLFxyXG4gICAgICB9KTtcclxuICAgICAgYnRuLm9uY2xpY2sgPSBvbkNsaWNrO1xyXG4gICAgICBidG4uYXBwZW5kKGltZyk7XHJcbiAgICAgIGZyYWdtZW50LmFwcGVuZChidG4pO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gZnJhZ21lbnQ7XHJcbiAgfTtcclxuXHJcbiAgcmV0dXJuIHsgY3JlYXRlVG9vbGJhciB9O1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgVG9vbGJhcjtcclxuIiwiaW1wb3J0IEZvcm1SZW5kZXJlciBmcm9tIFwiLi4vRm9ybS9Gb3JtUmVuZGVyZXJcIjtcclxuXHJcbmNvbnN0IFRvb2xiYXJFdmVudEhhbmRsZXIgPSAoY3VycmVudExpc3QsIHRhc2spID0+IHtcclxuICBjb25zdCBzZXRFZGl0TW9kZSA9IChlKSA9PiB7XHJcbiAgICBjb25zdCB0YXNrRWxlbWVudCA9IGUudGFyZ2V0LmNsb3Nlc3QoXCIudGFza1wiKTtcclxuICAgIC8vIEVzY2FwZSBpZiBhbHJlYWR5IGluIGVkaXQgbW9kZVxyXG4gICAgaWYgKHRhc2tFbGVtZW50LmNsYXNzTGlzdC5jb250YWlucyhcImlzRWRpdGFibGVcIikpIHJldHVybjtcclxuICAgIGNvbnN0IG1haW5EZXRhaWxzID0gdGFza0VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tYWluLWRldGFpbHNcIik7XHJcbiAgICB0YXNrRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiaXNFZGl0YWJsZVwiKTtcclxuXHJcbiAgICAvLyBDbGVhciBhbGwgY2hpbGRyZW4gaW4gbWFpbiBkZXRhaWxzXHJcbiAgICBtYWluRGV0YWlscy5yZXBsYWNlQ2hpbGRyZW4oKTtcclxuXHJcbiAgICBpZiAodGFza0VsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiZXhwYW5kZWRcIikpIHtcclxuICAgICAgdGFza0VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5leHBhbmRlZC1kZXRhaWxzXCIpLnJlbW92ZSgpO1xyXG4gICAgICB0YXNrRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiZXhwYW5kZWRcIik7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgZm9ybVJlbmRlcmVyID0gRm9ybVJlbmRlcmVyKGN1cnJlbnRMaXN0LCB0YXNrLmlkKTtcclxuICAgIGNvbnN0IGVkaXRGb3JtID0gZm9ybVJlbmRlcmVyLmFwcGVuZEVkaXRUYXNrRm9ybSh0YXNrRWxlbWVudCk7XHJcbiAgICBjb25zdCB0ZXh0YXJlYXMgPSBlZGl0Rm9ybS5nZXRFbGVtZW50c0J5VGFnTmFtZShcInRleHRhcmVhXCIpO1xyXG5cclxuICAgIFsuLi50ZXh0YXJlYXNdLmZvckVhY2goKHRleHRhcmVhKSA9PiB7XHJcbiAgICAgIHRleHRhcmVhLmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChlKSA9PiB7XHJcbiAgICAgICAgaWYgKGUua2V5ID09PSBcIkVudGVyXCIgJiYgIWUuc2hpZnRLZXkpIHtcclxuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgIC8vIFByb2dyYW1hdGljYWxseSB0cmlnZ2VyIGZvcm0gc3VibWlzc2lvblxyXG4gICAgICAgICAgY29uc3Qgc3VibWl0RXZlbnQgPSBuZXcgRXZlbnQoXCJzdWJtaXRcIiwge1xyXG4gICAgICAgICAgICBidWJibGVzOiB0cnVlLFxyXG4gICAgICAgICAgICBjYW5jZWxhYmxlOiB0cnVlLFxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBlZGl0Rm9ybS5kaXNwYXRjaEV2ZW50KHN1Ym1pdEV2ZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICAvLyBlZGl0Rm9ybVxyXG4gICAgLy8gICAuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJ0ZXh0YXJlYVwiKVxyXG4gICAgLy8gICAuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgc3VibWl0Rm9ybSk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3Qgc2V0UHJpb3JpdHkgPSAoZSkgPT4ge1xyXG4gICAgY29uc3QgY3VycmVudFRhc2sgPSBjdXJyZW50TGlzdC5nZXRUYXNrQnlJZCh0YXNrLmlkKTtcclxuICAgIGlmIChjdXJyZW50VGFzay5wcmlvcml0eSkge1xyXG4gICAgICBjdXJyZW50TGlzdC51cGRhdGVUYXNrKHRhc2suaWQsIHsgcHJpb3JpdHk6IGZhbHNlIH0pO1xyXG4gICAgICBlLnRhcmdldC5jbG9zZXN0KFwiaW1nXCIpLnNyYyA9IFwiLi4vc3JjL2ltZ3Mvbm91bi1zdGFyLTQ0ODU3NDYuc3ZnXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjdXJyZW50TGlzdC51cGRhdGVUYXNrKHRhc2suaWQsIHsgcHJpb3JpdHk6IHRydWUgfSk7XHJcbiAgICAgIGUudGFyZ2V0LmNsb3Nlc3QoXCJpbWdcIikuc3JjID0gXCIuLi9zcmMvaW1ncy9ub3VuLXN0YXItNDQ4NTgyNy5zdmdcIjtcclxuICAgIH1cclxuICAgIGUudGFyZ2V0LmNsb3Nlc3QoXCIudGFza1wiKS5jbGFzc0xpc3QudG9nZ2xlKFwiaXNQcmlvcml0eVwiKTtcclxuICAgIGUudGFyZ2V0LmNsb3Nlc3QoXCJpbWdcIikuY2xhc3NMaXN0LnRvZ2dsZShcImZpbHRlci1ncmF5XCIpO1xyXG4gICAgZS50YXJnZXQuY2xvc2VzdChcImltZ1wiKS5jbGFzc0xpc3QudG9nZ2xlKFwiZmlsdGVyLXllbGxvd1wiKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBkZWxldGVUYXNrID0gKGUpID0+IHtcclxuICAgIGN1cnJlbnRMaXN0LnJlbW92ZVRhc2sodGFzay5pZCk7XHJcbiAgICBlLnRhcmdldC5jbG9zZXN0KFwiLnRhc2tcIikucmVtb3ZlKCk7XHJcbiAgfTtcclxuXHJcbiAgcmV0dXJuIHsgc2V0RWRpdE1vZGUsIHNldFByaW9yaXR5LCBkZWxldGVUYXNrIH07XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBUb29sYmFyRXZlbnRIYW5kbGVyO1xyXG4iLCJjb25zdCBwdWJTdWIgPSAoKCkgPT4ge1xyXG4gIGNvbnN0IGV2ZW50cyA9IHt9O1xyXG5cclxuICBjb25zdCBnZXRFdmVudHMgPSAoKSA9PiBldmVudHM7XHJcblxyXG4gIGNvbnN0IHN1YnNjcmliZSA9IChldmVudCwgY2FsbGJhY2spID0+IHtcclxuICAgIGNvbnNvbGUubG9nKFwic3ViYmluZ1wiKTtcclxuICAgIGxldCBpbmRleDtcclxuXHJcbiAgICBpZiAoIWV2ZW50cy5oYXNPd25Qcm9wZXJ0eShldmVudCkpIHtcclxuICAgICAgZXZlbnRzW2V2ZW50XSA9IFtdO1xyXG4gICAgfVxyXG5cclxuICAgIGluZGV4ID0gZXZlbnRzW2V2ZW50XS5wdXNoKGNhbGxiYWNrKSAtIDE7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdW5zdWJzY3JpYmUoKSB7XHJcbiAgICAgICAgZXZlbnRzW2V2ZW50XS5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICB9LFxyXG4gICAgfTtcclxuICB9O1xyXG5cclxuICBjb25zdCBwdWJsaXNoID0gKGV2ZW50LCBkYXRhID0ge30pID0+IHtcclxuICAgIGNvbnNvbGUubG9nKFwicHViYmluZ1wiKTtcclxuICAgIGlmICghZXZlbnRzLmhhc093blByb3BlcnR5KGV2ZW50KSkge1xyXG4gICAgICByZXR1cm4gW107XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGV2ZW50c1tldmVudF0ubWFwKChjYWxsYmFjaykgPT4gY2FsbGJhY2soZGF0YSkpO1xyXG4gIH07XHJcblxyXG4gIHJldHVybiB7IGdldEV2ZW50cywgc3Vic2NyaWJlLCBwdWJsaXNoIH07XHJcbn0pKCk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBwdWJTdWI7XHJcbiIsImltcG9ydCB7IGVkaXRUYXNrLCB0b2dnbGVEZXRhaWxzIH0gZnJvbSBcIi4uLy4uL0V2ZW50SGFuZGxlci5qc1wiO1xyXG5pbXBvcnQgeyBjcmVhdGVDdXN0b21FbGVtZW50IH0gZnJvbSBcIi4uLy4uL0hlbHBlcnMvY3VzdG9tRWxlbWVudEhlbHBlci5qc1wiO1xyXG5pbXBvcnQgZm9ybWF0RGF0ZSBmcm9tIFwiLi4vLi4vSGVscGVycy9mb3JtYXREYXRlSGVscGVyLmpzXCI7XHJcbmltcG9ydCBUb29sYmFyIGZyb20gXCIuLi8uLi9Ub29sYmFyL1Rvb2xiYXIuanNcIjtcclxuaW1wb3J0IHB1YlN1YiBmcm9tIFwiLi4vLi4vcHVic3ViLmpzXCI7XHJcblxyXG5wdWJTdWIuc3Vic2NyaWJlKFwidGFza0NyZWF0ZWRcIiwgcmVuZGVyVGFzayk7XHJcblxyXG5mdW5jdGlvbiByZW5kZXJUYXNrKGRhdGEpIHtcclxuICBjb25zdCB7IGxpc3QsIHRhc2sgfSA9IGRhdGE7XHJcbiAgX19hcHBlbmRUYXNrRWxlbWVudHMobGlzdCwgdGFzayk7XHJcbn1cclxuXHJcbmNvbnN0IF9fYXBwZW5kVGFza0VsZW1lbnRzID0gKGxpc3QsIHRhc2spID0+IHtcclxuICBjb25zdCBsaXN0Q29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2RhdGEtaWQ9XCIke2xpc3QuZ2V0SWQoKX1cIl1gKTtcclxuICBjb25zdCB0YXNrc0NvbnRhaW5lciA9IGxpc3RDb250YWluZXIucXVlcnlTZWxlY3RvcihcIi50YXNrcy1jb250YWluZXJcIik7XHJcblxyXG4gIGNvbnN0IHRhc2tFbGVtZW50cyA9IF9fY3JlYXRlVGFza0VsZW1lbnRzKGxpc3QsIHRhc2spO1xyXG4gIHRhc2tzQ29udGFpbmVyLnByZXBlbmQodGFza0VsZW1lbnRzKTtcclxufTtcclxuXHJcbmNvbnN0IF9fY3JlYXRlVGFza0VsZW1lbnRzID0gKGN1cnJlbnRMaXN0LCB0YXNrKSA9PiB7XHJcbiAgLy8gRGl2IGNvbnRhaW5lclxyXG4gIGNvbnN0IHRhc2tDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gIHRhc2tDb250YWluZXIuY2xhc3NOYW1lID0gXCJ0YXNrXCI7XHJcbiAgdGFza0NvbnRhaW5lci5kYXRhc2V0LmlkID0gdGFzay5pZDtcclxuXHJcbiAgLy8gVG9vbGJhclxyXG4gIGNvbnN0IHRvb2xiYXJDcmVhdG9yID0gVG9vbGJhcihjdXJyZW50TGlzdCwgdGFzayk7XHJcbiAgY29uc3QgdG9vbGJhciA9IHRvb2xiYXJDcmVhdG9yLmNyZWF0ZVRvb2xiYXIoY3VycmVudExpc3QsIHRhc2tDb250YWluZXIpO1xyXG5cclxuICAvLyBNYWluIGRldGFpbHNcclxuICBjb25zdCBtYWluRGV0YWlscyA9IF9fcmVuZGVyTWFpbkRldGFpbHModGFzayk7XHJcblxyXG4gIC8vIEJvdHRvbSBQYW5lbFxyXG4gIGNvbnN0IGJvdHRvbVBhbmVsID0gX19yZW5kZXJCb3R0b21QYW5lbChjdXJyZW50TGlzdCwgdGFzay5pZCk7XHJcblxyXG4gIHRhc2tDb250YWluZXIuYXBwZW5kKHRvb2xiYXIpO1xyXG4gIHRhc2tDb250YWluZXIuYXBwZW5kKG1haW5EZXRhaWxzKTtcclxuICB0YXNrQ29udGFpbmVyLmFwcGVuZChib3R0b21QYW5lbCk7XHJcblxyXG4gIC8vIEFkZCBvbmNsaWNrIHRvIGNoYW5nZSBlbGVtZW50IHRvIGlucHV0IG9uIGNsaWNrXHJcbiAgdGFza0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwiZGJsY2xpY2tcIiwgKGUpID0+IHtcclxuICAgIGVkaXRUYXNrKGUsIHRhc2suaWQsIGN1cnJlbnRMaXN0KTtcclxuICB9KTtcclxuXHJcbiAgdGFza0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgIHRvZ2dsZURldGFpbHMoZSwgY3VycmVudExpc3QsIHRhc2suaWQpO1xyXG4gIH0pO1xyXG5cclxuICB0YXNrQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW92ZXJcIiwgKCkgPT4ge1xyXG4gICAgdG9vbGJhci5zdHlsZS5vcGFjaXR5ID0gXCIxXCI7XHJcbiAgICB0b29sYmFyLnN0eWxlLnZpc2liaWxpdHkgPSBcInZpc2libGVcIjtcclxuICB9KTtcclxuXHJcbiAgdGFza0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdXRcIiwgKCkgPT4ge1xyXG4gICAgdG9vbGJhci5zdHlsZS5vcGFjaXR5ID0gXCIwXCI7XHJcbiAgICB0b29sYmFyLnN0eWxlLnZpc2liaWxpdHkgPSBcImhpZGRlblwiO1xyXG4gIH0pO1xyXG5cclxuICAvLyB0b29sYmFyLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW92ZXJcIiwgKGUpID0+IHtcclxuICAvLyAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgLy8gICB0b29sYmFyLnN0eWxlLm9wYWNpdHkgPSBcIjFcIjtcclxuICAvLyAgIHRvb2xiYXIuc3R5bGUudmlzaWJpbGl0eSA9IFwidmlzaWJsZVwiO1xyXG4gIC8vIH0pO1xyXG5cclxuICByZXR1cm4gdGFza0NvbnRhaW5lcjtcclxufTtcclxuXHJcbmNvbnN0IF9fcmVuZGVyTWFpbkRldGFpbHMgPSAodGFzaykgPT4ge1xyXG4gIGNvbnN0IG1haW5EZXRhaWxzQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICBtYWluRGV0YWlsc0NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwibWFpbi1kZXRhaWxzXCIpO1xyXG4gIG1haW5EZXRhaWxzQ29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZU1haW5EZXRhaWxzRWxlbWVudHModGFzaykpO1xyXG4gIHJldHVybiBtYWluRGV0YWlsc0NvbnRhaW5lcjtcclxufTtcclxuXHJcbmNvbnN0IGNyZWF0ZU1haW5EZXRhaWxzRWxlbWVudHMgPSAodGFzaykgPT4ge1xyXG4gIGNvbnN0IGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xyXG5cclxuICBjb25zdCB0aXRsZSA9IGNyZWF0ZUN1c3RvbUVsZW1lbnQoe1xyXG4gICAgdGFnTmFtZTogXCJwXCIsXHJcbiAgICBjbGFzc0xpc3Q6IFwidGFzay10aXRsZVwiLFxyXG4gICAgdGV4dENvbnRlbnQ6IHRhc2sudGl0bGUsXHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IGRlc2NyaXB0aW9uID0gdGFzay5kZXNjcmlwdGlvblxyXG4gICAgPyBjcmVhdGVDdXN0b21FbGVtZW50KHtcclxuICAgICAgICB0YWdOYW1lOiBcInBcIixcclxuICAgICAgICBjbGFzc0xpc3Q6IFwidGFzay1kZXNjcmlwdGlvblwiLFxyXG4gICAgICAgIHRleHRDb250ZW50OiB0YXNrLmRlc2NyaXB0aW9uLFxyXG4gICAgICB9KVxyXG4gICAgOiBcIiBcIjtcclxuXHJcbiAgZnJhZ21lbnQuYXBwZW5kKHRpdGxlLCBkZXNjcmlwdGlvbik7XHJcbiAgcmV0dXJuIGZyYWdtZW50O1xyXG59O1xyXG5cclxuY29uc3QgcmVuZGVyRXhwYW5kZWRUYXNrID0gKHRhcmdldCwgdGFzaykgPT4ge1xyXG4gIGNvbnN0IGV4cGFuZGVkVGFzayA9IF9fY3JlYXRlRXhwYW5kZWRUYXNrKHRhc2spO1xyXG4gIHRhcmdldC5hZnRlcihleHBhbmRlZFRhc2spO1xyXG4gIHJldHVybiBleHBhbmRlZFRhc2s7XHJcbn07XHJcblxyXG5jb25zdCBfX2NyZWF0ZUV4cGFuZGVkVGFzayA9ICh0YXNrKSA9PiB7XHJcbiAgY29uc3QgeyBkdWVEYXRlLCBkaWZmaWN1bHR5IH0gPSB0YXNrO1xyXG4gIGNvbnN0IGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xyXG4gIC8vIEFwcGVuZCBjaGlsZHJlbiB0byBmcmFnbWVudFxyXG4gIGNvbnN0IGV4cGFuZGVkRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAvLyBTZXQgdG9nZ2xlIGF0dHJpYnV0ZSB0byB3b3JrIHdpdGggdG9nZ2xlIGV2ZW50IGxpc3RlbmVyXHJcbiAgZXhwYW5kZWREaXYuY2xhc3NMaXN0LmFkZChcImV4cGFuZGVkLWRldGFpbHNcIik7XHJcbiAgZnJhZ21lbnQuYXBwZW5kKGV4cGFuZGVkRGl2KTtcclxuXHJcbiAgLy8gZHVlRGF0ZSAmJlxyXG4gIGV4cGFuZGVkRGl2LmFwcGVuZChcclxuICAgIGNyZWF0ZUN1c3RvbUVsZW1lbnQoe1xyXG4gICAgICB0YWdOYW1lOiBcInBcIixcclxuICAgICAgY2xhc3NMaXN0OiBcImR1ZS1kYXRlXCIsXHJcbiAgICAgIHRleHRDb250ZW50OiBmb3JtYXREYXRlKGR1ZURhdGUpLFxyXG4gICAgfSlcclxuICApO1xyXG4gIGNvbnNvbGUubG9nKGR1ZURhdGUpO1xyXG5cclxuICAvLyBkaWZmaWN1bHR5ICYmXHJcbiAgZXhwYW5kZWREaXYuYXBwZW5kKFxyXG4gICAgY3JlYXRlQ3VzdG9tRWxlbWVudCh7XHJcbiAgICAgIHRhZ05hbWU6IFwicFwiLFxyXG4gICAgICBjbGFzc0xpc3Q6IFwiZGlmZmljdWx0eVwiLFxyXG4gICAgICB0ZXh0Q29udGVudDogZGlmZmljdWx0eSxcclxuICAgIH0pXHJcbiAgKTtcclxuICByZXR1cm4gZnJhZ21lbnQ7XHJcbn07XHJcblxyXG5jb25zdCBfX3JlbmRlckJvdHRvbVBhbmVsID0gKGN1cnJlbnRMaXN0LCB0YXNrSWQpID0+IHtcclxuICBjb25zdCB0YXNrID0gY3VycmVudExpc3QuZ2V0VGFza0J5SWQodGFza0lkKTtcclxuICBjb25zdCBib3R0b21QYW5lbCA9IGNyZWF0ZUN1c3RvbUVsZW1lbnQoe1xyXG4gICAgdGFnTmFtZTogXCJkaXZcIixcclxuICAgIGNsYXNzTGlzdDogXCJib3R0b20tcGFuZWxcIixcclxuICB9KTtcclxuICBib3R0b21QYW5lbC5hcHBlbmQoY3JlYXRlQm90dG9tUGFuZWxFbGVtZW50cyh0YXNrKSk7XHJcbiAgcmV0dXJuIGJvdHRvbVBhbmVsO1xyXG59O1xyXG5cclxuY29uc3QgY3JlYXRlQm90dG9tUGFuZWxFbGVtZW50cyA9ICh0YXNrKSA9PiB7XHJcbiAgY29uc3QgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XHJcblxyXG4gIGNvbnN0IGdldFRhc2tEaWZmaWN1bHR5ID0gKGRpZmZpY3VsdHkpID0+IHtcclxuICAgIHN3aXRjaCAoZGlmZmljdWx0eSkge1xyXG4gICAgICBjYXNlIFwiRWFzeVwiOlxyXG4gICAgICAgIHJldHVybiBcIuKalO+4j1wiO1xyXG4gICAgICBjYXNlIFwiTWVkaXVtXCI6XHJcbiAgICAgICAgcmV0dXJuIFwi4pqU77iP4pqU77iPXCI7XHJcbiAgICAgIGNhc2UgXCJIYXJkXCI6XHJcbiAgICAgICAgcmV0dXJuIFwi4pqU77iP4pqU77iP4pqU77iPXCI7XHJcbiAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgcmV0dXJuIFwiXCI7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgZGlmZmljdWx0eUVsID0gY3JlYXRlQ3VzdG9tRWxlbWVudCh7XHJcbiAgICB0YWdOYW1lOiBcInBcIixcclxuICAgIHRleHRDb250ZW50OiBnZXRUYXNrRGlmZmljdWx0eSh0YXNrLmRpZmZpY3VsdHkpLFxyXG4gIH0pO1xyXG5cclxuICBjb25zdCBkdWVEYXRlRWwgPSBjcmVhdGVDdXN0b21FbGVtZW50KHtcclxuICAgIHRhZ05hbWU6IFwicFwiLFxyXG4gICAgdGV4dENvbnRlbnQ6IGZvcm1hdERhdGUodGFzay5kdWVEYXRlKSB8fCBcIlwiLFxyXG4gIH0pO1xyXG5cclxuICBmcmFnbWVudC5hcHBlbmQoZHVlRGF0ZUVsLCBkaWZmaWN1bHR5RWwpO1xyXG4gIHJldHVybiBmcmFnbWVudDtcclxufTtcclxuXHJcbmV4cG9ydCB7XHJcbiAgcmVuZGVyRXhwYW5kZWRUYXNrLFxyXG4gIGNyZWF0ZU1haW5EZXRhaWxzRWxlbWVudHMsXHJcbiAgY3JlYXRlQm90dG9tUGFuZWxFbGVtZW50cyxcclxufTtcclxuIiwiaW1wb3J0IHsgcmVuZGVyRXhwYW5kZWRUYXNrIH0gZnJvbSBcIi4vTGlzdC90YXNrL3Rhc2tSZW5kZXJpbmcuanNcIjtcclxuaW1wb3J0IHB1YnN1YiBmcm9tIFwiLi9wdWJzdWIuanNcIjtcclxuXHJcbmNvbnN0IGNyZWF0ZUxpc3QgPSAoZSwgY3VycmVudFByb2plY3QpID0+IHtcclxuICBpZiAoZS5rZXkgPT09IFwiRW50ZXJcIikge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgY29uc3QgdGl0bGUgPSBlLnRhcmdldC52YWx1ZTtcclxuICAgIGNvbnN0IG5ld0xpc3QgPSBjdXJyZW50UHJvamVjdC5jcmVhdGVMaXN0KHRpdGxlKTtcclxuICAgIGUudGFyZ2V0LnZhbHVlID0gXCJcIjtcclxuXHJcbiAgICBwdWJzdWIucHVibGlzaChcImxpc3RDcmVhdGVkXCIsIG5ld0xpc3QpO1xyXG4gIH1cclxufTtcclxuXHJcbmNvbnN0IGNyZWF0ZVRhc2sgPSAoZSwgbGlzdCkgPT4ge1xyXG4gIGlmIChlLmtleSA9PT0gXCJFbnRlclwiKSB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBjb25zdCB0aXRsZSA9IGUudGFyZ2V0LnZhbHVlO1xyXG4gICAgY29uc3QgbmV3VGFzayA9IGxpc3QuY3JlYXRlVGFzayh0aXRsZSk7XHJcblxyXG4gICAgZS50YXJnZXQudmFsdWUgPSBcIlwiO1xyXG5cclxuICAgIHB1YnN1Yi5wdWJsaXNoKFwidGFza0NyZWF0ZWRcIiwgeyBsaXN0LCB0YXNrOiBuZXdUYXNrIH0pO1xyXG4gIH1cclxufTtcclxuXHJcbi8vIFJlZmFjdG9yIHRoaXMgbWVzcyBsYXRlclxyXG5mdW5jdGlvbiBhdXRvUmVzaXplKCkge1xyXG4gIHRoaXMuc3R5bGUuaGVpZ2h0ID0gXCJhdXRvXCI7XHJcbiAgdGhpcy5zdHlsZS5oZWlnaHQgPSB0aGlzLnNjcm9sbEhlaWdodCArIFwicHhcIjtcclxufVxyXG5cclxuY29uc3QgZWRpdFRhc2sgPSAoZSwgdGFza0lkLCBjdXJyZW50TGlzdCkgPT4ge1xyXG4gIGNvbnN0IGVsID0gZS50YXJnZXQ7XHJcbiAgaWYgKCFlbC5jbGFzc0xpc3QuY29udGFpbnMoXCJ0YXNrLXRpdGxlXCIpKSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIGNvbnN0IHByZXZpb3VzID0gZWwuY2xvbmVOb2RlKHRydWUpO1xyXG4gIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRleHRhcmVhXCIpO1xyXG4gIGNvbnN0IGN1cnJlbnRUYXNrID0gY3VycmVudExpc3QuZ2V0VGFza0J5SWQodGFza0lkKTtcclxuXHJcbiAgaW5wdXQuY2xhc3NMaXN0LmFkZChcInRlbXAtaW5wdXRcIik7XHJcbiAgaW5wdXQudmFsdWUgPSBjdXJyZW50VGFzay50aXRsZTtcclxuICAvLyBpbnB1dC5zdHlsZS53cmFwID0gXCJzb2Z0XCI7XHJcbiAgaW5wdXQuc3R5bGUud29yZEJyZWFrID0gXCJicmVhay13b3JkXCI7XHJcblxyXG4gIGVsLnJlcGxhY2VXaXRoKGlucHV0KTtcclxuICBpbnB1dC5zdHlsZS5oZWlnaHQgPSBcImF1dG9cIjtcclxuICBpbnB1dC5zdHlsZS5oZWlnaHQgPSBpbnB1dC5zY3JvbGxIZWlnaHQgKyBcInB4XCI7XHJcblxyXG4gIGNvbnN0IHNhdmUgPSAoKSA9PiB7XHJcbiAgICAvLyBTYXZlIHRoZSBpbnB1dCB2YWx1ZSBpbnRvIHRoZSBzZWxlY3RlZCB0YXNrXHJcbiAgICBjdXJyZW50TGlzdC51cGRhdGVUYXNrKHRhc2tJZCwgeyB0aXRsZTogaW5wdXQudmFsdWUgfSk7XHJcbiAgICBwcmV2aW91cy50ZXh0Q29udGVudCA9IGlucHV0LnZhbHVlO1xyXG4gICAgaW5wdXQucmVwbGFjZVdpdGgocHJldmlvdXMpO1xyXG4gIH07XHJcblxyXG4gIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChlKSA9PiB7XHJcbiAgICBpZiAoZS5rZXkgPT09IFwiRW50ZXJcIikge1xyXG4gICAgICBpbnB1dC5ibHVyKCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIHNhdmUsIHtcclxuICAgIG9uY2U6IHRydWUsXHJcbiAgfSk7XHJcblxyXG4gIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBhdXRvUmVzaXplLCBmYWxzZSk7XHJcbiAgaW5wdXQuZm9jdXMoKTtcclxufTtcclxuXHJcbmNvbnN0IHRvZ2dsZURldGFpbHMgPSAoZSwgY3VycmVudExpc3QsIHRhc2tJZCkgPT4ge1xyXG4gIGlmIChcclxuICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcImlzRWRpdGFibGVcIikgfHxcclxuICAgICFlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJ0YXNrXCIpXHJcbiAgKSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBjb25zdCB0YXNrQ29udGFpbmVyID0gZS50YXJnZXQ7XHJcbiAgY29uc3QgbWFpbkRldGFpbHMgPSB0YXNrQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1kZXRhaWxzXCIpO1xyXG5cclxuICBjb25zdCBleHBhbmRlZERldGFpbHMgPSB0YXNrQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIuZXhwYW5kZWQtZGV0YWlsc1wiKTtcclxuICBpZiAodGFza0NvbnRhaW5lci5jbGFzc0xpc3QuY29udGFpbnMoXCJpc0VkaXRhYmxlXCIpKSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBpZiAoIWV4cGFuZGVkRGV0YWlscykge1xyXG4gICAgY29uc3QgdGFzayA9IGN1cnJlbnRMaXN0LmdldFRhc2tCeUlkKHRhc2tJZCk7XHJcbiAgICByZW5kZXJFeHBhbmRlZFRhc2sobWFpbkRldGFpbHMsIHRhc2spO1xyXG4gICAgdGFza0NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiZXhwYW5kZWRcIik7XHJcbiAgfSBlbHNlIHtcclxuICAgIGV4cGFuZGVkRGV0YWlscy5yZW1vdmUoKTtcclxuICAgIHRhc2tDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcImV4cGFuZGVkXCIpO1xyXG4gIH1cclxufTtcclxuXHJcbmV4cG9ydCB7IGNyZWF0ZUxpc3QsIGNyZWF0ZVRhc2ssIGVkaXRUYXNrLCB0b2dnbGVEZXRhaWxzIH07XHJcbiIsImltcG9ydCB7XHJcbiAgYXBwZW5kQ3VzdG9tRWxlbWVudCxcclxuICBjcmVhdGVDdXN0b21FbGVtZW50LFxyXG59IGZyb20gXCIuLi9IZWxwZXJzL2N1c3RvbUVsZW1lbnRIZWxwZXIuanNcIjtcclxuaW1wb3J0IHsgY3JlYXRlVGFzayB9IGZyb20gXCIuLi9FdmVudEhhbmRsZXIuanNcIjtcclxuaW1wb3J0IHB1YlN1YiBmcm9tIFwiLi4vcHVic3ViLmpzXCI7XHJcblxyXG5wdWJTdWIuc3Vic2NyaWJlKFwibGlzdENyZWF0ZWRcIiwgcmVuZGVyTGlzdCk7XHJcblxyXG5mdW5jdGlvbiByZW5kZXJMaXN0KGxpc3QpIHtcclxuICAvLyBMaXN0IEVsZW1lbnRzXHJcbiAgX19hcHBlbmRMaXN0Q29udGFpbmVyKGxpc3QpO1xyXG4gIF9fYXBwZW5kTGlzdEFuZFRpdGxlRWxlbWVudHMobGlzdCk7XHJcblxyXG4gIC8vIFRhc2sgRWxlbWVudFxyXG4gIF9fYXBwZW5kVGFza0NvbnRhaW5lcihsaXN0KTtcclxufVxyXG5cclxuY29uc3QgX19hcHBlbmRMaXN0Q29udGFpbmVyID0gKGxpc3QpID0+IHtcclxuICBhcHBlbmRDdXN0b21FbGVtZW50KHtcclxuICAgIHRhcmdldDogXCIubGlzdHMtY29udGFpbmVyXCIsXHJcbiAgICB0YWdOYW1lOiBcImRpdlwiLFxyXG4gICAgY2xhc3NMaXN0OiBbXCJsaXN0XCJdLFxyXG4gICAgYXR0cmlidXRlczogW1wiZGF0YS1pZFwiLCBsaXN0LmdldElkKCldLFxyXG4gIH0pO1xyXG59O1xyXG5cclxuY29uc3QgX19hcHBlbmRMaXN0QW5kVGl0bGVFbGVtZW50cyA9IChsaXN0KSA9PiB7XHJcbiAgY29uc3QgbGlzdEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGBbZGF0YS1pZD1cIiR7bGlzdC5nZXRJZCgpfVwiXWApO1xyXG4gIGFwcGVuZEN1c3RvbUVsZW1lbnQoe1xyXG4gICAgdGFyZ2V0OiBgW2RhdGEtaWQ9XCIke2xpc3QuZ2V0SWQoKX1cIl1gLFxyXG4gICAgdGFnTmFtZTogXCJoMlwiLFxyXG4gICAgdGV4dENvbnRlbnQ6IGxpc3QuZ2V0VGl0bGUoKSxcclxuICB9KTtcclxuICBsaXN0RWxlbWVudC5hcHBlbmRDaGlsZChfX2NyZWF0ZVRhc2tGb3JtKGxpc3QpKTtcclxufTtcclxuXHJcbmNvbnN0IF9fY3JlYXRlVGFza0Zvcm0gPSAobGlzdCkgPT4ge1xyXG4gIC8vIENyZWF0ZSBmb3JtIGFuZCBhcHBlbmQgaW5wdXQgdG8gTGlzdFxyXG4gIGNvbnN0IHRhc2tGb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImZvcm1cIik7XHJcbiAgdGFza0Zvcm0uY2xhc3NOYW1lID0gXCJ0YXNrLWZvcm1cIjtcclxuICBjb25zdCB0YXNrSW5wdXQgPSBjcmVhdGVDdXN0b21FbGVtZW50KHtcclxuICAgIHRhZ05hbWU6IFwiaW5wdXRcIixcclxuICAgIGNsYXNzTGlzdDogXCJ0YXNrLWlucHV0XCIsXHJcbiAgICBhdHRyaWJ1dGVzOiBbXCJwbGFjZWhvbGRlclwiLCBcIkFkZCBhIHRhc2tcIl0sXHJcbiAgfSk7XHJcbiAgdGFza0Zvcm0uYXBwZW5kQ2hpbGQodGFza0lucHV0KTtcclxuXHJcbiAgLy8gQmluZCBpbnB1dCBsaXN0ZW5lciB0byBtb25pdG9yIG5ldyB0YXNrIGVudHJpZXNcclxuICB0YXNrSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgKGUpID0+IHtcclxuICAgIGNyZWF0ZVRhc2soZSwgbGlzdCk7XHJcbiAgfSk7XHJcbiAgcmV0dXJuIHRhc2tGb3JtO1xyXG59O1xyXG5cclxuY29uc3QgX19hcHBlbmRUYXNrQ29udGFpbmVyID0gKGxpc3QpID0+IHtcclxuICBhcHBlbmRDdXN0b21FbGVtZW50KHtcclxuICAgIHRhcmdldDogYFtkYXRhLWlkPVwiJHtsaXN0LmdldElkKCl9XCJdYCxcclxuICAgIHRhZ05hbWU6IFwiZGl2XCIsXHJcbiAgICBjbGFzc0xpc3Q6IFwidGFza3MtY29udGFpbmVyXCIsXHJcbiAgfSk7XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCByZW5kZXJMaXN0O1xyXG4iLCJpbXBvcnQgcmVuZGVyTGlzdCBmcm9tIFwiLi9MaXN0UmVuZGVyZXIuanNcIjtcclxuaW1wb3J0IHB1YlN1YiBmcm9tIFwiLi4vcHVic3ViLmpzXCI7XHJcblxyXG4vKlxyXG4gIEZsb3c6XHJcbiAgUmV0cmlldmUgbG9jYWxTdG9yYWdlXHJcbiAgSWYgbm8gc3RvcmFnZSBpcyBhdmFpbGFibGUsIHRoZW4gY3JlYXRlIHRoZSBkZWZhdWx0IGxpc3QuXHJcbiAgRWxzZSwgcmVuZGVyIHRoZSBzdG9yZWQgTGlzdC5cclxuICAgIFRoZW4sIHJlbmRlciB0aGUgc3RvcmVkIHRhc2tzIGlmIHRoZXJlIGFyZSB0YXNrc1xyXG5cclxuKi9cclxuXHJcbmNvbnN0IExpc3RIYW5kbGVyID0gKCkgPT4ge1xyXG4gIGNvbnN0IGNyZWF0ZURlZmF1bHRMaXN0ID0gKGN1cnJlbnRQcm9qZWN0KSA9PiB7XHJcbiAgICBjb25zdCBoYWJpdExpc3QgPSBjdXJyZW50UHJvamVjdC5jcmVhdGVMaXN0KFwiSGFiaXRzXCIpO1xyXG4gICAgY29uc3QgZmlyc3RUYXNrID0gaGFiaXRMaXN0LmNyZWF0ZVRhc2soXCJDcmVhdGUgeW91ciBmaXJzdCBoYWJpdCFcIik7XHJcbiAgICBwdWJTdWIucHVibGlzaChcImxpc3RDcmVhdGVkXCIsIGhhYml0TGlzdCk7XHJcbiAgICBwdWJTdWIucHVibGlzaChcInRhc2tDcmVhdGVkXCIsIHsgbGlzdDogaGFiaXRMaXN0LCB0YXNrOiBmaXJzdFRhc2sgfSk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgY2hlY2tGb3JMaXN0cyA9IChjdXJyZW50UHJvamVjdCkgPT4ge1xyXG4gICAgY29uc3QgbGlzdHMgPSBjdXJyZW50UHJvamVjdC5nZXRMaXN0cygpO1xyXG4gICAgaWYgKGxpc3RzLmxlbmd0aCkge1xyXG4gICAgICAvLyBUaGlzIGlzIHJlbmRlcmluZyBldmVyeSB0YXNrIHdpdGhpbiB0aGUgbGlzdCByaWdodCBub3cgZXZlbiBpZiB0aGVyZSBhcmUgbm9uZS5cclxuICAgICAgbGlzdHMuZm9yRWFjaCgobGlzdCkgPT4gcmVuZGVyTGlzdChsaXN0KSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjcmVhdGVEZWZhdWx0TGlzdChjdXJyZW50UHJvamVjdCk7XHJcbiAgICB9XHJcbiAgfTtcclxuICByZXR1cm4geyBjaGVja0Zvckxpc3RzIH07XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgeyBjaGVja0Zvckxpc3RzIH0gPSBMaXN0SGFuZGxlcigpO1xyXG4iLCJjb25zdCBzdG9yZSA9ICgoKSA9PiB7XHJcbiAgY29uc3QgcHJvamVjdHMgPSBbXTtcclxuICBjb25zdCBnZXRQcm9qZWN0cyA9ICgpID0+IHByb2plY3RzO1xyXG4gIGNvbnN0IGFkZFByb2plY3QgPSAocHJvamVjdCkgPT4gcHJvamVjdHMucHVzaChwcm9qZWN0KTtcclxuICByZXR1cm4geyBnZXRQcm9qZWN0cywgYWRkUHJvamVjdCB9O1xyXG59KSgpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgc3RvcmU7XHJcbiIsImltcG9ydCBQcm9qZWN0IGZyb20gXCIuL1Byb2plY3QuanNcIjtcclxuaW1wb3J0IHsgY2hlY2tGb3JMaXN0cyB9IGZyb20gXCIuL0xpc3QvTGlzdEhhbmRsZXIuanNcIjtcclxuaW1wb3J0IHsgY3JlYXRlTGlzdCB9IGZyb20gXCIuL0V2ZW50SGFuZGxlci5qc1wiO1xyXG5pbXBvcnQgc3RvcmUgZnJvbSBcIi4vc3RvcmUuanNcIjtcclxuXHJcbnN0b3JlLmFkZFByb2plY3QoUHJvamVjdChcIkRlZmF1bHRcIikpO1xyXG5jb25zdCBjdXJyZW50UHJvamVjdCA9IHN0b3JlLmdldFByb2plY3RzKClbMF07XHJcblxyXG5jb25zdCBVc2VySW50ZXJmYWNlID0gKCgpID0+IHtcclxuICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbGlzdC1pbnB1dFwiKTtcclxuXHJcbiAgY29uc3QgaW5pdCA9ICgpID0+IHtcclxuICAgIGNoZWNrRm9yTGlzdHMoY3VycmVudFByb2plY3QpO1xyXG5cclxuICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChlKSA9PiB7XHJcbiAgICAgIGNyZWF0ZUxpc3QoZSwgY3VycmVudFByb2plY3QpO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgcmV0dXJuIHsgaW5pdCB9O1xyXG59KSgpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgVXNlckludGVyZmFjZTtcclxuIiwiaW1wb3J0IExpc3QgZnJvbSBcIi4vTGlzdC9MaXN0XCI7XHJcblxyXG5jb25zdCBQcm9qZWN0ID0gKHRpdGxlLCBpZCA9IGNyeXB0by5yYW5kb21VVUlEKCkuc2xpY2UoMCwgOCkpID0+IHtcclxuICBjb25zdCBsaXN0cyA9IFtdO1xyXG5cclxuICBjb25zdCBnZXRUaXRsZSA9ICgpID0+IHRpdGxlO1xyXG4gIGNvbnN0IGdldElkID0gKCkgPT4gaWQ7XHJcbiAgY29uc3QgZ2V0TGlzdHMgPSAoKSA9PiBsaXN0cztcclxuXHJcbiAgY29uc3QgY3JlYXRlTGlzdCA9ICh0aXRsZSkgPT4ge1xyXG4gICAgbGlzdHMucHVzaChMaXN0KHRpdGxlKSk7XHJcbiAgICByZXR1cm4gbGlzdHNbbGlzdHMubGVuZ3RoIC0gMV07XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgZ2V0TGlzdEJ5SWQgPSAobGlzdElkKSA9PiB7XHJcbiAgICBjb25zdCBsaXN0SW5kZXggPSBsaXN0cy5maW5kSW5kZXgoKGxpc3QpID0+IGxpc3QuZ2V0SWQoKSA9PT0gbGlzdElkKTtcclxuXHJcbiAgICByZXR1cm4gbGlzdHNbbGlzdEluZGV4XTtcclxuICB9O1xyXG5cclxuICByZXR1cm4geyBnZXRUaXRsZSwgZ2V0SWQsIGdldExpc3RzLCBjcmVhdGVMaXN0LCBnZXRMaXN0QnlJZCB9O1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgUHJvamVjdDtcclxuIiwiaW1wb3J0IFRhc2tNYW5hZ2VyIGZyb20gXCIuL21vZHVsZXMvTGlzdC90YXNrL1Rhc2tNYW5hZ2VyLmpzXCI7XHJcbmltcG9ydCBVc2VySW50ZXJmYWNlIGZyb20gXCIuL21vZHVsZXMvVXNlckludGVyZmFjZS5qc1wiO1xyXG5pbXBvcnQgUHJvamVjdCBmcm9tIFwiLi9tb2R1bGVzL1Byb2plY3QuanNcIjtcclxuXHJcbmNvbnN0IFVJID0gVXNlckludGVyZmFjZTtcclxuVUkuaW5pdCgpO1xyXG4iXSwibmFtZXMiOlsidGl0bGUiLCJpZCIsImNyeXB0byIsInJhbmRvbVVVSUQiLCJzbGljZSIsInRhc2tzIiwidGFza01hbmFnZXIiLCJ0YXNrTGlzdCIsImdldFRhc2tCeUluZGV4IiwidGFza0lkIiwiZmluZEluZGV4IiwidGFzayIsImdldFRhc2tCeUlkIiwiZmluZCIsImNyZWF0ZVRhc2siLCJwdXNoIiwibGVuZ3RoIiwidXBkYXRlVGFzayIsInVwZGF0ZWRFbnRyeSIsInRhc2tJbmRleCIsInJlbW92ZVRhc2siLCJzcGxpY2UiLCJnZXRUaXRsZSIsImdldElkIiwiZ2V0VGFza3MiLCJhcHBlbmRDdXN0b21FbGVtZW50IiwiY3JlYXRlQ3VzdG9tRWxlbWVudCIsIm9wdGlvbnMiLCJ0YWdOYW1lIiwiY2xhc3NMaXN0IiwidGV4dENvbnRlbnQiLCJhdHRyaWJ1dGVzIiwiZWxlbWVudCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImFkZCIsIkFycmF5IiwiaXNBcnJheSIsImF0dHIiLCJ2YWx1ZSIsInNldEF0dHJpYnV0ZSIsInRhcmdldCIsInRhcmdldEVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiYXBwZW5kQ2hpbGQiLCJjdXN0b21FbGVtZW50SGVscGVyIiwiZGF0ZVN0cmluZyIsImRhdGUiLCJEYXRlIiwic2V0SG91cnMiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJtb250aCIsImRheSIsInllYXIiLCJjdXJyZW50TGlzdCIsIl9fY3JlYXRlRm9ybUVsZW1lbnRzIiwiZnJhZ21lbnQiLCJjcmVhdGVEb2N1bWVudEZyYWdtZW50IiwibmFtZSIsImRlc2NyaXB0aW9uIiwiZHVlRGF0ZSIsInZhbHVlQXNEYXRlIiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCIsImdldERhdGUiLCJkaWZmaWN1bHR5Iiwib3B0aW9uRWxlbWVudHMiLCJtYXAiLCJvcHRpb24iLCJhcHBlbmQiLCJmb3JtQnV0dG9ucyIsIl9fY3JlYXRlRm9ybUJ1dHRvbnMiLCJkaXYiLCJzdWJtaXRCdG4iLCJjYW5jZWxCdG4iLCJvbmNsaWNrIiwiZSIsInByZXZlbnREZWZhdWx0IiwiZm9ybSIsImNsb3Nlc3QiLCJ0YXNrQ29udGFpbmVyIiwicGFyZW50Tm9kZSIsIm1haW5EZXRhaWxzIiwicmVtb3ZlIiwibWFpbkRldGFpbHNFbGVtZW50cyIsImNyZWF0ZU1haW5EZXRhaWxzRWxlbWVudHMiLCJjYW5jZWxGb3JtIiwiYXBwZW5kRWRpdFRhc2tGb3JtIiwiZWRpdEZvcm0iLCJhZGRFdmVudExpc3RlbmVyIiwibGlzdCIsImJvdHRvbVBhbmVsIiwiZGF0YSIsIkZvcm1EYXRhIiwib2JqIiwidXBkYXRlZFRhc2siLCJyZXBsYWNlQ2hpbGRyZW4iLCJib3R0b21QYW5lbEVsZW1lbnRzIiwiY3JlYXRlQm90dG9tUGFuZWxFbGVtZW50cyIsInN1Ym1pdEZvcm0iLCJfX2NyZWF0ZUVkaXRUYXNrRm9ybSIsImV2ZW50SGFuZGxlciIsInNldEVkaXRNb2RlIiwidGFza0VsZW1lbnQiLCJjb250YWlucyIsImdldEVsZW1lbnRzQnlUYWdOYW1lIiwiZm9yRWFjaCIsInRleHRhcmVhIiwia2V5Iiwic2hpZnRLZXkiLCJzdWJtaXRFdmVudCIsIkV2ZW50IiwiYnViYmxlcyIsImNhbmNlbGFibGUiLCJkaXNwYXRjaEV2ZW50Iiwic2V0UHJpb3JpdHkiLCJwcmlvcml0eSIsInNyYyIsInRvZ2dsZSIsImRlbGV0ZVRhc2siLCJ0b29scyIsImltZ1NyYyIsImNsYXNzTmFtZSIsIm9uQ2xpY2siLCJjcmVhdGVUb29sYmFyIiwidG9vbGJhckNvbnRhaW5lciIsInRvb2wiLCJidG4iLCJpbWciLCJfX2NyZWF0ZUJ0bnMiLCJldmVudHMiLCJnZXRFdmVudHMiLCJzdWJzY3JpYmUiLCJldmVudCIsImNhbGxiYWNrIiwiaW5kZXgiLCJjb25zb2xlIiwibG9nIiwiaGFzT3duUHJvcGVydHkiLCJ1bnN1YnNjcmliZSIsInB1Ymxpc2giLCJfX2FwcGVuZFRhc2tFbGVtZW50cyIsInRhc2tzQ29udGFpbmVyIiwidGFza0VsZW1lbnRzIiwiX19jcmVhdGVUYXNrRWxlbWVudHMiLCJwcmVwZW5kIiwiZGF0YXNldCIsInRvb2xiYXIiLCJfX3JlbmRlck1haW5EZXRhaWxzIiwiX19yZW5kZXJCb3R0b21QYW5lbCIsImVkaXRUYXNrIiwidG9nZ2xlRGV0YWlscyIsInN0eWxlIiwib3BhY2l0eSIsInZpc2liaWxpdHkiLCJtYWluRGV0YWlsc0NvbnRhaW5lciIsImRpZmZpY3VsdHlFbCIsImdldFRhc2tEaWZmaWN1bHR5IiwiZHVlRGF0ZUVsIiwiYXV0b1Jlc2l6ZSIsInRoaXMiLCJoZWlnaHQiLCJzY3JvbGxIZWlnaHQiLCJlbCIsInByZXZpb3VzIiwiY2xvbmVOb2RlIiwiaW5wdXQiLCJjdXJyZW50VGFzayIsIndvcmRCcmVhayIsInJlcGxhY2VXaXRoIiwiYmx1ciIsIm9uY2UiLCJmb2N1cyIsImV4cGFuZGVkRGV0YWlscyIsImV4cGFuZGVkVGFzayIsImV4cGFuZGVkRGl2IiwiX19jcmVhdGVFeHBhbmRlZFRhc2siLCJhZnRlciIsInJlbmRlckV4cGFuZGVkVGFzayIsInJlbmRlckxpc3QiLCJfX2FwcGVuZExpc3RDb250YWluZXIiLCJfX2FwcGVuZExpc3RBbmRUaXRsZUVsZW1lbnRzIiwiX19hcHBlbmRUYXNrQ29udGFpbmVyIiwibGlzdEVsZW1lbnQiLCJfX2NyZWF0ZVRhc2tGb3JtIiwidGFza0Zvcm0iLCJ0YXNrSW5wdXQiLCJuZXdUYXNrIiwicHVic3ViIiwiY2hlY2tGb3JMaXN0cyIsImN1cnJlbnRQcm9qZWN0IiwibGlzdHMiLCJnZXRMaXN0cyIsImhhYml0TGlzdCIsImNyZWF0ZUxpc3QiLCJmaXJzdFRhc2siLCJjcmVhdGVEZWZhdWx0TGlzdCIsInByb2plY3RzIiwiZ2V0UHJvamVjdHMiLCJhZGRQcm9qZWN0IiwicHJvamVjdCIsImdldExpc3RCeUlkIiwibGlzdElkIiwibGlzdEluZGV4IiwiVXNlckludGVyZmFjZSIsImluaXQiLCJuZXdMaXN0Il0sInNvdXJjZVJvb3QiOiIifQ==