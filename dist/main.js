(()=>{"use strict";var t={d:(e,s)=>{for(var a in s)t.o(s,a)&&!t.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:s[a]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{$l:()=>y,vr:()=>k,eT:()=>f,rH:()=>v});const{appendCustomElement:s,createCustomElement:a}=(()=>{function t(t){const{tagName:e,classList:s,textContent:a,attributes:n}=t,r=document.createElement(e);if("string"==typeof s?r.classList.add(s):Array.isArray(s)&&r.classList.add(...s),a&&(r.textContent=a),Array.isArray(n)){const[t,e]=n;r.setAttribute(t,e)}return r}return{appendCustomElement:function(e){const{target:s}=e,a=document.querySelector(s),n=t(e);a.appendChild(n)},createCustomElement:t}})(),n=t=>{if(!t)return"";const e=new Date(t);return e.setHours(24,0,0,0),e.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"})},r=(()=>{const t={};return{getEvents:()=>t,subscribe:(e,s)=>{let a;return console.log(`Subscribing to ${e}`),t.hasOwnProperty(e)||(t[e]=[]),a=t[e].push(s)-1,{unsubscribe(){t[e].splice(a,1)}}},publish:(e,s={})=>(console.log(`Executing ${e}`),t.hasOwnProperty(e)?t[e].map((t=>t(s))):[])}})(),i=(t,e)=>{const s=t=>{const e=document.createDocumentFragment(),s=a({tagName:"textarea",classList:"edit-title"});s.value=t.title,s.name="title";const r=a({tagName:"textarea",classList:"edit-description",attributes:["placeholder","Add a description"]});r.value=t.description||"",r.name="description";const i=a({tagName:"input",attributes:["type","date"],classList:"edit-date"}),c=new Date;t.dueDate?i.value=t.dueDate:i.value="",i.name="dueDate",i.onclick=()=>{i.valueAsDate=i.valueAsDate=new Date(c.getFullYear(),c.getMonth(),c.getDate(),12)};const o=a({tagName:"select",classList:"edit-difficulty"});o.name="difficulty";const l=[{name:"Select a Difficulty",value:""},{name:"Easy",value:"Easy"},{name:"Medium",value:"Medium"},{name:"Hard",value:"Hard"}].map((e=>{const{name:s,value:n}=e,r=a({tagName:"option",textContent:s,attributes:["value",`${n}`]});return t.difficulty===n&&(r.selected=!0),r}));o.append(...l);const d=n(t);return e.append(s,r,i,o,d),e},n=()=>{const s=a({tagName:"div",classList:"form-controls"}),n=a({tagName:"button",classList:"submit-btn",textContent:"Submit"}),r=a({tagName:"button",classList:"cancel-btn",textContent:"Cancel"});return r.onclick=s=>((t,e)=>{t.preventDefault();const s=t.target.closest("form"),a=s.parentNode,n=a.querySelector(".main-details");s.remove(),a.classList.remove("isEditable");const r=p(e);n.append(r)})(s,t.getTaskById(e)),s.append(r,n),s};return{appendEditTaskForm:a=>{const n=(()=>{const a=document.createElement("form"),n=t.getTaskById(e);return a.id="edit-task",a.append(s(n)),a.addEventListener("submit",(e=>{((t,e,s)=>{t.preventDefault();const a=t.target,n=a.parentNode,i=n.querySelector(".main-details"),c=n.querySelector(".bottom-panel"),o=new FormData(a),l={};for(const[t,e]of o)l[t]=e;const d=e.updateTask(s.id,l);r.publish("taskUpdated",{list:e,task:d}),a.remove();const u=p(d);i.append(u),c.replaceChildren();const g=m(d);c.append(g),n.classList.remove("isEditable")})(e,t,n)})),a})();return a.append(n),n}}},c=(t,e)=>{const s=((t,e)=>({setEditMode:s=>{const a=s.target.closest(".task");if(a.classList.contains("isEditable"))return;const n=a.querySelector(".main-details");a.classList.add("isEditable"),n.replaceChildren(),a.classList.contains("expanded")&&(a.querySelector(".expanded-details").remove(),a.classList.remove("expanded"));const r=i(t,e.id).appendEditTaskForm(a);[...r.getElementsByTagName("textarea")].forEach((t=>{t.addEventListener("keydown",(t=>{if("Enter"===t.key&&!t.shiftKey){t.preventDefault();const e=new Event("submit",{bubbles:!0,cancelable:!0});r.dispatchEvent(e)}}))}))},setPriority:s=>{t.getTaskById(e.id).priority?(t.updateTask(e.id,{priority:!1}),s.target.closest("img").src="../src/imgs/noun-star-4485746.svg"):(t.updateTask(e.id,{priority:!0}),s.target.closest("img").src="../src/imgs/noun-star-4485827.svg"),s.target.closest(".task").classList.toggle("isPriority"),s.target.closest("img").classList.toggle("filter-gray"),s.target.closest("img").classList.toggle("filter-yellow")},deleteTask:s=>{t.removeTask(e.id),r.publish("taskDeleted",{list:t,task:e}),s.target.closest(".task").remove()}}))(t,e),n=[{name:"Edit",imgSrc:"../src/imgs/noun-quill-4626718.svg",className:"filter-gray",onClick:t=>s.setEditMode(t)},{name:"Set Priority",imgSrc:"../src/imgs/noun-star-4485746.svg",className:"filter-gray",onClick:t=>s.setPriority(t)},{name:"Delete",imgSrc:"../src/imgs/noun-skull-4485674.svg",className:"filter-red",onClick:t=>s.deleteTask(t)}];return{createToolbar:()=>{const t=a({tagName:"div",classList:"toolbar"});return t.append((t=>{const e=document.createDocumentFragment();return t.forEach((t=>{const{name:s,imgSrc:n,className:r,onClick:i}=t,c=a({tagName:"button",attributes:["aria-label",`${s}`]}),o=a({tagName:"img",attributes:["src",`${n}`],classList:r});c.onclick=i,c.append(o),e.append(c)})),e})(n)),t}}};function o(t){console.log("Rendering task");const{list:e,task:s}=t;l(e,s)}r.subscribe("taskCreated",o),r.subscribe("taskReconstructed",o);const l=(t,e)=>{const s=document.querySelector(`[data-id="${t.getId()}"]`).querySelector(".tasks-container"),a=d(t,e);s.prepend(a)},d=(t,e)=>{const s=document.createElement("div");s.className="task",s.dataset.id=e.id;const a=c(t,e).createToolbar(t,s),n=u(e),r=g(t,e.id);return s.append(a),s.append(n),s.append(r),s.addEventListener("dblclick",(s=>{f(s,e.id,t)})),s.addEventListener("click",(s=>{v(s,t,e.id)})),s.addEventListener("mouseover",(()=>{a.style.opacity="1",a.style.visibility="visible"})),s.addEventListener("mouseout",(()=>{a.style.opacity="0",a.style.visibility="hidden"})),s},u=t=>{const e=document.createElement("div");return e.classList.add("main-details"),e.appendChild(p(t)),e},p=t=>{const e=document.createDocumentFragment(),s=a({tagName:"p",classList:"task-title",textContent:t.title}),n=t.description?a({tagName:"p",classList:"task-description",textContent:t.description}):" ";return e.append(s,n),e},g=(t,e)=>{const s=t.getTaskById(e),n=a({tagName:"div",classList:"bottom-panel"});return n.append(m(s)),n},m=t=>{const e=document.createDocumentFragment(),s=a({tagName:"p",textContent:(t=>{switch(t){case"Easy":return"⚔️";case"Medium":return"⚔️⚔️";case"Hard":return"⚔️⚔️⚔️";default:return""}})(t.difficulty)}),r=a({tagName:"p",textContent:n(t.dueDate)||""});return e.append(r,s),e},y=(t,e)=>{if("Enter"===t.key){t.preventDefault();const s=t.target.value,a=e.createList(s);t.target.value="",r.publish("listCreated",a)}},k=(t,e)=>{if("Enter"===t.key){t.preventDefault();const s=t.target.value,a=e.createTask(s);t.target.value="",r.publish("taskCreated",{list:e,task:a})}};function b(){this.style.height="auto",this.style.height=this.scrollHeight+"px"}const f=(t,e,s)=>{const a=t.target;if(!a.classList.contains("task-title"))return;const n=a.cloneNode(!0),r=document.createElement("textarea"),i=s.getTaskById(e);r.classList.add("temp-input"),r.value=i.title,r.style.wordBreak="break-word",a.replaceWith(r),r.style.height="auto",r.style.height=r.scrollHeight+"px",r.addEventListener("keydown",(t=>{"Enter"===t.key&&r.blur()})),r.addEventListener("blur",(()=>{s.updateTask(e,{title:r.value}),n.textContent=r.value,r.replaceWith(n)}),{once:!0}),r.addEventListener("input",b,!1),r.focus()},v=(t,e,s)=>{if(t.target.classList.contains("isEditable")||!t.target.classList.contains("task"))return;const r=t.target,i=r.querySelector(".main-details"),c=r.querySelector(".expanded-details");c?(c.remove(),r.classList.remove("expanded")):(((t,e)=>{const s=(t=>{const{dueDate:e,difficulty:s}=t,r=document.createDocumentFragment(),i=document.createElement("div");return i.classList.add("expanded-details"),r.append(i),i.append(a({tagName:"p",classList:"due-date",textContent:n(e)})),i.append(a({tagName:"p",classList:"difficulty",textContent:s})),r})(e);t.after(s)})(i,e.getTaskById(s)),r.classList.add("expanded"))},h=(t,s)=>{const a=t.target,n=a.cloneNode(!0),i=document.createElement("textarea");i.classList.add("temp-input"),i.value=s.getTitle(),i.style.wordBreak="break-word",a.replaceWith(i),i.style.height="auto",i.style.height=i.scrollHeight+"px",i.addEventListener("keydown",(t=>{"Enter"===t.key&&i.blur()})),i.addEventListener("blur",(()=>{const t=s.setTitle(i.value);r.publish("listUpdated",{list:s,title:t}),n.textContent=i.value,i.replaceWith(n),n.addEventListener("dblclick",(t=>{h(t,s)}))}),{once:!0}),i.addEventListener("input",e.autoResize,!1),i.focus()};function L(t){console.log("Rendering List"),E(t),S(t),C(t)}r.subscribe("listCreated",L),r.subscribe("listReconstructed",L);const E=t=>{s({target:".lists-container",tagName:"div",classList:["list"],attributes:["data-id",t.getId()]})},S=t=>{const e=document.querySelector(`[data-id="${t.getId()}"]`),s=a({tagName:"h2",classList:"list-title",textContent:t.getTitle()});s.addEventListener("dblclick",(e=>{h(e,t)})),e.append(s,T(t))},T=t=>{const e=document.createElement("form");e.className="task-form";const s=a({tagName:"input",classList:"task-input",attributes:["placeholder","Add a task"]});return e.appendChild(s),s.addEventListener("keydown",(e=>{k(e,t)})),e},C=t=>{s({target:`[data-id="${t.getId()}"]`,tagName:"div",classList:"tasks-container"})},N=(()=>{let t=null;return{getCurrentProject:()=>t,setCurrentProject:e=>(console.log("Setting current project: "+e.getTitle()),t=e,r.publish("currentProjectSet",{title:e.getTitle(),id:e.getId()}),t)}})(),I=(t,e=crypto.randomUUID().slice(0,8))=>{let s=t;const a=[],n=(t=>{const e=e=>t.findIndex((t=>t.id===e));return{getTaskById:e=>t.find((t=>t.id===e)),createTask:(e,s=crypto.randomUUID().slice(0,8))=>(t.push({id:s,title:e}),t[t.length-1]),updateTask:(s,a)=>{const n=e(s);return t[n]={...t[n],...a},t[n]},removeTask:s=>{const a=e(s);t.splice(a,1)}}})(a);return{getTitle:()=>s,setTitle:t=>s=t,getId:()=>e,getTasks:()=>a,createTask:(t,e)=>n.createTask(t,e),getTaskById:t=>n.getTaskById(t),updateTask:(t,e)=>n.updateTask(t,e),removeTask:t=>n.removeTask(t)}},j=(t,e=crypto.randomUUID().slice(0,8))=>{const s=[];return{getTitle:()=>t,getId:()=>e,getLists:()=>s,createList:(t,e)=>(s.push(I(t,e)),s[s.length-1]),getListById:t=>{const e=s.findIndex((e=>e.getId()===t));return s[e]}}},x=t=>{const e=localStorage.getItem(t);return JSON.parse(e)},D=(t,e)=>{e.map((e=>{const s=t.createList(e.title,e.id);r.publish("listReconstructed",s),w(s,e.tasks)}))},w=(t,e)=>{e.forEach((e=>{t.createTask(e.title,e.id);const s=t.updateTask(e.id,e);r.publish("taskReconstructed",{list:t,task:s})}))};r.subscribe("projectCreated",(function(t){const e=x("projects");e.push({title:t.getTitle(),id:t.getId(),lists:[]}),localStorage.setItem("projects",JSON.stringify(e))})),r.subscribe("listCreated",(function(t){const e=x("projects");e[O()].lists.push({title:t.getTitle(),id:t.getId(),tasks:[]}),localStorage.setItem("projects",JSON.stringify(e))})),r.subscribe("listUpdated",(function(t){const{list:e,title:s}=t,a=x("projects"),n=a[O()],r=q(e.getId());n.lists[r]={...n.lists[r],title:s},localStorage.setItem("projects",JSON.stringify(a))})),r.subscribe("taskCreated",(function(t){const{list:e,task:s}=t,a=x("projects");P(a,e.getId()).tasks.push(s),localStorage.setItem("projects",JSON.stringify(a))})),r.subscribe("taskUpdated",(function(t){const{list:e,task:s}=t,a=x("projects"),n=P(a,e.getId()).tasks,r=B(n,s.id);n[r]={...n[r],...s},localStorage.setItem("projects",JSON.stringify(a))})),r.subscribe("taskDeleted",(function(t){const{list:e,task:s}=t,a=x("projects"),n=P(a,e.getId()).tasks,r=B(n,s.id);n.splice(r,1),localStorage.setItem("projects",JSON.stringify(a))})),r.subscribe("currentProjectSet",(function(t){localStorage.setItem("currentProject",JSON.stringify(t))}));const P=(t,e)=>{const s=O(),a=q(e);return t[s].lists[a]},O=()=>{const t=x("projects"),e=x("currentProject");return t.findIndex((t=>t.id===e.id))},q=t=>x("projects")[O()].lists.findIndex((e=>e.id===t)),B=(t,e)=>t.findIndex((t=>t.id===e)),U=(()=>{const t=document.querySelector("#list-input");return{init:()=>{const e=N.getCurrentProject();t.addEventListener("keydown",(t=>{y(t,e)}))}}})();(()=>{if(!("projects"in localStorage))return console.log("Initialize projects array in storage"),localStorage.setItem("projects",JSON.stringify([])),void(()=>{console.log("Creating default project");const t=j("Default");N.setCurrentProject(t),r.publish("projectCreated",t),(t=>{const e=t.createList("Habits"),s=e.createTask("Create your first habit!");r.publish("listCreated",e),r.publish("taskCreated",{list:e,task:s})})(t)})();N.setCurrentProject((()=>{const t=(()=>{const t=localStorage.getItem("projects");return JSON.parse(t)})()[O()],e=j(t.title,t.id);return r.publish("projectReconstructed",e),D(e,t.lists),e})())})(),U.init()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ZSxDQUFFNkMsS0FBTTZJLEVBQVdwTCxLQUFNcUwsR0FBWSxFUU5uRUMsQ0FBa0JILEVBQ0csRUZxRG5CSSxHQUlGLEVBQU0vQyxrQkFHMEIsTUFDaEMsTUFFTWdELEVBdEJrQixNQUN4QixNQUFNekIsRUFBZUMsYUFBYUMsUUFBUSxZQUUxQyxPQUR1QkMsS0FBS0MsTUFBTUosRUFDYixFQWlCRTBCLEdBQ0RmLEtBR2hCZ0IsRUFBdUIsRUFBUUYsRUFBWXJMLE1BQU9xTCxFQUFZbkosSUFLcEUsT0FKQSxFQUFPM0MsUUFBUSx1QkFBd0JnTSxHQUV2Q3RCLEVBQW1Cc0IsRUFBc0JGLEVBQVkvQixPQUU5Q2lDLENBQW9CLEVBYkhDLEdBQTRCLEVHaEV0REMsR0FDVyxFQUNSVixNIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb3AtdG9kby1saXN0L3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL29wLXRvZG8tbGlzdC93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vb3AtdG9kby1saXN0L3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vb3AtdG9kby1saXN0L3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vb3AtdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvSGVscGVycy9jdXN0b21FbGVtZW50SGVscGVyLmpzIiwid2VicGFjazovL29wLXRvZG8tbGlzdC8uL3NyYy9tb2R1bGVzL0hlbHBlcnMvZm9ybWF0RGF0ZUhlbHBlci5qcyIsIndlYnBhY2s6Ly9vcC10b2RvLWxpc3QvLi9zcmMvbW9kdWxlcy9wdWJTdWIuanMiLCJ3ZWJwYWNrOi8vb3AtdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvRm9ybS9Gb3JtUmVuZGVyZXIuanMiLCJ3ZWJwYWNrOi8vb3AtdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvRm9ybS9Gb3JtRXZlbnRIYW5kbGVycy5qcyIsIndlYnBhY2s6Ly9vcC10b2RvLWxpc3QvLi9zcmMvbW9kdWxlcy9Ub29sYmFyL1Rvb2xiYXIuanMiLCJ3ZWJwYWNrOi8vb3AtdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvVG9vbGJhci9Ub29sYmFyRXZlbnRIYW5kbGVyLmpzIiwid2VicGFjazovL29wLXRvZG8tbGlzdC8uL3NyYy9tb2R1bGVzL0xpc3QvdGFzay9UYXNrUmVuZGVyZXIuanMiLCJ3ZWJwYWNrOi8vb3AtdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvRXZlbnRIYW5kbGVyLmpzIiwid2VicGFjazovL29wLXRvZG8tbGlzdC8uL3NyYy9tb2R1bGVzL0xpc3QvTGlzdEhhbmRsZXIuanMiLCJ3ZWJwYWNrOi8vb3AtdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvTGlzdC9MaXN0UmVuZGVyZXIuanMiLCJ3ZWJwYWNrOi8vb3AtdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvc3RvcmUuanMiLCJ3ZWJwYWNrOi8vb3AtdG9kby1saXN0Ly4vc3JjL21vZHVsZXMvTGlzdC9MaXN0LmpzIiwid2VicGFjazovL29wLXRvZG8tbGlzdC8uL3NyYy9tb2R1bGVzL0xpc3QvdGFzay9UYXNrTWFuYWdlci5qcyIsIndlYnBhY2s6Ly9vcC10b2RvLWxpc3QvLi9zcmMvbW9kdWxlcy9Qcm9qZWN0LmpzIiwid2VicGFjazovL29wLXRvZG8tbGlzdC8uL3NyYy9tb2R1bGVzL2xvY2FsU3RvcmFnZUhlbHBlci5qcyIsIndlYnBhY2s6Ly9vcC10b2RvLWxpc3QvLi9zcmMvbW9kdWxlcy9Vc2VySW50ZXJmYWNlLmpzIiwid2VicGFjazovL29wLXRvZG8tbGlzdC8uL3NyYy9tb2R1bGVzL1Byb2plY3RIYW5kbGVyLmpzIiwid2VicGFjazovL29wLXRvZG8tbGlzdC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsImNvbnN0IGN1c3RvbUVsZW1lbnRIZWxwZXIgPSAoKSA9PiB7XHJcbiAgLy8gUGFzcyBpbiBhIG9iamVjdCBvZiB7IFt0YXJnZXRdLiwgdGFnTmFtZSwgY2xhc3NMaXN0LCB0ZXh0Q29udGVudCwgYXR0cmlidXRlcyB9XHJcbiAgZnVuY3Rpb24gYXBwZW5kQ3VzdG9tRWxlbWVudChvcHRpb25zKSB7XHJcbiAgICBjb25zdCB7IHRhcmdldCB9ID0gb3B0aW9ucztcclxuICAgIGNvbnN0IHRhcmdldEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRhcmdldCk7XHJcblxyXG4gICAgY29uc3QgZWxlbWVudCA9IGNyZWF0ZUN1c3RvbUVsZW1lbnQob3B0aW9ucyk7XHJcbiAgICB0YXJnZXRFbGVtZW50LmFwcGVuZENoaWxkKGVsZW1lbnQpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gY3JlYXRlQ3VzdG9tRWxlbWVudChvcHRpb25zKSB7XHJcbiAgICBjb25zdCB7IHRhZ05hbWUsIGNsYXNzTGlzdCwgdGV4dENvbnRlbnQsIGF0dHJpYnV0ZXMgfSA9IG9wdGlvbnM7XHJcbiAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWdOYW1lKTtcclxuXHJcbiAgICBpZiAodHlwZW9mIGNsYXNzTGlzdCA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoY2xhc3NMaXN0KTtcclxuICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShjbGFzc0xpc3QpKSB7XHJcbiAgICAgIGVsZW1lbnQuY2xhc3NMaXN0LmFkZCguLi5jbGFzc0xpc3QpO1xyXG4gICAgfVxyXG4gICAgaWYgKHRleHRDb250ZW50KSB7XHJcbiAgICAgIGVsZW1lbnQudGV4dENvbnRlbnQgPSB0ZXh0Q29udGVudDtcclxuICAgIH1cclxuICAgIGlmIChBcnJheS5pc0FycmF5KGF0dHJpYnV0ZXMpKSB7XHJcbiAgICAgIGNvbnN0IFthdHRyLCB2YWx1ZV0gPSBhdHRyaWJ1dGVzO1xyXG4gICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZShhdHRyLCB2YWx1ZSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZWxlbWVudDtcclxuICB9XHJcbiAgcmV0dXJuIHsgYXBwZW5kQ3VzdG9tRWxlbWVudCwgY3JlYXRlQ3VzdG9tRWxlbWVudCB9O1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHsgYXBwZW5kQ3VzdG9tRWxlbWVudCwgY3JlYXRlQ3VzdG9tRWxlbWVudCB9ID1cclxuICBjdXN0b21FbGVtZW50SGVscGVyKCk7XHJcbiIsImNvbnN0IGZvcm1hdERhdGUgPSAoZGF0ZVN0cmluZykgPT4ge1xyXG4gIGlmICghZGF0ZVN0cmluZykge1xyXG4gICAgcmV0dXJuIFwiXCI7XHJcbiAgfVxyXG4gIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShkYXRlU3RyaW5nKTtcclxuICBkYXRlLnNldEhvdXJzKDI0LCAwLCAwLCAwKTtcclxuXHJcbiAgY29uc3QgZm9ybWF0dGVkRGF0ZSA9IGRhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKFwiZW4tVVNcIiwge1xyXG4gICAgbW9udGg6IFwiMi1kaWdpdFwiLFxyXG4gICAgZGF5OiBcIjItZGlnaXRcIixcclxuICAgIHllYXI6IFwiMi1kaWdpdFwiLFxyXG4gIH0pO1xyXG5cclxuICByZXR1cm4gZm9ybWF0dGVkRGF0ZTtcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGZvcm1hdERhdGU7XHJcbiIsImNvbnN0IHB1YlN1YiA9ICgoKSA9PiB7XHJcbiAgY29uc3QgZXZlbnRzID0ge307XHJcblxyXG4gIGNvbnN0IGdldEV2ZW50cyA9ICgpID0+IGV2ZW50cztcclxuXHJcbiAgY29uc3Qgc3Vic2NyaWJlID0gKGV2ZW50LCBjYWxsYmFjaykgPT4ge1xyXG4gICAgY29uc29sZS5sb2coYFN1YnNjcmliaW5nIHRvICR7ZXZlbnR9YCk7XHJcbiAgICBsZXQgaW5kZXg7XHJcblxyXG4gICAgaWYgKCFldmVudHMuaGFzT3duUHJvcGVydHkoZXZlbnQpKSB7XHJcbiAgICAgIGV2ZW50c1tldmVudF0gPSBbXTtcclxuICAgIH1cclxuXHJcbiAgICBpbmRleCA9IGV2ZW50c1tldmVudF0ucHVzaChjYWxsYmFjaykgLSAxO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHVuc3Vic2NyaWJlKCkge1xyXG4gICAgICAgIGV2ZW50c1tldmVudF0uc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgfSxcclxuICAgIH07XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgcHVibGlzaCA9IChldmVudCwgZGF0YSA9IHt9KSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhgRXhlY3V0aW5nICR7ZXZlbnR9YCk7XHJcbiAgICBpZiAoIWV2ZW50cy5oYXNPd25Qcm9wZXJ0eShldmVudCkpIHtcclxuICAgICAgcmV0dXJuIFtdO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBldmVudHNbZXZlbnRdLm1hcCgoY2FsbGJhY2spID0+IGNhbGxiYWNrKGRhdGEpKTtcclxuICB9O1xyXG5cclxuICByZXR1cm4geyBnZXRFdmVudHMsIHN1YnNjcmliZSwgcHVibGlzaCB9O1xyXG59KSgpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgcHViU3ViO1xyXG4iLCJpbXBvcnQgeyBjcmVhdGVDdXN0b21FbGVtZW50IH0gZnJvbSBcIi4uL0hlbHBlcnMvY3VzdG9tRWxlbWVudEhlbHBlci5qc1wiO1xyXG5pbXBvcnQgeyBzdWJtaXRGb3JtLCBjYW5jZWxGb3JtIH0gZnJvbSBcIi4vRm9ybUV2ZW50SGFuZGxlcnMuanNcIjtcclxuXHJcbmNvbnN0IEZvcm1SZW5kZXJlciA9IChjdXJyZW50TGlzdCwgdGFza0lkKSA9PiB7XHJcbiAgY29uc3QgYXBwZW5kRWRpdFRhc2tGb3JtID0gKHRhcmdldCkgPT4ge1xyXG4gICAgY29uc3QgZWRpdEZvcm0gPSBfX2NyZWF0ZUVkaXRUYXNrRm9ybSgpO1xyXG4gICAgdGFyZ2V0LmFwcGVuZChlZGl0Rm9ybSk7XHJcbiAgICByZXR1cm4gZWRpdEZvcm07XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgX19jcmVhdGVFZGl0VGFza0Zvcm0gPSAoKSA9PiB7XHJcbiAgICBjb25zdCBmb3JtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImZvcm1cIik7XHJcbiAgICBjb25zdCB0YXNrID0gY3VycmVudExpc3QuZ2V0VGFza0J5SWQodGFza0lkKTtcclxuICAgIGZvcm0uaWQgPSBcImVkaXQtdGFza1wiO1xyXG4gICAgZm9ybS5hcHBlbmQoX19jcmVhdGVGb3JtRWxlbWVudHModGFzaykpO1xyXG5cclxuICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICBzdWJtaXRGb3JtKGUsIGN1cnJlbnRMaXN0LCB0YXNrKTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGZvcm07XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgX19jcmVhdGVGb3JtRWxlbWVudHMgPSAodGFzaykgPT4ge1xyXG4gICAgLy8gVGl0bGVcclxuICAgIGNvbnN0IGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xyXG5cclxuICAgIGNvbnN0IHRpdGxlID0gY3JlYXRlQ3VzdG9tRWxlbWVudCh7XHJcbiAgICAgIHRhZ05hbWU6IFwidGV4dGFyZWFcIixcclxuICAgICAgY2xhc3NMaXN0OiBcImVkaXQtdGl0bGVcIixcclxuICAgIH0pO1xyXG4gICAgdGl0bGUudmFsdWUgPSB0YXNrLnRpdGxlO1xyXG4gICAgdGl0bGUubmFtZSA9IFwidGl0bGVcIjtcclxuXHJcbiAgICAvL0Rlc2NyaXB0aW9uXHJcbiAgICBjb25zdCBkZXNjcmlwdGlvbiA9IGNyZWF0ZUN1c3RvbUVsZW1lbnQoe1xyXG4gICAgICB0YWdOYW1lOiBcInRleHRhcmVhXCIsXHJcbiAgICAgIGNsYXNzTGlzdDogXCJlZGl0LWRlc2NyaXB0aW9uXCIsXHJcbiAgICAgIGF0dHJpYnV0ZXM6IFtcInBsYWNlaG9sZGVyXCIsIFwiQWRkIGEgZGVzY3JpcHRpb25cIl0sXHJcbiAgICB9KTtcclxuICAgIGRlc2NyaXB0aW9uLnZhbHVlID0gdGFzay5kZXNjcmlwdGlvbiB8fCBcIlwiO1xyXG4gICAgZGVzY3JpcHRpb24ubmFtZSA9IFwiZGVzY3JpcHRpb25cIjtcclxuXHJcbiAgICAvLyBEdWUgRGF0ZVxyXG4gICAgY29uc3QgZHVlRGF0ZSA9IGNyZWF0ZUN1c3RvbUVsZW1lbnQoe1xyXG4gICAgICB0YWdOYW1lOiBcImlucHV0XCIsXHJcbiAgICAgIGF0dHJpYnV0ZXM6IFtcInR5cGVcIiwgXCJkYXRlXCJdLFxyXG4gICAgICBjbGFzc0xpc3Q6IFwiZWRpdC1kYXRlXCIsXHJcbiAgICB9KTtcclxuICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgdGFzay5kdWVEYXRlID8gKGR1ZURhdGUudmFsdWUgPSB0YXNrLmR1ZURhdGUpIDogKGR1ZURhdGUudmFsdWUgPSBcIlwiKTtcclxuICAgIGR1ZURhdGUubmFtZSA9IFwiZHVlRGF0ZVwiO1xyXG4gICAgZHVlRGF0ZS5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICBkdWVEYXRlLnZhbHVlQXNEYXRlID0gZHVlRGF0ZS52YWx1ZUFzRGF0ZSA9IG5ldyBEYXRlKFxyXG4gICAgICAgIGRhdGUuZ2V0RnVsbFllYXIoKSxcclxuICAgICAgICBkYXRlLmdldE1vbnRoKCksXHJcbiAgICAgICAgZGF0ZS5nZXREYXRlKCksXHJcbiAgICAgICAgMTJcclxuICAgICAgKTtcclxuICAgIH07XHJcblxyXG4gICAgLy8gRGlmZmljdWx0eVxyXG4gICAgY29uc3QgZGlmZmljdWx0eSA9IGNyZWF0ZUN1c3RvbUVsZW1lbnQoe1xyXG4gICAgICB0YWdOYW1lOiBcInNlbGVjdFwiLFxyXG4gICAgICBjbGFzc0xpc3Q6IFwiZWRpdC1kaWZmaWN1bHR5XCIsXHJcbiAgICB9KTtcclxuICAgIGRpZmZpY3VsdHkubmFtZSA9IFwiZGlmZmljdWx0eVwiO1xyXG4gICAgY29uc3QgZGlmZmljdWx0eU9wdGlvbnMgPSBbXHJcbiAgICAgIHsgbmFtZTogXCJTZWxlY3QgYSBEaWZmaWN1bHR5XCIsIHZhbHVlOiBcIlwiIH0sXHJcbiAgICAgIHsgbmFtZTogXCJFYXN5XCIsIHZhbHVlOiBcIkVhc3lcIiB9LFxyXG4gICAgICB7IG5hbWU6IFwiTWVkaXVtXCIsIHZhbHVlOiBcIk1lZGl1bVwiIH0sXHJcbiAgICAgIHsgbmFtZTogXCJIYXJkXCIsIHZhbHVlOiBcIkhhcmRcIiB9LFxyXG4gICAgXTtcclxuXHJcbiAgICAvLyBEaWZmaWN1bHR5IE9wdGlvbnNcclxuICAgIGNvbnN0IG9wdGlvbkVsZW1lbnRzID0gZGlmZmljdWx0eU9wdGlvbnMubWFwKChvcHRpb24pID0+IHtcclxuICAgICAgY29uc3QgeyBuYW1lLCB2YWx1ZSB9ID0gb3B0aW9uO1xyXG4gICAgICBjb25zdCBvcHRpb25FbGVtZW50ID0gY3JlYXRlQ3VzdG9tRWxlbWVudCh7XHJcbiAgICAgICAgdGFnTmFtZTogXCJvcHRpb25cIixcclxuICAgICAgICB0ZXh0Q29udGVudDogbmFtZSxcclxuICAgICAgICBhdHRyaWJ1dGVzOiBbXCJ2YWx1ZVwiLCBgJHt2YWx1ZX1gXSxcclxuICAgICAgfSk7XHJcbiAgICAgIGlmICh0YXNrLmRpZmZpY3VsdHkgPT09IHZhbHVlKSB7XHJcbiAgICAgICAgb3B0aW9uRWxlbWVudC5zZWxlY3RlZCA9IHRydWU7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIG9wdGlvbkVsZW1lbnQ7XHJcbiAgICB9KTtcclxuICAgIGRpZmZpY3VsdHkuYXBwZW5kKC4uLm9wdGlvbkVsZW1lbnRzKTtcclxuXHJcbiAgICAvLyBGb3JtIEJ1dHRvbnNcclxuICAgIGNvbnN0IGZvcm1CdXR0b25zID0gX19jcmVhdGVGb3JtQnV0dG9ucyh0YXNrKTtcclxuICAgIGZyYWdtZW50LmFwcGVuZCh0aXRsZSwgZGVzY3JpcHRpb24sIGR1ZURhdGUsIGRpZmZpY3VsdHksIGZvcm1CdXR0b25zKTtcclxuXHJcbiAgICByZXR1cm4gZnJhZ21lbnQ7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgX19jcmVhdGVGb3JtQnV0dG9ucyA9ICgpID0+IHtcclxuICAgIGNvbnN0IGRpdiA9IGNyZWF0ZUN1c3RvbUVsZW1lbnQoe1xyXG4gICAgICB0YWdOYW1lOiBcImRpdlwiLFxyXG4gICAgICBjbGFzc0xpc3Q6IFwiZm9ybS1jb250cm9sc1wiLFxyXG4gICAgfSk7XHJcbiAgICBjb25zdCBzdWJtaXRCdG4gPSBjcmVhdGVDdXN0b21FbGVtZW50KHtcclxuICAgICAgdGFnTmFtZTogXCJidXR0b25cIixcclxuICAgICAgY2xhc3NMaXN0OiBcInN1Ym1pdC1idG5cIixcclxuICAgICAgdGV4dENvbnRlbnQ6IFwiU3VibWl0XCIsXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zdCBjYW5jZWxCdG4gPSBjcmVhdGVDdXN0b21FbGVtZW50KHtcclxuICAgICAgdGFnTmFtZTogXCJidXR0b25cIixcclxuICAgICAgY2xhc3NMaXN0OiBcImNhbmNlbC1idG5cIixcclxuICAgICAgdGV4dENvbnRlbnQ6IFwiQ2FuY2VsXCIsXHJcbiAgICB9KTtcclxuICAgIGNhbmNlbEJ0bi5vbmNsaWNrID0gKGUpID0+IGNhbmNlbEZvcm0oZSwgY3VycmVudExpc3QuZ2V0VGFza0J5SWQodGFza0lkKSk7XHJcblxyXG4gICAgZGl2LmFwcGVuZChjYW5jZWxCdG4sIHN1Ym1pdEJ0bik7XHJcbiAgICByZXR1cm4gZGl2O1xyXG4gIH07XHJcblxyXG4gIHJldHVybiB7IGFwcGVuZEVkaXRUYXNrRm9ybSB9O1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgRm9ybVJlbmRlcmVyO1xyXG4iLCJpbXBvcnQge1xyXG4gIGNyZWF0ZU1haW5EZXRhaWxzRWxlbWVudHMsXHJcbiAgY3JlYXRlQm90dG9tUGFuZWxFbGVtZW50cyxcclxufSBmcm9tIFwiLi4vTGlzdC90YXNrL1Rhc2tSZW5kZXJlclwiO1xyXG5pbXBvcnQgcHViU3ViIGZyb20gXCIuLi9wdWJTdWJcIjtcclxuXHJcbmNvbnN0IHN1Ym1pdEZvcm0gPSAoZSwgbGlzdCwgdGFzaykgPT4ge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgY29uc3QgZm9ybSA9IGUudGFyZ2V0O1xyXG4gIGNvbnN0IHRhc2tDb250YWluZXIgPSBmb3JtLnBhcmVudE5vZGU7XHJcbiAgY29uc3QgbWFpbkRldGFpbHMgPSB0YXNrQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIubWFpbi1kZXRhaWxzXCIpO1xyXG4gIGNvbnN0IGJvdHRvbVBhbmVsID0gdGFza0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLmJvdHRvbS1wYW5lbFwiKTtcclxuXHJcbiAgY29uc3QgZGF0YSA9IG5ldyBGb3JtRGF0YShmb3JtKTtcclxuICBjb25zdCBuZXdWYWx1ZXMgPSB7fTtcclxuICBmb3IgKGNvbnN0IFtuYW1lLCB2YWx1ZV0gb2YgZGF0YSkge1xyXG4gICAgbmV3VmFsdWVzW25hbWVdID0gdmFsdWU7XHJcbiAgfVxyXG4gIGNvbnN0IHVwZGF0ZWRUYXNrID0gbGlzdC51cGRhdGVUYXNrKHRhc2suaWQsIG5ld1ZhbHVlcyk7XHJcbiAgcHViU3ViLnB1Ymxpc2goXCJ0YXNrVXBkYXRlZFwiLCB7IGxpc3QsIHRhc2s6IHVwZGF0ZWRUYXNrIH0pO1xyXG5cclxuICBmb3JtLnJlbW92ZSgpO1xyXG4gIGNvbnN0IG1haW5EZXRhaWxzRWxlbWVudHMgPSBjcmVhdGVNYWluRGV0YWlsc0VsZW1lbnRzKHVwZGF0ZWRUYXNrKTtcclxuICBtYWluRGV0YWlscy5hcHBlbmQobWFpbkRldGFpbHNFbGVtZW50cyk7XHJcblxyXG4gIGJvdHRvbVBhbmVsLnJlcGxhY2VDaGlsZHJlbigpO1xyXG4gIGNvbnN0IGJvdHRvbVBhbmVsRWxlbWVudHMgPSBjcmVhdGVCb3R0b21QYW5lbEVsZW1lbnRzKHVwZGF0ZWRUYXNrKTtcclxuICBib3R0b21QYW5lbC5hcHBlbmQoYm90dG9tUGFuZWxFbGVtZW50cyk7XHJcblxyXG4gIHRhc2tDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZShcImlzRWRpdGFibGVcIik7XHJcbn07XHJcblxyXG5jb25zdCBjYW5jZWxGb3JtID0gKGUsIHRhc2spID0+IHtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gIGNvbnN0IGZvcm0gPSBlLnRhcmdldC5jbG9zZXN0KFwiZm9ybVwiKTtcclxuICBjb25zdCB0YXNrQ29udGFpbmVyID0gZm9ybS5wYXJlbnROb2RlO1xyXG4gIGNvbnN0IG1haW5EZXRhaWxzID0gdGFza0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLm1haW4tZGV0YWlsc1wiKTtcclxuXHJcbiAgZm9ybS5yZW1vdmUoKTtcclxuICB0YXNrQ29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJpc0VkaXRhYmxlXCIpO1xyXG5cclxuICBjb25zdCBtYWluRGV0YWlsc0VsZW1lbnRzID0gY3JlYXRlTWFpbkRldGFpbHNFbGVtZW50cyh0YXNrKTtcclxuICBtYWluRGV0YWlscy5hcHBlbmQobWFpbkRldGFpbHNFbGVtZW50cyk7XHJcbn07XHJcblxyXG5leHBvcnQgeyBzdWJtaXRGb3JtLCBjYW5jZWxGb3JtIH07XHJcbiIsImltcG9ydCB7IGNyZWF0ZUN1c3RvbUVsZW1lbnQgfSBmcm9tIFwiLi4vSGVscGVycy9jdXN0b21FbGVtZW50SGVscGVyLmpzXCI7XHJcbmltcG9ydCBUb29sYmFyRXZlbnRIYW5kbGVyIGZyb20gXCIuL1Rvb2xiYXJFdmVudEhhbmRsZXIuanNcIjtcclxuXHJcbi8vIENyZWF0ZSB0b29sYmFyIHdpbGwgcmV0dXJuIGEgZnJhZ21lbnQgY29udGFpbmVyIG9mIHRocmVlIGJ1dHRvbnNcclxuLy9cclxuXHJcbmNvbnN0IFRvb2xiYXIgPSAoY3VycmVudExpc3QsIHRhc2spID0+IHtcclxuICBjb25zdCBldmVudEhhbmRsZXIgPSBUb29sYmFyRXZlbnRIYW5kbGVyKGN1cnJlbnRMaXN0LCB0YXNrKTtcclxuXHJcbiAgY29uc3QgdG9vbHMgPSBbXHJcbiAgICB7XHJcbiAgICAgIG5hbWU6IFwiRWRpdFwiLFxyXG4gICAgICBpbWdTcmM6IFwiLi4vc3JjL2ltZ3Mvbm91bi1xdWlsbC00NjI2NzE4LnN2Z1wiLFxyXG4gICAgICBjbGFzc05hbWU6IFwiZmlsdGVyLWdyYXlcIixcclxuICAgICAgb25DbGljazogKGUpID0+IGV2ZW50SGFuZGxlci5zZXRFZGl0TW9kZShlKSxcclxuICAgIH0sXHJcbiAgICB7XHJcbiAgICAgIG5hbWU6IFwiU2V0IFByaW9yaXR5XCIsXHJcbiAgICAgIGltZ1NyYzogXCIuLi9zcmMvaW1ncy9ub3VuLXN0YXItNDQ4NTc0Ni5zdmdcIixcclxuICAgICAgY2xhc3NOYW1lOiBcImZpbHRlci1ncmF5XCIsXHJcbiAgICAgIG9uQ2xpY2s6IChlKSA9PiBldmVudEhhbmRsZXIuc2V0UHJpb3JpdHkoZSksXHJcbiAgICB9LFxyXG4gICAge1xyXG4gICAgICBuYW1lOiBcIkRlbGV0ZVwiLFxyXG4gICAgICBpbWdTcmM6IFwiLi4vc3JjL2ltZ3Mvbm91bi1za3VsbC00NDg1Njc0LnN2Z1wiLFxyXG4gICAgICBjbGFzc05hbWU6IFwiZmlsdGVyLXJlZFwiLFxyXG4gICAgICBvbkNsaWNrOiAoZSkgPT4gZXZlbnRIYW5kbGVyLmRlbGV0ZVRhc2soZSksXHJcbiAgICB9LFxyXG4gIF07XHJcblxyXG4gIGNvbnN0IGNyZWF0ZVRvb2xiYXIgPSAoKSA9PiB7XHJcbiAgICBjb25zdCB0b29sYmFyQ29udGFpbmVyID0gY3JlYXRlQ3VzdG9tRWxlbWVudCh7XHJcbiAgICAgIHRhZ05hbWU6IFwiZGl2XCIsXHJcbiAgICAgIGNsYXNzTGlzdDogXCJ0b29sYmFyXCIsXHJcbiAgICB9KTtcclxuICAgIHRvb2xiYXJDb250YWluZXIuYXBwZW5kKF9fY3JlYXRlQnRucyh0b29scykpO1xyXG4gICAgcmV0dXJuIHRvb2xiYXJDb250YWluZXI7XHJcbiAgfTtcclxuICBjb25zdCBfX2NyZWF0ZUJ0bnMgPSAodG9vbHMpID0+IHtcclxuICAgIGNvbnN0IGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xyXG4gICAgdG9vbHMuZm9yRWFjaCgodG9vbCkgPT4ge1xyXG4gICAgICBjb25zdCB7IG5hbWUsIGltZ1NyYywgY2xhc3NOYW1lLCBvbkNsaWNrIH0gPSB0b29sO1xyXG4gICAgICAvLyBUb29sYmFyIHdpbGwgY29uc2lzdCBvZjpcclxuICAgICAgLy8gRWRpdFxyXG4gICAgICAvLyBTZXQgUHJpb3JpdHkgLSBpc1ByaW9yaXR5XHJcbiAgICAgIC8vIERlbGV0ZVxyXG4gICAgICBjb25zdCBidG4gPSBjcmVhdGVDdXN0b21FbGVtZW50KHtcclxuICAgICAgICB0YWdOYW1lOiBcImJ1dHRvblwiLFxyXG4gICAgICAgIGF0dHJpYnV0ZXM6IFtcImFyaWEtbGFiZWxcIiwgYCR7bmFtZX1gXSxcclxuICAgICAgfSk7XHJcbiAgICAgIGNvbnN0IGltZyA9IGNyZWF0ZUN1c3RvbUVsZW1lbnQoe1xyXG4gICAgICAgIHRhZ05hbWU6IFwiaW1nXCIsXHJcbiAgICAgICAgYXR0cmlidXRlczogW1wic3JjXCIsIGAke2ltZ1NyY31gXSxcclxuICAgICAgICBjbGFzc0xpc3Q6IGNsYXNzTmFtZSxcclxuICAgICAgfSk7XHJcbiAgICAgIGJ0bi5vbmNsaWNrID0gb25DbGljaztcclxuICAgICAgYnRuLmFwcGVuZChpbWcpO1xyXG4gICAgICBmcmFnbWVudC5hcHBlbmQoYnRuKTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGZyYWdtZW50O1xyXG4gIH07XHJcblxyXG4gIHJldHVybiB7IGNyZWF0ZVRvb2xiYXIgfTtcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IFRvb2xiYXI7XHJcbiIsImltcG9ydCBGb3JtUmVuZGVyZXIgZnJvbSBcIi4uL0Zvcm0vRm9ybVJlbmRlcmVyLmpzXCI7XHJcbmltcG9ydCBwdWJTdWIgZnJvbSBcIi4uL3B1YlN1Yi5qc1wiO1xyXG5cclxuY29uc3QgVG9vbGJhckV2ZW50SGFuZGxlciA9IChjdXJyZW50TGlzdCwgdGFzaykgPT4ge1xyXG4gIGNvbnN0IHNldEVkaXRNb2RlID0gKGUpID0+IHtcclxuICAgIGNvbnN0IHRhc2tFbGVtZW50ID0gZS50YXJnZXQuY2xvc2VzdChcIi50YXNrXCIpO1xyXG4gICAgLy8gRXNjYXBlIGlmIGFscmVhZHkgaW4gZWRpdCBtb2RlXHJcbiAgICBpZiAodGFza0VsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiaXNFZGl0YWJsZVwiKSkgcmV0dXJuO1xyXG4gICAgY29uc3QgbWFpbkRldGFpbHMgPSB0YXNrRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1haW4tZGV0YWlsc1wiKTtcclxuICAgIHRhc2tFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJpc0VkaXRhYmxlXCIpO1xyXG5cclxuICAgIC8vIENsZWFyIGFsbCBjaGlsZHJlbiBpbiBtYWluIGRldGFpbHNcclxuICAgIG1haW5EZXRhaWxzLnJlcGxhY2VDaGlsZHJlbigpO1xyXG5cclxuICAgIGlmICh0YXNrRWxlbWVudC5jbGFzc0xpc3QuY29udGFpbnMoXCJleHBhbmRlZFwiKSkge1xyXG4gICAgICB0YXNrRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmV4cGFuZGVkLWRldGFpbHNcIikucmVtb3ZlKCk7XHJcbiAgICAgIHRhc2tFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJleHBhbmRlZFwiKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBmb3JtUmVuZGVyZXIgPSBGb3JtUmVuZGVyZXIoY3VycmVudExpc3QsIHRhc2suaWQpO1xyXG4gICAgY29uc3QgZWRpdEZvcm0gPSBmb3JtUmVuZGVyZXIuYXBwZW5kRWRpdFRhc2tGb3JtKHRhc2tFbGVtZW50KTtcclxuICAgIGNvbnN0IHRleHRhcmVhcyA9IGVkaXRGb3JtLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwidGV4dGFyZWFcIik7XHJcblxyXG4gICAgWy4uLnRleHRhcmVhc10uZm9yRWFjaCgodGV4dGFyZWEpID0+IHtcclxuICAgICAgdGV4dGFyZWEuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgKGUpID0+IHtcclxuICAgICAgICBpZiAoZS5rZXkgPT09IFwiRW50ZXJcIiAmJiAhZS5zaGlmdEtleSkge1xyXG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgLy8gUHJvZ3JhbWF0aWNhbGx5IHRyaWdnZXIgZm9ybSBzdWJtaXNzaW9uXHJcbiAgICAgICAgICBjb25zdCBzdWJtaXRFdmVudCA9IG5ldyBFdmVudChcInN1Ym1pdFwiLCB7XHJcbiAgICAgICAgICAgIGJ1YmJsZXM6IHRydWUsXHJcbiAgICAgICAgICAgIGNhbmNlbGFibGU6IHRydWUsXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIGVkaXRGb3JtLmRpc3BhdGNoRXZlbnQoc3VibWl0RXZlbnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIC8vIGVkaXRGb3JtXHJcbiAgICAvLyAgIC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInRleHRhcmVhXCIpXHJcbiAgICAvLyAgIC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBzdWJtaXRGb3JtKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBzZXRQcmlvcml0eSA9IChlKSA9PiB7XHJcbiAgICBjb25zdCBjdXJyZW50VGFzayA9IGN1cnJlbnRMaXN0LmdldFRhc2tCeUlkKHRhc2suaWQpO1xyXG4gICAgaWYgKGN1cnJlbnRUYXNrLnByaW9yaXR5KSB7XHJcbiAgICAgIGN1cnJlbnRMaXN0LnVwZGF0ZVRhc2sodGFzay5pZCwgeyBwcmlvcml0eTogZmFsc2UgfSk7XHJcbiAgICAgIGUudGFyZ2V0LmNsb3Nlc3QoXCJpbWdcIikuc3JjID0gXCIuLi9zcmMvaW1ncy9ub3VuLXN0YXItNDQ4NTc0Ni5zdmdcIjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGN1cnJlbnRMaXN0LnVwZGF0ZVRhc2sodGFzay5pZCwgeyBwcmlvcml0eTogdHJ1ZSB9KTtcclxuICAgICAgZS50YXJnZXQuY2xvc2VzdChcImltZ1wiKS5zcmMgPSBcIi4uL3NyYy9pbWdzL25vdW4tc3Rhci00NDg1ODI3LnN2Z1wiO1xyXG4gICAgfVxyXG4gICAgZS50YXJnZXQuY2xvc2VzdChcIi50YXNrXCIpLmNsYXNzTGlzdC50b2dnbGUoXCJpc1ByaW9yaXR5XCIpO1xyXG4gICAgZS50YXJnZXQuY2xvc2VzdChcImltZ1wiKS5jbGFzc0xpc3QudG9nZ2xlKFwiZmlsdGVyLWdyYXlcIik7XHJcbiAgICBlLnRhcmdldC5jbG9zZXN0KFwiaW1nXCIpLmNsYXNzTGlzdC50b2dnbGUoXCJmaWx0ZXIteWVsbG93XCIpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGRlbGV0ZVRhc2sgPSAoZSkgPT4ge1xyXG4gICAgY3VycmVudExpc3QucmVtb3ZlVGFzayh0YXNrLmlkKTtcclxuICAgIHB1YlN1Yi5wdWJsaXNoKFwidGFza0RlbGV0ZWRcIiwgeyBsaXN0OiBjdXJyZW50TGlzdCwgdGFzayB9KTtcclxuICAgIGUudGFyZ2V0LmNsb3Nlc3QoXCIudGFza1wiKS5yZW1vdmUoKTtcclxuICB9O1xyXG5cclxuICByZXR1cm4geyBzZXRFZGl0TW9kZSwgc2V0UHJpb3JpdHksIGRlbGV0ZVRhc2sgfTtcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IFRvb2xiYXJFdmVudEhhbmRsZXI7XHJcbiIsImltcG9ydCB7IGVkaXRUYXNrLCB0b2dnbGVEZXRhaWxzIH0gZnJvbSBcIi4uLy4uL0V2ZW50SGFuZGxlci5qc1wiO1xyXG5pbXBvcnQgeyBjcmVhdGVDdXN0b21FbGVtZW50IH0gZnJvbSBcIi4uLy4uL0hlbHBlcnMvY3VzdG9tRWxlbWVudEhlbHBlci5qc1wiO1xyXG5pbXBvcnQgZm9ybWF0RGF0ZSBmcm9tIFwiLi4vLi4vSGVscGVycy9mb3JtYXREYXRlSGVscGVyLmpzXCI7XHJcbmltcG9ydCBUb29sYmFyIGZyb20gXCIuLi8uLi9Ub29sYmFyL1Rvb2xiYXIuanNcIjtcclxuaW1wb3J0IHB1YlN1YiBmcm9tIFwiLi4vLi4vcHViU3ViLmpzXCI7XHJcblxyXG5wdWJTdWIuc3Vic2NyaWJlKFwidGFza0NyZWF0ZWRcIiwgcmVuZGVyVGFzayk7XHJcbnB1YlN1Yi5zdWJzY3JpYmUoXCJ0YXNrUmVjb25zdHJ1Y3RlZFwiLCByZW5kZXJUYXNrKTtcclxuXHJcbmZ1bmN0aW9uIHJlbmRlclRhc2soZGF0YSkge1xyXG4gIGNvbnNvbGUubG9nKFwiUmVuZGVyaW5nIHRhc2tcIik7XHJcbiAgY29uc3QgeyBsaXN0LCB0YXNrIH0gPSBkYXRhO1xyXG4gIF9fYXBwZW5kVGFza0VsZW1lbnRzKGxpc3QsIHRhc2spO1xyXG59XHJcblxyXG5jb25zdCBfX2FwcGVuZFRhc2tFbGVtZW50cyA9IChsaXN0LCB0YXNrKSA9PiB7XHJcbiAgY29uc3QgbGlzdENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLWlkPVwiJHtsaXN0LmdldElkKCl9XCJdYCk7XHJcbiAgY29uc3QgdGFza3NDb250YWluZXIgPSBsaXN0Q29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoXCIudGFza3MtY29udGFpbmVyXCIpO1xyXG5cclxuICBjb25zdCB0YXNrRWxlbWVudHMgPSBfX2NyZWF0ZVRhc2tFbGVtZW50cyhsaXN0LCB0YXNrKTtcclxuICB0YXNrc0NvbnRhaW5lci5wcmVwZW5kKHRhc2tFbGVtZW50cyk7XHJcbn07XHJcblxyXG5jb25zdCBfX2NyZWF0ZVRhc2tFbGVtZW50cyA9IChjdXJyZW50TGlzdCwgdGFzaykgPT4ge1xyXG4gIC8vIERpdiBjb250YWluZXJcclxuICBjb25zdCB0YXNrQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICB0YXNrQ29udGFpbmVyLmNsYXNzTmFtZSA9IFwidGFza1wiO1xyXG4gIHRhc2tDb250YWluZXIuZGF0YXNldC5pZCA9IHRhc2suaWQ7XHJcblxyXG4gIC8vIFRvb2xiYXJcclxuICBjb25zdCB0b29sYmFyQ3JlYXRvciA9IFRvb2xiYXIoY3VycmVudExpc3QsIHRhc2spO1xyXG4gIGNvbnN0IHRvb2xiYXIgPSB0b29sYmFyQ3JlYXRvci5jcmVhdGVUb29sYmFyKGN1cnJlbnRMaXN0LCB0YXNrQ29udGFpbmVyKTtcclxuXHJcbiAgLy8gTWFpbiBkZXRhaWxzXHJcbiAgY29uc3QgbWFpbkRldGFpbHMgPSBfX3JlbmRlck1haW5EZXRhaWxzKHRhc2spO1xyXG5cclxuICAvLyBCb3R0b20gUGFuZWxcclxuICBjb25zdCBib3R0b21QYW5lbCA9IF9fcmVuZGVyQm90dG9tUGFuZWwoY3VycmVudExpc3QsIHRhc2suaWQpO1xyXG5cclxuICB0YXNrQ29udGFpbmVyLmFwcGVuZCh0b29sYmFyKTtcclxuICB0YXNrQ29udGFpbmVyLmFwcGVuZChtYWluRGV0YWlscyk7XHJcbiAgdGFza0NvbnRhaW5lci5hcHBlbmQoYm90dG9tUGFuZWwpO1xyXG5cclxuICAvLyBBZGQgb25jbGljayB0byBjaGFuZ2UgZWxlbWVudCB0byBpbnB1dCBvbiBjbGlja1xyXG4gIHRhc2tDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcihcImRibGNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICBlZGl0VGFzayhlLCB0YXNrLmlkLCBjdXJyZW50TGlzdCk7XHJcbiAgfSk7XHJcblxyXG4gIHRhc2tDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICB0b2dnbGVEZXRhaWxzKGUsIGN1cnJlbnRMaXN0LCB0YXNrLmlkKTtcclxuICB9KTtcclxuXHJcbiAgdGFza0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdmVyXCIsICgpID0+IHtcclxuICAgIHRvb2xiYXIuc3R5bGUub3BhY2l0eSA9IFwiMVwiO1xyXG4gICAgdG9vbGJhci5zdHlsZS52aXNpYmlsaXR5ID0gXCJ2aXNpYmxlXCI7XHJcbiAgfSk7XHJcblxyXG4gIHRhc2tDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlb3V0XCIsICgpID0+IHtcclxuICAgIHRvb2xiYXIuc3R5bGUub3BhY2l0eSA9IFwiMFwiO1xyXG4gICAgdG9vbGJhci5zdHlsZS52aXNpYmlsaXR5ID0gXCJoaWRkZW5cIjtcclxuICB9KTtcclxuXHJcbiAgLy8gdG9vbGJhci5hZGRFdmVudExpc3RlbmVyKFwibW91c2VvdmVyXCIsIChlKSA9PiB7XHJcbiAgLy8gICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gIC8vICAgdG9vbGJhci5zdHlsZS5vcGFjaXR5ID0gXCIxXCI7XHJcbiAgLy8gICB0b29sYmFyLnN0eWxlLnZpc2liaWxpdHkgPSBcInZpc2libGVcIjtcclxuICAvLyB9KTtcclxuXHJcbiAgcmV0dXJuIHRhc2tDb250YWluZXI7XHJcbn07XHJcblxyXG5jb25zdCBfX3JlbmRlck1haW5EZXRhaWxzID0gKHRhc2spID0+IHtcclxuICBjb25zdCBtYWluRGV0YWlsc0NvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgbWFpbkRldGFpbHNDb250YWluZXIuY2xhc3NMaXN0LmFkZChcIm1haW4tZGV0YWlsc1wiKTtcclxuICBtYWluRGV0YWlsc0NvbnRhaW5lci5hcHBlbmRDaGlsZChjcmVhdGVNYWluRGV0YWlsc0VsZW1lbnRzKHRhc2spKTtcclxuICByZXR1cm4gbWFpbkRldGFpbHNDb250YWluZXI7XHJcbn07XHJcblxyXG5jb25zdCBjcmVhdGVNYWluRGV0YWlsc0VsZW1lbnRzID0gKHRhc2spID0+IHtcclxuICBjb25zdCBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcclxuXHJcbiAgY29uc3QgdGl0bGUgPSBjcmVhdGVDdXN0b21FbGVtZW50KHtcclxuICAgIHRhZ05hbWU6IFwicFwiLFxyXG4gICAgY2xhc3NMaXN0OiBcInRhc2stdGl0bGVcIixcclxuICAgIHRleHRDb250ZW50OiB0YXNrLnRpdGxlLFxyXG4gIH0pO1xyXG5cclxuICBjb25zdCBkZXNjcmlwdGlvbiA9IHRhc2suZGVzY3JpcHRpb25cclxuICAgID8gY3JlYXRlQ3VzdG9tRWxlbWVudCh7XHJcbiAgICAgICAgdGFnTmFtZTogXCJwXCIsXHJcbiAgICAgICAgY2xhc3NMaXN0OiBcInRhc2stZGVzY3JpcHRpb25cIixcclxuICAgICAgICB0ZXh0Q29udGVudDogdGFzay5kZXNjcmlwdGlvbixcclxuICAgICAgfSlcclxuICAgIDogXCIgXCI7XHJcblxyXG4gIGZyYWdtZW50LmFwcGVuZCh0aXRsZSwgZGVzY3JpcHRpb24pO1xyXG4gIHJldHVybiBmcmFnbWVudDtcclxufTtcclxuXHJcbmNvbnN0IHJlbmRlckV4cGFuZGVkVGFzayA9ICh0YXJnZXQsIHRhc2spID0+IHtcclxuICBjb25zdCBleHBhbmRlZFRhc2sgPSBfX2NyZWF0ZUV4cGFuZGVkVGFzayh0YXNrKTtcclxuICB0YXJnZXQuYWZ0ZXIoZXhwYW5kZWRUYXNrKTtcclxuICByZXR1cm4gZXhwYW5kZWRUYXNrO1xyXG59O1xyXG5cclxuY29uc3QgX19jcmVhdGVFeHBhbmRlZFRhc2sgPSAodGFzaykgPT4ge1xyXG4gIGNvbnN0IHsgZHVlRGF0ZSwgZGlmZmljdWx0eSB9ID0gdGFzaztcclxuICBjb25zdCBmcmFnbWVudCA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcclxuICAvLyBBcHBlbmQgY2hpbGRyZW4gdG8gZnJhZ21lbnRcclxuICBjb25zdCBleHBhbmRlZERpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XHJcbiAgLy8gU2V0IHRvZ2dsZSBhdHRyaWJ1dGUgdG8gd29yayB3aXRoIHRvZ2dsZSBldmVudCBsaXN0ZW5lclxyXG4gIGV4cGFuZGVkRGl2LmNsYXNzTGlzdC5hZGQoXCJleHBhbmRlZC1kZXRhaWxzXCIpO1xyXG4gIGZyYWdtZW50LmFwcGVuZChleHBhbmRlZERpdik7XHJcblxyXG4gIC8vIGR1ZURhdGUgJiZcclxuICBleHBhbmRlZERpdi5hcHBlbmQoXHJcbiAgICBjcmVhdGVDdXN0b21FbGVtZW50KHtcclxuICAgICAgdGFnTmFtZTogXCJwXCIsXHJcbiAgICAgIGNsYXNzTGlzdDogXCJkdWUtZGF0ZVwiLFxyXG4gICAgICB0ZXh0Q29udGVudDogZm9ybWF0RGF0ZShkdWVEYXRlKSxcclxuICAgIH0pXHJcbiAgKTtcclxuXHJcbiAgLy8gZGlmZmljdWx0eSAmJlxyXG4gIGV4cGFuZGVkRGl2LmFwcGVuZChcclxuICAgIGNyZWF0ZUN1c3RvbUVsZW1lbnQoe1xyXG4gICAgICB0YWdOYW1lOiBcInBcIixcclxuICAgICAgY2xhc3NMaXN0OiBcImRpZmZpY3VsdHlcIixcclxuICAgICAgdGV4dENvbnRlbnQ6IGRpZmZpY3VsdHksXHJcbiAgICB9KVxyXG4gICk7XHJcbiAgcmV0dXJuIGZyYWdtZW50O1xyXG59O1xyXG5cclxuY29uc3QgX19yZW5kZXJCb3R0b21QYW5lbCA9IChjdXJyZW50TGlzdCwgdGFza0lkKSA9PiB7XHJcbiAgY29uc3QgdGFzayA9IGN1cnJlbnRMaXN0LmdldFRhc2tCeUlkKHRhc2tJZCk7XHJcbiAgY29uc3QgYm90dG9tUGFuZWwgPSBjcmVhdGVDdXN0b21FbGVtZW50KHtcclxuICAgIHRhZ05hbWU6IFwiZGl2XCIsXHJcbiAgICBjbGFzc0xpc3Q6IFwiYm90dG9tLXBhbmVsXCIsXHJcbiAgfSk7XHJcbiAgYm90dG9tUGFuZWwuYXBwZW5kKGNyZWF0ZUJvdHRvbVBhbmVsRWxlbWVudHModGFzaykpO1xyXG4gIHJldHVybiBib3R0b21QYW5lbDtcclxufTtcclxuXHJcbmNvbnN0IGNyZWF0ZUJvdHRvbVBhbmVsRWxlbWVudHMgPSAodGFzaykgPT4ge1xyXG4gIGNvbnN0IGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xyXG5cclxuICBjb25zdCBnZXRUYXNrRGlmZmljdWx0eSA9IChkaWZmaWN1bHR5KSA9PiB7XHJcbiAgICBzd2l0Y2ggKGRpZmZpY3VsdHkpIHtcclxuICAgICAgY2FzZSBcIkVhc3lcIjpcclxuICAgICAgICByZXR1cm4gXCLimpTvuI9cIjtcclxuICAgICAgY2FzZSBcIk1lZGl1bVwiOlxyXG4gICAgICAgIHJldHVybiBcIuKalO+4j+KalO+4j1wiO1xyXG4gICAgICBjYXNlIFwiSGFyZFwiOlxyXG4gICAgICAgIHJldHVybiBcIuKalO+4j+KalO+4j+KalO+4j1wiO1xyXG4gICAgICBkZWZhdWx0OlxyXG4gICAgICAgIHJldHVybiBcIlwiO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGNvbnN0IGRpZmZpY3VsdHlFbCA9IGNyZWF0ZUN1c3RvbUVsZW1lbnQoe1xyXG4gICAgdGFnTmFtZTogXCJwXCIsXHJcbiAgICB0ZXh0Q29udGVudDogZ2V0VGFza0RpZmZpY3VsdHkodGFzay5kaWZmaWN1bHR5KSxcclxuICB9KTtcclxuXHJcbiAgY29uc3QgZHVlRGF0ZUVsID0gY3JlYXRlQ3VzdG9tRWxlbWVudCh7XHJcbiAgICB0YWdOYW1lOiBcInBcIixcclxuICAgIHRleHRDb250ZW50OiBmb3JtYXREYXRlKHRhc2suZHVlRGF0ZSkgfHwgXCJcIixcclxuICB9KTtcclxuXHJcbiAgZnJhZ21lbnQuYXBwZW5kKGR1ZURhdGVFbCwgZGlmZmljdWx0eUVsKTtcclxuICByZXR1cm4gZnJhZ21lbnQ7XHJcbn07XHJcblxyXG5leHBvcnQge1xyXG4gIHJlbmRlckV4cGFuZGVkVGFzayxcclxuICBjcmVhdGVNYWluRGV0YWlsc0VsZW1lbnRzLFxyXG4gIGNyZWF0ZUJvdHRvbVBhbmVsRWxlbWVudHMsXHJcbn07XHJcbiIsImltcG9ydCB7IHJlbmRlckV4cGFuZGVkVGFzayB9IGZyb20gXCIuL0xpc3QvdGFzay9UYXNrUmVuZGVyZXIuanNcIjtcclxuaW1wb3J0IHB1YnN1YiBmcm9tIFwiLi9wdWJTdWIuanNcIjtcclxuXHJcbmNvbnN0IGNyZWF0ZUxpc3QgPSAoZSwgY3VycmVudFByb2plY3QpID0+IHtcclxuICBpZiAoZS5rZXkgPT09IFwiRW50ZXJcIikge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgY29uc3QgdGl0bGUgPSBlLnRhcmdldC52YWx1ZTtcclxuICAgIGNvbnN0IG5ld0xpc3QgPSBjdXJyZW50UHJvamVjdC5jcmVhdGVMaXN0KHRpdGxlKTtcclxuICAgIGUudGFyZ2V0LnZhbHVlID0gXCJcIjtcclxuXHJcbiAgICBwdWJzdWIucHVibGlzaChcImxpc3RDcmVhdGVkXCIsIG5ld0xpc3QpO1xyXG4gIH1cclxufTtcclxuXHJcbmNvbnN0IGNyZWF0ZVRhc2sgPSAoZSwgbGlzdCkgPT4ge1xyXG4gIGlmIChlLmtleSA9PT0gXCJFbnRlclwiKSB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBjb25zdCB0aXRsZSA9IGUudGFyZ2V0LnZhbHVlO1xyXG4gICAgY29uc3QgbmV3VGFzayA9IGxpc3QuY3JlYXRlVGFzayh0aXRsZSk7XHJcblxyXG4gICAgZS50YXJnZXQudmFsdWUgPSBcIlwiO1xyXG5cclxuICAgIHB1YnN1Yi5wdWJsaXNoKFwidGFza0NyZWF0ZWRcIiwgeyBsaXN0LCB0YXNrOiBuZXdUYXNrIH0pO1xyXG4gIH1cclxufTtcclxuXHJcbmZ1bmN0aW9uIGF1dG9SZXNpemUoKSB7XHJcbiAgdGhpcy5zdHlsZS5oZWlnaHQgPSBcImF1dG9cIjtcclxuICB0aGlzLnN0eWxlLmhlaWdodCA9IHRoaXMuc2Nyb2xsSGVpZ2h0ICsgXCJweFwiO1xyXG59XHJcblxyXG4vLyBSZWZhY3RvciB0aGlzIG1lc3MgbGF0ZXJcclxuY29uc3QgZWRpdFRhc2sgPSAoZSwgdGFza0lkLCBjdXJyZW50TGlzdCkgPT4ge1xyXG4gIGNvbnN0IGVsID0gZS50YXJnZXQ7XHJcbiAgaWYgKCFlbC5jbGFzc0xpc3QuY29udGFpbnMoXCJ0YXNrLXRpdGxlXCIpKSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIGNvbnN0IHByZXZpb3VzID0gZWwuY2xvbmVOb2RlKHRydWUpO1xyXG4gIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRleHRhcmVhXCIpO1xyXG4gIGNvbnN0IGN1cnJlbnRUYXNrID0gY3VycmVudExpc3QuZ2V0VGFza0J5SWQodGFza0lkKTtcclxuXHJcbiAgaW5wdXQuY2xhc3NMaXN0LmFkZChcInRlbXAtaW5wdXRcIik7XHJcbiAgaW5wdXQudmFsdWUgPSBjdXJyZW50VGFzay50aXRsZTtcclxuICAvLyBpbnB1dC5zdHlsZS53cmFwID0gXCJzb2Z0XCI7XHJcbiAgaW5wdXQuc3R5bGUud29yZEJyZWFrID0gXCJicmVhay13b3JkXCI7XHJcblxyXG4gIGVsLnJlcGxhY2VXaXRoKGlucHV0KTtcclxuICBpbnB1dC5zdHlsZS5oZWlnaHQgPSBcImF1dG9cIjtcclxuICBpbnB1dC5zdHlsZS5oZWlnaHQgPSBpbnB1dC5zY3JvbGxIZWlnaHQgKyBcInB4XCI7XHJcblxyXG4gIGNvbnN0IHNhdmUgPSAoKSA9PiB7XHJcbiAgICAvLyBTYXZlIHRoZSBpbnB1dCB2YWx1ZSBpbnRvIHRoZSBzZWxlY3RlZCB0YXNrXHJcbiAgICBjdXJyZW50TGlzdC51cGRhdGVUYXNrKHRhc2tJZCwgeyB0aXRsZTogaW5wdXQudmFsdWUgfSk7XHJcbiAgICBwcmV2aW91cy50ZXh0Q29udGVudCA9IGlucHV0LnZhbHVlO1xyXG4gICAgaW5wdXQucmVwbGFjZVdpdGgocHJldmlvdXMpO1xyXG4gIH07XHJcblxyXG4gIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChlKSA9PiB7XHJcbiAgICBpZiAoZS5rZXkgPT09IFwiRW50ZXJcIikge1xyXG4gICAgICBpbnB1dC5ibHVyKCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIHNhdmUsIHtcclxuICAgIG9uY2U6IHRydWUsXHJcbiAgfSk7XHJcblxyXG4gIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBhdXRvUmVzaXplLCBmYWxzZSk7XHJcbiAgaW5wdXQuZm9jdXMoKTtcclxufTtcclxuXHJcbmNvbnN0IHRvZ2dsZURldGFpbHMgPSAoZSwgY3VycmVudExpc3QsIHRhc2tJZCkgPT4ge1xyXG4gIC8vIERvIG5vdCB0b2dnbGUgaWYgdGFzayBpcyBpbiBFZGl0IE1vZGUgb3IgaWYgdGhlIHRhcmdldCBpcyBub3QgdGhlIHRhc2tcclxuICBpZiAoXHJcbiAgICBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJpc0VkaXRhYmxlXCIpIHx8XHJcbiAgICAhZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwidGFza1wiKVxyXG4gICkge1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgdGFza0NvbnRhaW5lciA9IGUudGFyZ2V0O1xyXG4gIGNvbnN0IG1haW5EZXRhaWxzID0gdGFza0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLm1haW4tZGV0YWlsc1wiKTtcclxuXHJcbiAgY29uc3QgZXhwYW5kZWREZXRhaWxzID0gdGFza0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yKFwiLmV4cGFuZGVkLWRldGFpbHNcIik7XHJcblxyXG4gIGlmICghZXhwYW5kZWREZXRhaWxzKSB7XHJcbiAgICBjb25zdCB0YXNrID0gY3VycmVudExpc3QuZ2V0VGFza0J5SWQodGFza0lkKTtcclxuICAgIHJlbmRlckV4cGFuZGVkVGFzayhtYWluRGV0YWlscywgdGFzayk7XHJcbiAgICB0YXNrQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJleHBhbmRlZFwiKTtcclxuICB9IGVsc2Uge1xyXG4gICAgZXhwYW5kZWREZXRhaWxzLnJlbW92ZSgpO1xyXG4gICAgdGFza0NvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwiZXhwYW5kZWRcIik7XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IHsgY3JlYXRlTGlzdCwgY3JlYXRlVGFzaywgZWRpdFRhc2ssIHRvZ2dsZURldGFpbHMgfTtcclxuIiwiaW1wb3J0IHJlbmRlckxpc3QgZnJvbSBcIi4vTGlzdFJlbmRlcmVyLmpzXCI7XHJcbmltcG9ydCBwdWJTdWIgZnJvbSBcIi4uL3B1YlN1Yi5qc1wiO1xyXG5pbXBvcnQgeyBhdXRvUmVzaXplIH0gZnJvbSBcIi4uL0V2ZW50SGFuZGxlci5qc1wiO1xyXG5cclxuLypcclxuICBGbG93OlxyXG4gIFJldHJpZXZlIGxvY2FsU3RvcmFnZVxyXG4gIElmIG5vIHN0b3JhZ2UgaXMgYXZhaWxhYmxlLCB0aGVuIGNyZWF0ZSB0aGUgZGVmYXVsdCBsaXN0LlxyXG4gIEVsc2UsIHJlbmRlciB0aGUgc3RvcmVkIExpc3QuXHJcbiAgICBUaGVuLCByZW5kZXIgdGhlIHN0b3JlZCB0YXNrcyBpZiB0aGVyZSBhcmUgdGFza3NcclxuXHJcbiovXHJcblxyXG5jb25zdCBjcmVhdGVEZWZhdWx0TGlzdCA9IChkZWZhdWx0UHJvamVjdCkgPT4ge1xyXG4gIGNvbnN0IGhhYml0TGlzdCA9IGRlZmF1bHRQcm9qZWN0LmNyZWF0ZUxpc3QoXCJIYWJpdHNcIik7XHJcbiAgY29uc3QgZmlyc3RUYXNrID0gaGFiaXRMaXN0LmNyZWF0ZVRhc2soXCJDcmVhdGUgeW91ciBmaXJzdCBoYWJpdCFcIik7XHJcbiAgcHViU3ViLnB1Ymxpc2goXCJsaXN0Q3JlYXRlZFwiLCBoYWJpdExpc3QpO1xyXG4gIHB1YlN1Yi5wdWJsaXNoKFwidGFza0NyZWF0ZWRcIiwgeyBsaXN0OiBoYWJpdExpc3QsIHRhc2s6IGZpcnN0VGFzayB9KTtcclxufTtcclxuXHJcbmNvbnN0IGVkaXRUaXRsZSA9IChlLCBsaXN0KSA9PiB7XHJcbiAgY29uc3QgZWwgPSBlLnRhcmdldDtcclxuXHJcbiAgY29uc3QgcHJldmlvdXMgPSBlbC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGV4dGFyZWFcIik7XHJcblxyXG4gIGlucHV0LmNsYXNzTGlzdC5hZGQoXCJ0ZW1wLWlucHV0XCIpO1xyXG4gIGlucHV0LnZhbHVlID0gbGlzdC5nZXRUaXRsZSgpO1xyXG4gIC8vIGlucHV0LnN0eWxlLndyYXAgPSBcInNvZnRcIjtcclxuICBpbnB1dC5zdHlsZS53b3JkQnJlYWsgPSBcImJyZWFrLXdvcmRcIjtcclxuXHJcbiAgZWwucmVwbGFjZVdpdGgoaW5wdXQpO1xyXG4gIGlucHV0LnN0eWxlLmhlaWdodCA9IFwiYXV0b1wiO1xyXG4gIGlucHV0LnN0eWxlLmhlaWdodCA9IGlucHV0LnNjcm9sbEhlaWdodCArIFwicHhcIjtcclxuXHJcbiAgY29uc3Qgc2F2ZSA9ICgpID0+IHtcclxuICAgIC8vIFNhdmUgdGhlIGlucHV0IHZhbHVlIGludG8gdGhlIHNlbGVjdGVkIExpc3Qgb2JqZWN0XHJcbiAgICBjb25zdCB0aXRsZSA9IGxpc3Quc2V0VGl0bGUoaW5wdXQudmFsdWUpO1xyXG4gICAgcHViU3ViLnB1Ymxpc2goXCJsaXN0VXBkYXRlZFwiLCB7IGxpc3QsIHRpdGxlIH0pO1xyXG4gICAgcHJldmlvdXMudGV4dENvbnRlbnQgPSBpbnB1dC52YWx1ZTtcclxuICAgIGlucHV0LnJlcGxhY2VXaXRoKHByZXZpb3VzKTtcclxuICAgIC8vIFJlY3Vyc2l2ZWx5IHJlY2FsbCB0aGUgZXZlbnQgaGFuZGxlclxyXG4gICAgcHJldmlvdXMuYWRkRXZlbnRMaXN0ZW5lcihcImRibGNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICAgIGVkaXRUaXRsZShlLCBsaXN0KTtcclxuICAgIH0pO1xyXG4gIH07XHJcblxyXG4gIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChlKSA9PiB7XHJcbiAgICBpZiAoZS5rZXkgPT09IFwiRW50ZXJcIikge1xyXG4gICAgICBpbnB1dC5ibHVyKCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIHNhdmUsIHtcclxuICAgIG9uY2U6IHRydWUsXHJcbiAgfSk7XHJcblxyXG4gIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBhdXRvUmVzaXplLCBmYWxzZSk7XHJcbiAgaW5wdXQuZm9jdXMoKTtcclxufTtcclxuXHJcbi8vIE1heSBiZSB1c2VsZXNzIG5vd1xyXG5cclxuLy8gY29uc3QgY2hlY2tGb3JMaXN0cyA9IChjdXJyZW50UHJvamVjdCkgPT4ge1xyXG4vLyAgIGNvbnNvbGUubG9nKGN1cnJlbnRQcm9qZWN0KTtcclxuLy8gICBjb25zdCBsaXN0cyA9IGN1cnJlbnRQcm9qZWN0LmdldExpc3RzKCk7XHJcbi8vICAgaWYgKGxpc3RzLmxlbmd0aCkge1xyXG4vLyAgICAgLy8gVGhpcyBpcyByZW5kZXJpbmcgZXZlcnkgdGFzayB3aXRoaW4gdGhlIGxpc3QgcmlnaHQgbm93IGV2ZW4gaWYgdGhlcmUgYXJlIG5vbmUuXHJcbi8vICAgICBsaXN0cy5mb3JFYWNoKChsaXN0KSA9PiByZW5kZXJMaXN0KGxpc3QpKTtcclxuLy8gICB9IGVsc2Uge1xyXG4vLyAgICAgY3JlYXRlRGVmYXVsdExpc3QoY3VycmVudFByb2plY3QpO1xyXG4vLyAgIH1cclxuLy8gfTtcclxuXHJcbmV4cG9ydCB7IGNyZWF0ZURlZmF1bHRMaXN0LCBlZGl0VGl0bGUgfTtcclxuIiwiaW1wb3J0IHtcclxuICBhcHBlbmRDdXN0b21FbGVtZW50LFxyXG4gIGNyZWF0ZUN1c3RvbUVsZW1lbnQsXHJcbn0gZnJvbSBcIi4uL0hlbHBlcnMvY3VzdG9tRWxlbWVudEhlbHBlci5qc1wiO1xyXG5pbXBvcnQgeyBjcmVhdGVUYXNrIH0gZnJvbSBcIi4uL0V2ZW50SGFuZGxlci5qc1wiO1xyXG5pbXBvcnQgeyBlZGl0VGl0bGUgfSBmcm9tIFwiLi4vTGlzdC9MaXN0SGFuZGxlci5qc1wiO1xyXG5pbXBvcnQgcHViU3ViIGZyb20gXCIuLi9wdWJTdWIuanNcIjtcclxuXHJcbnB1YlN1Yi5zdWJzY3JpYmUoXCJsaXN0Q3JlYXRlZFwiLCByZW5kZXJMaXN0KTtcclxucHViU3ViLnN1YnNjcmliZShcImxpc3RSZWNvbnN0cnVjdGVkXCIsIHJlbmRlckxpc3QpO1xyXG5cclxuZnVuY3Rpb24gcmVuZGVyTGlzdChsaXN0KSB7XHJcbiAgY29uc29sZS5sb2coXCJSZW5kZXJpbmcgTGlzdFwiKTtcclxuICAvLyBMaXN0IEVsZW1lbnRzXHJcbiAgX19hcHBlbmRMaXN0Q29udGFpbmVyKGxpc3QpO1xyXG4gIF9fYXBwZW5kVGl0bGVFbGVtZW50KGxpc3QpO1xyXG5cclxuICAvLyBUYXNrIEVsZW1lbnRcclxuICBfX2FwcGVuZFRhc2tDb250YWluZXIobGlzdCk7XHJcbn1cclxuXHJcbmNvbnN0IF9fYXBwZW5kTGlzdENvbnRhaW5lciA9IChsaXN0KSA9PiB7XHJcbiAgYXBwZW5kQ3VzdG9tRWxlbWVudCh7XHJcbiAgICB0YXJnZXQ6IFwiLmxpc3RzLWNvbnRhaW5lclwiLFxyXG4gICAgdGFnTmFtZTogXCJkaXZcIixcclxuICAgIGNsYXNzTGlzdDogW1wibGlzdFwiXSxcclxuICAgIGF0dHJpYnV0ZXM6IFtcImRhdGEtaWRcIiwgbGlzdC5nZXRJZCgpXSxcclxuICB9KTtcclxufTtcclxuXHJcbmNvbnN0IF9fYXBwZW5kVGl0bGVFbGVtZW50ID0gKGxpc3QpID0+IHtcclxuICBjb25zdCBsaXN0RWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLWlkPVwiJHtsaXN0LmdldElkKCl9XCJdYCk7XHJcbiAgY29uc3QgdGl0bGUgPSBjcmVhdGVDdXN0b21FbGVtZW50KHtcclxuICAgIHRhZ05hbWU6IFwiaDJcIixcclxuICAgIGNsYXNzTGlzdDogXCJsaXN0LXRpdGxlXCIsXHJcbiAgICB0ZXh0Q29udGVudDogbGlzdC5nZXRUaXRsZSgpLFxyXG4gIH0pO1xyXG4gIHRpdGxlLmFkZEV2ZW50TGlzdGVuZXIoXCJkYmxjbGlja1wiLCAoZSkgPT4ge1xyXG4gICAgZWRpdFRpdGxlKGUsIGxpc3QpO1xyXG4gIH0pO1xyXG4gIGxpc3RFbGVtZW50LmFwcGVuZCh0aXRsZSwgX19jcmVhdGVUYXNrRm9ybShsaXN0KSk7XHJcbn07XHJcblxyXG5jb25zdCBfX2NyZWF0ZVRhc2tGb3JtID0gKGxpc3QpID0+IHtcclxuICAvLyBDcmVhdGUgZm9ybSBhbmQgYXBwZW5kIGlucHV0IHRvIExpc3RcclxuICBjb25zdCB0YXNrRm9ybSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJmb3JtXCIpO1xyXG4gIHRhc2tGb3JtLmNsYXNzTmFtZSA9IFwidGFzay1mb3JtXCI7XHJcbiAgY29uc3QgdGFza0lucHV0ID0gY3JlYXRlQ3VzdG9tRWxlbWVudCh7XHJcbiAgICB0YWdOYW1lOiBcImlucHV0XCIsXHJcbiAgICBjbGFzc0xpc3Q6IFwidGFzay1pbnB1dFwiLFxyXG4gICAgYXR0cmlidXRlczogW1wicGxhY2Vob2xkZXJcIiwgXCJBZGQgYSB0YXNrXCJdLFxyXG4gIH0pO1xyXG4gIHRhc2tGb3JtLmFwcGVuZENoaWxkKHRhc2tJbnB1dCk7XHJcblxyXG4gIC8vIEJpbmQgaW5wdXQgbGlzdGVuZXIgdG8gbW9uaXRvciBuZXcgdGFzayBlbnRyaWVzXHJcbiAgdGFza0lucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChlKSA9PiB7XHJcbiAgICBjcmVhdGVUYXNrKGUsIGxpc3QpO1xyXG4gIH0pO1xyXG4gIHJldHVybiB0YXNrRm9ybTtcclxufTtcclxuXHJcbmNvbnN0IF9fYXBwZW5kVGFza0NvbnRhaW5lciA9IChsaXN0KSA9PiB7XHJcbiAgYXBwZW5kQ3VzdG9tRWxlbWVudCh7XHJcbiAgICB0YXJnZXQ6IGBbZGF0YS1pZD1cIiR7bGlzdC5nZXRJZCgpfVwiXWAsXHJcbiAgICB0YWdOYW1lOiBcImRpdlwiLFxyXG4gICAgY2xhc3NMaXN0OiBcInRhc2tzLWNvbnRhaW5lclwiLFxyXG4gIH0pO1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgcmVuZGVyTGlzdDtcclxuIiwiaW1wb3J0IHB1YlN1YiBmcm9tIFwiLi9wdWJTdWJcIjtcclxuXHJcbmNvbnN0IHN0b3JlID0gKCgpID0+IHtcclxuICBjb25zdCBwcm9qZWN0cyA9IFtdO1xyXG4gIGxldCBjdXJyZW50UHJvamVjdCA9IG51bGw7XHJcbiAgLy8gUG9wdWxhdGUgcHJvamVjdHMgd2l0aCBhIGxpc3Qgb2YgYWxsIHRoZSBwcm9qZWN0IG5hbWVzIHdpdGhpbiBzdG9yYWdlICsgYWRkIGFueSBuZXdseSBjcmVhdGVkIHByb2plY3RzXHJcblxyXG4gIGNvbnN0IGdldEN1cnJlbnRQcm9qZWN0ID0gKCkgPT4gY3VycmVudFByb2plY3Q7XHJcblxyXG4gIGZ1bmN0aW9uIGFkZFByb2plY3QocHJvamVjdCkge1xyXG4gICAgaWYgKGN1cnJlbnRQcm9qZWN0ID09PSBudWxsKSB7XHJcbiAgICAgIHNldEN1cnJlbnRQcm9qZWN0KHByb2plY3QpO1xyXG4gICAgfVxyXG4gICAgcHJvamVjdHMucHVzaChwcm9qZWN0KTtcclxuICAgIHJldHVybiBwcm9qZWN0cztcclxuICB9XHJcblxyXG4gIGNvbnN0IHNldEN1cnJlbnRQcm9qZWN0ID0gKHByb2plY3QpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKFwiU2V0dGluZyBjdXJyZW50IHByb2plY3Q6IFwiICsgcHJvamVjdC5nZXRUaXRsZSgpKTtcclxuICAgIGN1cnJlbnRQcm9qZWN0ID0gcHJvamVjdDtcclxuICAgIHB1YlN1Yi5wdWJsaXNoKFwiY3VycmVudFByb2plY3RTZXRcIiwge1xyXG4gICAgICB0aXRsZTogcHJvamVjdC5nZXRUaXRsZSgpLFxyXG4gICAgICBpZDogcHJvamVjdC5nZXRJZCgpLFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gY3VycmVudFByb2plY3Q7XHJcbiAgfTtcclxuICByZXR1cm4geyBnZXRDdXJyZW50UHJvamVjdCwgc2V0Q3VycmVudFByb2plY3QgfTtcclxufSkoKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IHN0b3JlO1xyXG4iLCJpbXBvcnQgVGFza01hbmFnZXIgZnJvbSBcIi4vdGFzay9UYXNrTWFuYWdlclwiO1xyXG5cclxuY29uc3QgTGlzdCA9ICh0aXRsZSwgaWQgPSBjcnlwdG8ucmFuZG9tVVVJRCgpLnNsaWNlKDAsIDgpKSA9PiB7XHJcbiAgbGV0IGxpc3RUaXRsZSA9IHRpdGxlO1xyXG4gIGNvbnN0IHRhc2tzID0gW107XHJcbiAgY29uc3QgdGFza01hbmFnZXIgPSBUYXNrTWFuYWdlcih0YXNrcyk7XHJcblxyXG4gIGNvbnN0IGdldFRpdGxlID0gKCkgPT4gbGlzdFRpdGxlO1xyXG4gIGNvbnN0IHNldFRpdGxlID0gKG5ld1RpdGxlKSA9PiAobGlzdFRpdGxlID0gbmV3VGl0bGUpO1xyXG4gIGNvbnN0IGdldElkID0gKCkgPT4gaWQ7XHJcbiAgY29uc3QgZ2V0VGFza3MgPSAoKSA9PiB0YXNrcztcclxuXHJcbiAgY29uc3QgY3JlYXRlVGFzayA9ICh0aXRsZSwgdGFza0lkKSA9PiB7XHJcbiAgICByZXR1cm4gdGFza01hbmFnZXIuY3JlYXRlVGFzayh0aXRsZSwgdGFza0lkKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBnZXRUYXNrQnlJZCA9ICh0YXNrSWQpID0+IHtcclxuICAgIHJldHVybiB0YXNrTWFuYWdlci5nZXRUYXNrQnlJZCh0YXNrSWQpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IHVwZGF0ZVRhc2sgPSAodGFza0lkLCB1cGRhdGVkRW50cnkpID0+IHtcclxuICAgIHJldHVybiB0YXNrTWFuYWdlci51cGRhdGVUYXNrKHRhc2tJZCwgdXBkYXRlZEVudHJ5KTtcclxuICB9O1xyXG5cclxuICBjb25zdCByZW1vdmVUYXNrID0gKHRhc2tJZCkgPT4ge1xyXG4gICAgcmV0dXJuIHRhc2tNYW5hZ2VyLnJlbW92ZVRhc2sodGFza0lkKTtcclxuICB9O1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgZ2V0VGl0bGUsXHJcbiAgICBzZXRUaXRsZSxcclxuICAgIGdldElkLFxyXG4gICAgZ2V0VGFza3MsXHJcbiAgICBjcmVhdGVUYXNrLFxyXG4gICAgZ2V0VGFza0J5SWQsXHJcbiAgICB1cGRhdGVUYXNrLFxyXG4gICAgcmVtb3ZlVGFzayxcclxuICB9O1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgTGlzdDtcclxuIiwiY29uc3QgVGFza01hbmFnZXIgPSAodGFza0xpc3QpID0+IHtcclxuICBjb25zdCBnZXRUYXNrQnlJZCA9ICh0YXNrSWQpID0+IHtcclxuICAgIHJldHVybiB0YXNrTGlzdC5maW5kKCh0YXNrKSA9PiB0YXNrLmlkID09PSB0YXNrSWQpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGdldFRhc2tCeUluZGV4ID0gKHRhc2tJZCkgPT4ge1xyXG4gICAgcmV0dXJuIHRhc2tMaXN0LmZpbmRJbmRleCgodGFzaykgPT4gdGFzay5pZCA9PT0gdGFza0lkKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBjcmVhdGVUYXNrID0gKHRpdGxlLCB0YXNrSWQgPSBjcnlwdG8ucmFuZG9tVVVJRCgpLnNsaWNlKDAsIDgpKSA9PiB7XHJcbiAgICB0YXNrTGlzdC5wdXNoKHtcclxuICAgICAgaWQ6IHRhc2tJZCxcclxuICAgICAgdGl0bGUsXHJcbiAgICB9KTtcclxuICAgIHJldHVybiB0YXNrTGlzdFt0YXNrTGlzdC5sZW5ndGggLSAxXTtcclxuICB9O1xyXG5cclxuICBjb25zdCB1cGRhdGVUYXNrID0gKHRhc2tJZCwgdXBkYXRlZEVudHJ5KSA9PiB7XHJcbiAgICBjb25zdCB0YXNrSW5kZXggPSBnZXRUYXNrQnlJbmRleCh0YXNrSWQpO1xyXG4gICAgdGFza0xpc3RbdGFza0luZGV4XSA9IHsgLi4udGFza0xpc3RbdGFza0luZGV4XSwgLi4udXBkYXRlZEVudHJ5IH07XHJcbiAgICByZXR1cm4gdGFza0xpc3RbdGFza0luZGV4XTtcclxuICB9O1xyXG5cclxuICBjb25zdCByZW1vdmVUYXNrID0gKHRhc2tJZCkgPT4ge1xyXG4gICAgY29uc3QgdGFza0luZGV4ID0gZ2V0VGFza0J5SW5kZXgodGFza0lkKTtcclxuICAgIHRhc2tMaXN0LnNwbGljZSh0YXNrSW5kZXgsIDEpO1xyXG4gIH07XHJcblxyXG4gIHJldHVybiB7IGdldFRhc2tCeUlkLCBjcmVhdGVUYXNrLCB1cGRhdGVUYXNrLCByZW1vdmVUYXNrIH07XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBUYXNrTWFuYWdlcjtcclxuIiwiaW1wb3J0IExpc3QgZnJvbSBcIi4vTGlzdC9MaXN0XCI7XHJcblxyXG5jb25zdCBQcm9qZWN0ID0gKHRpdGxlLCBpZCA9IGNyeXB0by5yYW5kb21VVUlEKCkuc2xpY2UoMCwgOCkpID0+IHtcclxuICBjb25zdCBsaXN0cyA9IFtdO1xyXG5cclxuICBjb25zdCBnZXRUaXRsZSA9ICgpID0+IHRpdGxlO1xyXG4gIGNvbnN0IGdldElkID0gKCkgPT4gaWQ7XHJcbiAgY29uc3QgZ2V0TGlzdHMgPSAoKSA9PiBsaXN0cztcclxuXHJcbiAgY29uc3QgY3JlYXRlTGlzdCA9ICh0aXRsZSwgaWQpID0+IHtcclxuICAgIGxpc3RzLnB1c2goTGlzdCh0aXRsZSwgaWQpKTtcclxuICAgIHJldHVybiBsaXN0c1tsaXN0cy5sZW5ndGggLSAxXTtcclxuICB9O1xyXG5cclxuICBjb25zdCBnZXRMaXN0QnlJZCA9IChsaXN0SWQpID0+IHtcclxuICAgIGNvbnN0IGxpc3RJbmRleCA9IGxpc3RzLmZpbmRJbmRleCgobGlzdCkgPT4gbGlzdC5nZXRJZCgpID09PSBsaXN0SWQpO1xyXG5cclxuICAgIHJldHVybiBsaXN0c1tsaXN0SW5kZXhdO1xyXG4gIH07XHJcblxyXG4gIHJldHVybiB7IGdldFRpdGxlLCBnZXRJZCwgZ2V0TGlzdHMsIGNyZWF0ZUxpc3QsIGdldExpc3RCeUlkIH07XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQcm9qZWN0O1xyXG4iLCJpbXBvcnQgUHJvamVjdCBmcm9tIFwiLi9Qcm9qZWN0XCI7XHJcbmltcG9ydCBwdWJTdWIgZnJvbSBcIi4vcHViU3ViLmpzXCI7XHJcbmltcG9ydCBzdG9yZSBmcm9tIFwiLi9zdG9yZS5qc1wiO1xyXG5pbXBvcnQgeyBjcmVhdGVEZWZhdWx0UHJvamVjdCB9IGZyb20gXCIuL1Byb2plY3RIYW5kbGVyXCI7XHJcblxyXG5mdW5jdGlvbiBzdG9yYWdlQXZhaWxhYmxlKCkge1xyXG4gIHRyeSB7XHJcbiAgICB2YXIgc3RvcmFnZSA9IHdpbmRvd1tcImxvY2FsU3RvcmFnZVwiXSxcclxuICAgICAgeCA9IFwiX19zdG9yYWdlX3Rlc3RfX1wiO1xyXG4gICAgc3RvcmFnZS5zZXRJdGVtKHgsIHgpO1xyXG4gICAgc3RvcmFnZS5yZW1vdmVJdGVtKHgpO1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfSBjYXRjaCAoZSkge1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgZSBpbnN0YW5jZW9mIERPTUV4Y2VwdGlvbiAmJlxyXG4gICAgICAvLyBldmVyeXRoaW5nIGV4Y2VwdCBGaXJlZm94XHJcbiAgICAgIChlLmNvZGUgPT09IDIyIHx8XHJcbiAgICAgICAgLy8gRmlyZWZveFxyXG4gICAgICAgIGUuY29kZSA9PT0gMTAxNCB8fFxyXG4gICAgICAgIC8vIHRlc3QgbmFtZSBmaWVsZCB0b28sIGJlY2F1c2UgY29kZSBtaWdodCBub3QgYmUgcHJlc2VudFxyXG4gICAgICAgIC8vIGV2ZXJ5dGhpbmcgZXhjZXB0IEZpcmVmb3hcclxuICAgICAgICBlLm5hbWUgPT09IFwiUXVvdGFFeGNlZWRlZEVycm9yXCIgfHxcclxuICAgICAgICAvLyBGaXJlZm94XHJcbiAgICAgICAgZS5uYW1lID09PSBcIk5TX0VSUk9SX0RPTV9RVU9UQV9SRUFDSEVEXCIpICYmXHJcbiAgICAgIC8vIGFja25vd2xlZGdlIFF1b3RhRXhjZWVkZWRFcnJvciBvbmx5IGlmIHRoZXJlJ3Mgc29tZXRoaW5nIGFscmVhZHkgc3RvcmVkXHJcbiAgICAgIHN0b3JhZ2UgJiZcclxuICAgICAgc3RvcmFnZS5sZW5ndGggIT09IDBcclxuICAgICk7XHJcbiAgfVxyXG59XHJcblxyXG5jb25zdCBfX3N0cmluZ2lmeUpTT04gPSAob2JqKSA9PiB7XHJcbiAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KG9iaik7XHJcbn07XHJcblxyXG5jb25zdCByZXRyaWV2ZUl0ZW0gPSAoa2V5KSA9PiB7XHJcbiAgY29uc3Qgc3RvcmVkU3RyaW5nID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oa2V5KTtcclxuICByZXR1cm4gSlNPTi5wYXJzZShzdG9yZWRTdHJpbmcpO1xyXG59O1xyXG5cclxuLypcclxuICBEYXRhIFN0cnVjdHVyZVxyXG4gICBsb2NhbFN0b3JhZ2UgPSB7XHJcbiAgICBwcm9qZWN0czogW1xyXG4gICAgICB7cHJvamVjdFRpdGxlLCBpZCwgbGlzdHM6IFtcclxuICAgICAgICB7IHRpdGxlLCBpZCwgdGFza3M6IFtdIH1cclxuICAgICAgXX0sIFxyXG4gICAgICB7cHJvamVjdFRpdGxlLCBpZCwgbGlzdHMuLi59XSxcclxuICAgIF19LFxyXG4qL1xyXG5cclxuLy8gIFByb2plY3QgcmV0cmlldmFsIC0gR2V0dGVyc1xyXG5cclxuY29uc3QgZ2V0U3RvcmVkUHJvamVjdHMgPSAoKSA9PiB7XHJcbiAgY29uc3Qgc3RvcmVkU3RyaW5nID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJwcm9qZWN0c1wiKTtcclxuICBjb25zdCBzdG9yZWRQcm9qZWN0cyA9IEpTT04ucGFyc2Uoc3RvcmVkU3RyaW5nKTtcclxuICByZXR1cm4gc3RvcmVkUHJvamVjdHM7XHJcbn07XHJcblxyXG5jb25zdCBjaGVja0ZvclByb2plY3RzID0gKCkgPT4ge1xyXG4gIC8vIFVuY29tbWVudCB0byB3aXBlIHN0b3JhZ2VcclxuICAvLyBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShcInByb2plY3RzXCIpO1xyXG4gIGlmICghKFwicHJvamVjdHNcIiBpbiBsb2NhbFN0b3JhZ2UpKSB7XHJcbiAgICBjb25zb2xlLmxvZyhcIkluaXRpYWxpemUgcHJvamVjdHMgYXJyYXkgaW4gc3RvcmFnZVwiKTtcclxuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwicHJvamVjdHNcIiwgSlNPTi5zdHJpbmdpZnkoW10pKTtcclxuICAgIGNyZWF0ZURlZmF1bHRQcm9qZWN0KCk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIC8vIFJlY29uc3RydWN0IHRoZSBjdXJyZW50IHByb2plY3QgYW5kIHNldCBjdXJyZW50UHJvamVjdCBpbiBzdG9yYWdlXHJcbiAgc3RvcmUuc2V0Q3VycmVudFByb2plY3QocmVjb25zdHJ1Y3RDdXJyZW50UHJvamVjdCgpKTtcclxufTtcclxuXHJcbmNvbnN0IHJlY29uc3RydWN0Q3VycmVudFByb2plY3QgPSAoKSA9PiB7XHJcbiAgY29uc3Qgc3RvcmVkUHJvamVjdHMgPSBnZXRTdG9yZWRQcm9qZWN0cygpO1xyXG4gIGNvbnN0IGN1cnJQcm9qSW5kZXggPSByZXRyaWV2ZUN1cnJQcm9qSWR4KCk7XHJcbiAgY29uc3QgY3VycmVudFByb2ogPSBzdG9yZWRQcm9qZWN0c1tjdXJyUHJvakluZGV4XTtcclxuXHJcbiAgY29uc3QgcmVjb25zdHJ1Y3RlZFByb2plY3QgPSBQcm9qZWN0KGN1cnJlbnRQcm9qLnRpdGxlLCBjdXJyZW50UHJvai5pZCk7XHJcbiAgcHViU3ViLnB1Ymxpc2goXCJwcm9qZWN0UmVjb25zdHJ1Y3RlZFwiLCByZWNvbnN0cnVjdGVkUHJvamVjdCk7XHJcblxyXG4gIF9fcmVjb25zdHJ1Y3RMaXN0cyhyZWNvbnN0cnVjdGVkUHJvamVjdCwgY3VycmVudFByb2oubGlzdHMpO1xyXG5cclxuICByZXR1cm4gcmVjb25zdHJ1Y3RlZFByb2plY3Q7XHJcbn07XHJcbi8vIEluaXRpYWxpemUgc3Vic2NyaXB0aW9ucyBhZnRlciByZWNvbnN0cnVjdGlvblxyXG5cclxuY29uc3QgX19yZWNvbnN0cnVjdExpc3RzID0gKHByb2plY3QsIGxpc3RzKSA9PiB7XHJcbiAgbGlzdHMubWFwKChsaXN0KSA9PiB7XHJcbiAgICBjb25zdCByZWNvbnN0cnVjdGVkTGlzdCA9IHByb2plY3QuY3JlYXRlTGlzdChsaXN0LnRpdGxlLCBsaXN0LmlkKTtcclxuICAgIHB1YlN1Yi5wdWJsaXNoKFwibGlzdFJlY29uc3RydWN0ZWRcIiwgcmVjb25zdHJ1Y3RlZExpc3QpO1xyXG5cclxuICAgIF9fcmVjb25zdHJ1Y3RUYXNrcyhyZWNvbnN0cnVjdGVkTGlzdCwgbGlzdC50YXNrcyk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5jb25zdCBfX3JlY29uc3RydWN0VGFza3MgPSAobGlzdCwgdGFza3MpID0+IHtcclxuICB0YXNrcy5mb3JFYWNoKCh0YXNrKSA9PiB7XHJcbiAgICBsaXN0LmNyZWF0ZVRhc2sodGFzay50aXRsZSwgdGFzay5pZCk7XHJcbiAgICBjb25zdCB1cGRhdGVkVGFzayA9IGxpc3QudXBkYXRlVGFzayh0YXNrLmlkLCB0YXNrKTtcclxuICAgIHB1YlN1Yi5wdWJsaXNoKFwidGFza1JlY29uc3RydWN0ZWRcIiwgeyBsaXN0LCB0YXNrOiB1cGRhdGVkVGFzayB9KTtcclxuICB9KTtcclxufTtcclxuXHJcbi8vIEluaXQgcmVjb25zdHJ1Y3Rpb25cclxuLy8gc3RvcmUuc2V0UHJvamVjdHMocmVjb25zdHJ1Y3RQcm9qZWN0cygpKTtcclxuXHJcbi8vIExpc3RlbiBmb3IgbmV3IGNyZWF0aW9ucyB0byBiZSBwdXQgaW50byBzdG9yYWdlXHJcblxyXG4vLyAgUHJvamVjdCBTdG9yYWdlIC0gU2V0dGVyXHJcblxyXG5wdWJTdWIuc3Vic2NyaWJlKFwicHJvamVjdENyZWF0ZWRcIiwgc3RvcmVQcm9qZWN0KTtcclxucHViU3ViLnN1YnNjcmliZShcImxpc3RDcmVhdGVkXCIsIHN0b3JlTGlzdCk7XHJcbnB1YlN1Yi5zdWJzY3JpYmUoXCJsaXN0VXBkYXRlZFwiLCBzdG9yZVVwZGF0ZWRMaXN0KTtcclxucHViU3ViLnN1YnNjcmliZShcInRhc2tDcmVhdGVkXCIsIHN0b3JlVGFzayk7XHJcbnB1YlN1Yi5zdWJzY3JpYmUoXCJ0YXNrVXBkYXRlZFwiLCBzdG9yZVVwZGF0ZWRUYXNrKTtcclxucHViU3ViLnN1YnNjcmliZShcInRhc2tEZWxldGVkXCIsIGRlbGV0ZVN0b3JlZFRhc2spO1xyXG5wdWJTdWIuc3Vic2NyaWJlKFwiY3VycmVudFByb2plY3RTZXRcIiwgc3RvcmVDdXJyZW50UHJvamVjdCk7XHJcblxyXG5mdW5jdGlvbiBzdG9yZVByb2plY3QocHJvamVjdCkge1xyXG4gIGNvbnN0IHVwZGF0ZWRQcm9qZWN0cyA9IHJldHJpZXZlSXRlbShcInByb2plY3RzXCIpO1xyXG4gIHVwZGF0ZWRQcm9qZWN0cy5wdXNoKHtcclxuICAgIHRpdGxlOiBwcm9qZWN0LmdldFRpdGxlKCksXHJcbiAgICBpZDogcHJvamVjdC5nZXRJZCgpLFxyXG4gICAgbGlzdHM6IFtdLFxyXG4gIH0pO1xyXG5cclxuICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInByb2plY3RzXCIsIEpTT04uc3RyaW5naWZ5KHVwZGF0ZWRQcm9qZWN0cykpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzdG9yZUxpc3QobGlzdCkge1xyXG4gIGNvbnN0IHVwZGF0ZWRQcm9qZWN0cyA9IHJldHJpZXZlSXRlbShcInByb2plY3RzXCIpO1xyXG4gIGNvbnN0IGluZGV4ID0gcmV0cmlldmVDdXJyUHJvaklkeCgpO1xyXG5cclxuICB1cGRhdGVkUHJvamVjdHNbaW5kZXhdLmxpc3RzLnB1c2goe1xyXG4gICAgdGl0bGU6IGxpc3QuZ2V0VGl0bGUoKSxcclxuICAgIGlkOiBsaXN0LmdldElkKCksXHJcbiAgICB0YXNrczogW10sXHJcbiAgfSk7XHJcblxyXG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwicHJvamVjdHNcIiwgSlNPTi5zdHJpbmdpZnkodXBkYXRlZFByb2plY3RzKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHN0b3JlVXBkYXRlZExpc3QoZGF0YSkge1xyXG4gIGNvbnN0IHsgbGlzdCwgdGl0bGUgfSA9IGRhdGE7XHJcbiAgY29uc3QgdXBkYXRlZFByb2plY3RzID0gcmV0cmlldmVJdGVtKFwicHJvamVjdHNcIik7XHJcbiAgY29uc3QgaW5kZXggPSByZXRyaWV2ZUN1cnJQcm9qSWR4KCk7XHJcbiAgY29uc3QgcHJvamVjdCA9IHVwZGF0ZWRQcm9qZWN0c1tpbmRleF07XHJcbiAgY29uc3QgbGlzdEluZGV4ID0gcmV0cmlldmVMaXN0SW5kZXgobGlzdC5nZXRJZCgpKTtcclxuICAvLyBVcGRhdGUgbGlzdCBlbnRyeVxyXG4gIHByb2plY3QubGlzdHNbbGlzdEluZGV4XSA9IHsgLi4ucHJvamVjdC5saXN0c1tsaXN0SW5kZXhdLCB0aXRsZSB9O1xyXG5cclxuICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInByb2plY3RzXCIsIEpTT04uc3RyaW5naWZ5KHVwZGF0ZWRQcm9qZWN0cykpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzdG9yZVRhc2soZGF0YSkge1xyXG4gIGNvbnN0IHsgbGlzdCwgdGFzayB9ID0gZGF0YTtcclxuICBjb25zdCB1cGRhdGVkUHJvamVjdHMgPSByZXRyaWV2ZUl0ZW0oXCJwcm9qZWN0c1wiKTtcclxuICBjb25zdCBzdG9yZWRMaXN0ID0gcmV0cmlldmVTdG9yZWRMaXN0QnlJZHgodXBkYXRlZFByb2plY3RzLCBsaXN0LmdldElkKCkpO1xyXG4gIHN0b3JlZExpc3QudGFza3MucHVzaCh0YXNrKTtcclxuXHJcbiAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJwcm9qZWN0c1wiLCBKU09OLnN0cmluZ2lmeSh1cGRhdGVkUHJvamVjdHMpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gc3RvcmVVcGRhdGVkVGFzayhkYXRhKSB7XHJcbiAgY29uc3QgeyBsaXN0LCB0YXNrIH0gPSBkYXRhO1xyXG4gIGNvbnN0IHVwZGF0ZWRQcm9qZWN0cyA9IHJldHJpZXZlSXRlbShcInByb2plY3RzXCIpO1xyXG4gIGNvbnN0IHN0b3JlZExpc3QgPSByZXRyaWV2ZVN0b3JlZExpc3RCeUlkeCh1cGRhdGVkUHJvamVjdHMsIGxpc3QuZ2V0SWQoKSk7XHJcbiAgY29uc3Qgc3RvcmVkVGFza3MgPSBzdG9yZWRMaXN0LnRhc2tzO1xyXG4gIGNvbnN0IHRhc2tJbmRleCA9IHJldHJpZXZlVGFza0luZGV4KHN0b3JlZFRhc2tzLCB0YXNrLmlkKTtcclxuICBzdG9yZWRUYXNrc1t0YXNrSW5kZXhdID0geyAuLi5zdG9yZWRUYXNrc1t0YXNrSW5kZXhdLCAuLi50YXNrIH07XHJcblxyXG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwicHJvamVjdHNcIiwgSlNPTi5zdHJpbmdpZnkodXBkYXRlZFByb2plY3RzKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRlbGV0ZVN0b3JlZFRhc2soZGF0YSkge1xyXG4gIGNvbnN0IHsgbGlzdCwgdGFzayB9ID0gZGF0YTtcclxuICBjb25zdCB1cGRhdGVkUHJvamVjdHMgPSByZXRyaWV2ZUl0ZW0oXCJwcm9qZWN0c1wiKTtcclxuICBjb25zdCBzdG9yZWRMaXN0ID0gcmV0cmlldmVTdG9yZWRMaXN0QnlJZHgodXBkYXRlZFByb2plY3RzLCBsaXN0LmdldElkKCkpO1xyXG4gIGNvbnN0IHN0b3JlZFRhc2tzID0gc3RvcmVkTGlzdC50YXNrcztcclxuICBjb25zdCB0YXNrSW5kZXggPSByZXRyaWV2ZVRhc2tJbmRleChzdG9yZWRUYXNrcywgdGFzay5pZCk7XHJcbiAgc3RvcmVkVGFza3Muc3BsaWNlKHRhc2tJbmRleCwgMSk7XHJcblxyXG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwicHJvamVjdHNcIiwgSlNPTi5zdHJpbmdpZnkodXBkYXRlZFByb2plY3RzKSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHN0b3JlQ3VycmVudFByb2plY3QoZGF0YSkge1xyXG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiY3VycmVudFByb2plY3RcIiwgSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xyXG59XHJcblxyXG5jb25zdCByZXRyaWV2ZVN0b3JlZExpc3RCeUlkeCA9ICh1cGRhdGVkUHJvamVjdHMsIGxpc3RJZCkgPT4ge1xyXG4gIGNvbnN0IHByb2pJbmRleCA9IHJldHJpZXZlQ3VyclByb2pJZHgoKTtcclxuICBjb25zdCBsaXN0SW5kZXggPSByZXRyaWV2ZUxpc3RJbmRleChsaXN0SWQpO1xyXG4gIGNvbnN0IHN0b3JlZFByb2plY3QgPSB1cGRhdGVkUHJvamVjdHNbcHJvakluZGV4XTtcclxuICBjb25zdCBzdG9yZWRMaXN0ID0gc3RvcmVkUHJvamVjdC5saXN0c1tsaXN0SW5kZXhdO1xyXG4gIHJldHVybiBzdG9yZWRMaXN0O1xyXG59O1xyXG5cclxuY29uc3QgcmV0cmlldmVDdXJyUHJvaklkeCA9ICgpID0+IHtcclxuICBjb25zdCBwcm9qZWN0c0luU3RvcmFnZSA9IHJldHJpZXZlSXRlbShcInByb2plY3RzXCIpO1xyXG4gIGNvbnN0IGN1cnJlbnRQcm9qZWN0ID0gcmV0cmlldmVJdGVtKFwiY3VycmVudFByb2plY3RcIik7XHJcbiAgY29uc3QgaW5kZXggPSBwcm9qZWN0c0luU3RvcmFnZS5maW5kSW5kZXgoXHJcbiAgICAocHJvamVjdCkgPT4gcHJvamVjdC5pZCA9PT0gY3VycmVudFByb2plY3QuaWRcclxuICApO1xyXG4gIHJldHVybiBpbmRleDtcclxufTtcclxuXHJcbmNvbnN0IHJldHJpZXZlTGlzdEluZGV4ID0gKGlkKSA9PiB7XHJcbiAgY29uc3QgcHJvamVjdHNJblN0b3JhZ2UgPSByZXRyaWV2ZUl0ZW0oXCJwcm9qZWN0c1wiKTtcclxuICBjb25zdCBjdXJyUHJvakluZGV4ID0gcmV0cmlldmVDdXJyUHJvaklkeCgpO1xyXG4gIGNvbnN0IGxpc3RzID0gcHJvamVjdHNJblN0b3JhZ2VbY3VyclByb2pJbmRleF0ubGlzdHM7XHJcbiAgY29uc3QgaW5kZXggPSBsaXN0cy5maW5kSW5kZXgoKGxpc3QpID0+IGxpc3QuaWQgPT09IGlkKTtcclxuICByZXR1cm4gaW5kZXg7XHJcbn07XHJcblxyXG5jb25zdCByZXRyaWV2ZUxpc3QgPSAoaWQpID0+IHtcclxuICBjb25zdCB1cGRhdGVkUHJvamVjdHMgPSByZXRyaWV2ZUl0ZW0oXCJwcm9qZWN0c1wiKTtcclxuICBjb25zdCBwcm9qSW5kZXggPSByZXRyaWV2ZUN1cnJQcm9qSWR4KCk7XHJcbiAgY29uc3QgbGlzdEluZGV4ID0gcmV0cmlldmVMaXN0SW5kZXgoaWQpO1xyXG4gIGNvbnN0IHByb2plY3QgPSB1cGRhdGVkUHJvamVjdHNbcHJvakluZGV4XTtcclxuICBjb25zdCBsaXN0ID0gcHJvamVjdC5saXN0c1tsaXN0SW5kZXhdO1xyXG4gIHJldHVybiBsaXN0O1xyXG59O1xyXG5cclxuY29uc3QgcmV0cmlldmVUYXNrSW5kZXggPSAoYXJyYXksIHRhc2tJZCkgPT4ge1xyXG4gIHJldHVybiBhcnJheS5maW5kSW5kZXgoKHRhc2spID0+IHRhc2suaWQgPT09IHRhc2tJZCk7XHJcbn07XHJcblxyXG4vKiAgICBcclxuXHJcblxyXG4gIFdlIG5lZWQgdG8gbm93IHJlY29uc3RydWN0IHRoZSBvYmplY3RzIHZpYSB0aGVpciBmYWN0b3J5IGZ1bmN0aW9uc1xyXG4gIEFsc28sIGZpZ3VyZSBvdXQgaG93IHRvIGV4dHJhcG9sYXRlIGFuZCBzdG9yZSBkYXRhIHdpdGhpbiB0aGUgc2ltcGxlIGRhdGEgc3RydWN0dXJlIG9mIGxvY2FsU3RvcmFnZVxyXG5cclxuXHJcbiAgSW5pdCAtIFxyXG4gICAgQ2hlY2sgaWYgbG9jYWxTdG9yYWdlIGNvbnRhaW5zIGEgcHJvamVjdC5cclxuICAgICAgSWYgbm8gcHJvamVjdCBpcyBmb3VuZCwgdGhlbiBjcmVhdGUgdGhlIGRlZmF1bHQgcHJvamVjdFxyXG5cclxuICAgICAgSWYgbG9jYWxTdG9yYWdlIGNvbnRhaW5zIGEgcHJvamVjdC4uLlxyXG4gICAgICAgIEltcG9ydCB0aGUgcHJvamVjdCBhcnJheS5cclxuICAgICAgICBSZWNvbnN0cnVjdCB0aGUgUHJvamVjdHNcclxuICBcclxuICAgICAgICBSZWNvbnN0cnVjdCB0aGUgTGlzdHMgd2l0aGluIHRoZSBQcm9qZWN0XHJcbiAgICAgICAgY29uc3Qgc3RvcmVkTGlzdHMgPSBzdG9yZWRQcm9qZWN0cy5tYXAocHJvamVjdCA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiBwcm9qZWN0Lmxpc3RzO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgY29uc3Qgc3RvcmVkVGFza3MgPSBzdG9yZUxpc3RzLm1hcChsaXN0ID0+IHtcclxuICAgICAgICAgIHJldHVybiBsaXN0LnRhc2tzXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgY29uc3Qgc3RvcmVkVGFza3MgPSBzdG9yZWRMaXN0cy5tYXAobGlzdCA9PiBsaXN0LmdldFRhc2tzKTtcclxuICAgICAgICBjb25zdCByZWNvbnN0cnVjdExpc3RzID0gc3RvcmVkUHJvamVjdHMuZm9yRWFjaChzdG9yZWRQcm9qZWN0ID0+IHtcclxuICAgICAgICAgIHJldHVybiBzdG9yZWRQcm9qZWN0cy5tYXAocHJvamVjdCA9PiBwcm9qZWN0LilcclxuICAgICAgICAgICAgcmVjb25zdHJ1Y3RlZFByb2plY3RzLm1hcChQcm9qZWN0ID0+IFByb2plY3QuY3JlYXRlTGlzdCh0aXRsZSwgaWQpKVxyXG4gICAgICAgIH0pO1xyXG5cclxuXHJcbiAgICAgICAgXHJcbiovXHJcblxyXG5leHBvcnQgeyByZXRyaWV2ZUl0ZW0sIGNoZWNrRm9yUHJvamVjdHMsIHJlY29uc3RydWN0Q3VycmVudFByb2plY3QgfTtcclxuIiwiaW1wb3J0IFByb2plY3QgZnJvbSBcIi4vUHJvamVjdC5qc1wiO1xyXG5pbXBvcnQgeyBjaGVja0Zvckxpc3RzIH0gZnJvbSBcIi4vTGlzdC9MaXN0SGFuZGxlci5qc1wiO1xyXG5pbXBvcnQgeyBjcmVhdGVMaXN0IH0gZnJvbSBcIi4vRXZlbnRIYW5kbGVyLmpzXCI7XHJcbmltcG9ydCBzdG9yZSBmcm9tIFwiLi9zdG9yZS5qc1wiO1xyXG5pbXBvcnQgcHViU3ViIGZyb20gXCIuL3B1YlN1Yi5qc1wiO1xyXG5pbXBvcnQgeyByZXRyaWV2ZUl0ZW0sIHJlY29uc3RydWN0UHJvamVjdHMgfSBmcm9tIFwiLi9sb2NhbFN0b3JhZ2VIZWxwZXIuanNcIjtcclxuXHJcbmNvbnN0IFVzZXJJbnRlcmZhY2UgPSAoKCkgPT4ge1xyXG4gIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNsaXN0LWlucHV0XCIpO1xyXG5cclxuICBjb25zdCBpbml0ID0gKCkgPT4ge1xyXG4gICAgY29uc3QgY3VycmVudFByb2plY3QgPSBzdG9yZS5nZXRDdXJyZW50UHJvamVjdCgpO1xyXG5cclxuICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIChlKSA9PiB7XHJcbiAgICAgIGNyZWF0ZUxpc3QoZSwgY3VycmVudFByb2plY3QpO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgcmV0dXJuIHsgaW5pdCB9O1xyXG59KSgpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgVXNlckludGVyZmFjZTtcclxuIiwiaW1wb3J0IFByb2plY3QgZnJvbSBcIi4vUHJvamVjdC5qc1wiO1xyXG5pbXBvcnQgcHViU3ViIGZyb20gXCIuL3B1YlN1Yi5qc1wiO1xyXG5pbXBvcnQgeyBjcmVhdGVEZWZhdWx0TGlzdCB9IGZyb20gXCIuL0xpc3QvTGlzdEhhbmRsZXJcIjtcclxuaW1wb3J0IHN0b3JlIGZyb20gXCIuL3N0b3JlLmpzXCI7XHJcblxyXG5jb25zdCBjcmVhdGVEZWZhdWx0UHJvamVjdCA9ICgpID0+IHtcclxuICBjb25zb2xlLmxvZyhcIkNyZWF0aW5nIGRlZmF1bHQgcHJvamVjdFwiKTtcclxuICBjb25zdCBkZWZhdWx0UHJvamVjdCA9IFByb2plY3QoXCJEZWZhdWx0XCIpO1xyXG4gIHN0b3JlLnNldEN1cnJlbnRQcm9qZWN0KGRlZmF1bHRQcm9qZWN0KTtcclxuXHJcbiAgcHViU3ViLnB1Ymxpc2goXCJwcm9qZWN0Q3JlYXRlZFwiLCBkZWZhdWx0UHJvamVjdCk7XHJcbiAgY3JlYXRlRGVmYXVsdExpc3QoZGVmYXVsdFByb2plY3QpO1xyXG4gIHJldHVybiBkZWZhdWx0UHJvamVjdDtcclxufTtcclxuXHJcbmV4cG9ydCB7IGNyZWF0ZURlZmF1bHRQcm9qZWN0IH07XHJcbiIsImltcG9ydCByZW5kZXJMaXN0IGZyb20gXCIuL21vZHVsZXMvTGlzdC9MaXN0UmVuZGVyZXIuanNcIjtcclxuaW1wb3J0IFVzZXJJbnRlcmZhY2UgZnJvbSBcIi4vbW9kdWxlcy9Vc2VySW50ZXJmYWNlLmpzXCI7XHJcblxyXG5pbXBvcnQgeyBjaGVja0ZvclByb2plY3RzIH0gZnJvbSBcIi4vbW9kdWxlcy9sb2NhbFN0b3JhZ2VIZWxwZXIuanNcIjtcclxuXHJcbmNoZWNrRm9yUHJvamVjdHMoKTtcclxuY29uc3QgVUkgPSBVc2VySW50ZXJmYWNlO1xyXG5VSS5pbml0KCk7XHJcbiJdLCJuYW1lcyI6WyJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiZXhwb3J0cyIsImRlZmluaXRpb24iLCJrZXkiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0Iiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJhcHBlbmRDdXN0b21FbGVtZW50IiwiY3JlYXRlQ3VzdG9tRWxlbWVudCIsIm9wdGlvbnMiLCJ0YWdOYW1lIiwiY2xhc3NMaXN0IiwidGV4dENvbnRlbnQiLCJhdHRyaWJ1dGVzIiwiZWxlbWVudCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImFkZCIsIkFycmF5IiwiaXNBcnJheSIsImF0dHIiLCJzZXRBdHRyaWJ1dGUiLCJ0YXJnZXQiLCJ0YXJnZXRFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImFwcGVuZENoaWxkIiwiY3VzdG9tRWxlbWVudEhlbHBlciIsImRhdGVTdHJpbmciLCJkYXRlIiwiRGF0ZSIsInNldEhvdXJzIiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwibW9udGgiLCJkYXkiLCJ5ZWFyIiwiZXZlbnRzIiwiZ2V0RXZlbnRzIiwic3Vic2NyaWJlIiwiZXZlbnQiLCJjYWxsYmFjayIsImluZGV4IiwiY29uc29sZSIsImxvZyIsInB1c2giLCJ1bnN1YnNjcmliZSIsInNwbGljZSIsInB1Ymxpc2giLCJkYXRhIiwibWFwIiwiY3VycmVudExpc3QiLCJ0YXNrSWQiLCJfX2NyZWF0ZUZvcm1FbGVtZW50cyIsInRhc2siLCJmcmFnbWVudCIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJ0aXRsZSIsIm5hbWUiLCJkZXNjcmlwdGlvbiIsImR1ZURhdGUiLCJvbmNsaWNrIiwidmFsdWVBc0RhdGUiLCJnZXRGdWxsWWVhciIsImdldE1vbnRoIiwiZ2V0RGF0ZSIsImRpZmZpY3VsdHkiLCJvcHRpb25FbGVtZW50cyIsIm9wdGlvbiIsIm9wdGlvbkVsZW1lbnQiLCJzZWxlY3RlZCIsImFwcGVuZCIsImZvcm1CdXR0b25zIiwiX19jcmVhdGVGb3JtQnV0dG9ucyIsImRpdiIsInN1Ym1pdEJ0biIsImNhbmNlbEJ0biIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImZvcm0iLCJjbG9zZXN0IiwidGFza0NvbnRhaW5lciIsInBhcmVudE5vZGUiLCJtYWluRGV0YWlscyIsInJlbW92ZSIsIm1haW5EZXRhaWxzRWxlbWVudHMiLCJjcmVhdGVNYWluRGV0YWlsc0VsZW1lbnRzIiwiY2FuY2VsRm9ybSIsImdldFRhc2tCeUlkIiwiYXBwZW5kRWRpdFRhc2tGb3JtIiwiZWRpdEZvcm0iLCJpZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJsaXN0IiwiYm90dG9tUGFuZWwiLCJGb3JtRGF0YSIsIm5ld1ZhbHVlcyIsInVwZGF0ZWRUYXNrIiwidXBkYXRlVGFzayIsInJlcGxhY2VDaGlsZHJlbiIsImJvdHRvbVBhbmVsRWxlbWVudHMiLCJjcmVhdGVCb3R0b21QYW5lbEVsZW1lbnRzIiwic3VibWl0Rm9ybSIsIl9fY3JlYXRlRWRpdFRhc2tGb3JtIiwiZXZlbnRIYW5kbGVyIiwic2V0RWRpdE1vZGUiLCJ0YXNrRWxlbWVudCIsImNvbnRhaW5zIiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJmb3JFYWNoIiwidGV4dGFyZWEiLCJzaGlmdEtleSIsInN1Ym1pdEV2ZW50IiwiRXZlbnQiLCJidWJibGVzIiwiY2FuY2VsYWJsZSIsImRpc3BhdGNoRXZlbnQiLCJzZXRQcmlvcml0eSIsInByaW9yaXR5Iiwic3JjIiwidG9nZ2xlIiwiZGVsZXRlVGFzayIsInJlbW92ZVRhc2siLCJ0b29scyIsImltZ1NyYyIsImNsYXNzTmFtZSIsIm9uQ2xpY2siLCJjcmVhdGVUb29sYmFyIiwidG9vbGJhckNvbnRhaW5lciIsInRvb2wiLCJidG4iLCJpbWciLCJfX2NyZWF0ZUJ0bnMiLCJyZW5kZXJUYXNrIiwiX19hcHBlbmRUYXNrRWxlbWVudHMiLCJ0YXNrc0NvbnRhaW5lciIsImdldElkIiwidGFza0VsZW1lbnRzIiwiX19jcmVhdGVUYXNrRWxlbWVudHMiLCJwcmVwZW5kIiwiZGF0YXNldCIsInRvb2xiYXIiLCJfX3JlbmRlck1haW5EZXRhaWxzIiwiX19yZW5kZXJCb3R0b21QYW5lbCIsImVkaXRUYXNrIiwidG9nZ2xlRGV0YWlscyIsInN0eWxlIiwib3BhY2l0eSIsInZpc2liaWxpdHkiLCJtYWluRGV0YWlsc0NvbnRhaW5lciIsImRpZmZpY3VsdHlFbCIsImdldFRhc2tEaWZmaWN1bHR5IiwiZHVlRGF0ZUVsIiwiY3JlYXRlTGlzdCIsImN1cnJlbnRQcm9qZWN0IiwibmV3TGlzdCIsImNyZWF0ZVRhc2siLCJuZXdUYXNrIiwiYXV0b1Jlc2l6ZSIsInRoaXMiLCJoZWlnaHQiLCJzY3JvbGxIZWlnaHQiLCJlbCIsInByZXZpb3VzIiwiY2xvbmVOb2RlIiwiaW5wdXQiLCJjdXJyZW50VGFzayIsIndvcmRCcmVhayIsInJlcGxhY2VXaXRoIiwiYmx1ciIsIm9uY2UiLCJmb2N1cyIsImV4cGFuZGVkRGV0YWlscyIsImV4cGFuZGVkVGFzayIsImV4cGFuZGVkRGl2IiwiX19jcmVhdGVFeHBhbmRlZFRhc2siLCJhZnRlciIsInJlbmRlckV4cGFuZGVkVGFzayIsImVkaXRUaXRsZSIsImdldFRpdGxlIiwic2V0VGl0bGUiLCJyZW5kZXJMaXN0IiwiX19hcHBlbmRMaXN0Q29udGFpbmVyIiwiX19hcHBlbmRUaXRsZUVsZW1lbnQiLCJfX2FwcGVuZFRhc2tDb250YWluZXIiLCJsaXN0RWxlbWVudCIsIl9fY3JlYXRlVGFza0Zvcm0iLCJ0YXNrRm9ybSIsInRhc2tJbnB1dCIsImdldEN1cnJlbnRQcm9qZWN0Iiwic2V0Q3VycmVudFByb2plY3QiLCJwcm9qZWN0IiwiY3J5cHRvIiwicmFuZG9tVVVJRCIsInNsaWNlIiwibGlzdFRpdGxlIiwidGFza3MiLCJ0YXNrTWFuYWdlciIsInRhc2tMaXN0IiwiZ2V0VGFza0J5SW5kZXgiLCJmaW5kSW5kZXgiLCJmaW5kIiwibGVuZ3RoIiwidXBkYXRlZEVudHJ5IiwidGFza0luZGV4IiwibmV3VGl0bGUiLCJnZXRUYXNrcyIsImxpc3RzIiwiZ2V0TGlzdHMiLCJnZXRMaXN0QnlJZCIsImxpc3RJZCIsImxpc3RJbmRleCIsInJldHJpZXZlSXRlbSIsInN0b3JlZFN0cmluZyIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJKU09OIiwicGFyc2UiLCJfX3JlY29uc3RydWN0TGlzdHMiLCJyZWNvbnN0cnVjdGVkTGlzdCIsIl9fcmVjb25zdHJ1Y3RUYXNrcyIsInVwZGF0ZWRQcm9qZWN0cyIsInNldEl0ZW0iLCJzdHJpbmdpZnkiLCJyZXRyaWV2ZUN1cnJQcm9qSWR4IiwicmV0cmlldmVMaXN0SW5kZXgiLCJyZXRyaWV2ZVN0b3JlZExpc3RCeUlkeCIsInN0b3JlZFRhc2tzIiwicmV0cmlldmVUYXNrSW5kZXgiLCJwcm9qSW5kZXgiLCJwcm9qZWN0c0luU3RvcmFnZSIsImFycmF5IiwiaW5pdCIsImRlZmF1bHRQcm9qZWN0IiwiaGFiaXRMaXN0IiwiZmlyc3RUYXNrIiwiY3JlYXRlRGVmYXVsdExpc3QiLCJjcmVhdGVEZWZhdWx0UHJvamVjdCIsImN1cnJlbnRQcm9qIiwiZ2V0U3RvcmVkUHJvamVjdHMiLCJyZWNvbnN0cnVjdGVkUHJvamVjdCIsInJlY29uc3RydWN0Q3VycmVudFByb2plY3QiLCJjaGVja0ZvclByb2plY3RzIl0sInNvdXJjZVJvb3QiOiIifQ==